<!DOCTYPE html><html  lang="en"><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Architecting Intelligence</title>
<meta name="twitter:card" content="summary_large_image">
<meta name="description" content="Learn and create with all things tech-related.">
<meta property="og:description" content="Learn and create with all things tech-related.">
<meta property="og:image" content="https://user-images.githubusercontent.com/904724/185365452-87b7ca7b-6030-4813-a2db-5e65c785bf88.png">
<meta property="og:title" content="Data Pipelines From Scratch">
<link rel="preload" as="fetch" crossorigin="anonymous" href="/data-engineering/data_pipelines_getting_started/_payload.json">
<link rel="stylesheet" href="/_nuxt/entry.B8aBeJvy.css">
<link rel="stylesheet" href="/_nuxt/DocumentDrivenNotFound.BRDfakKL.css">
<link rel="stylesheet" href="/_nuxt/ButtonLink.BcPyV5Fo.css">
<link rel="stylesheet" href="/_nuxt/DocsPageLayout.BXbIABds.css">
<link rel="stylesheet" href="/_nuxt/DocsAside.yGvrP2YV.css">
<link rel="stylesheet" href="/_nuxt/ProseCodeInline.Bril_6kD.css">
<link rel="stylesheet" href="/_nuxt/Alert.ks8StbO8.css">
<link rel="stylesheet" href="/_nuxt/DocsPageBottom.aIuXrYmW.css">
<link rel="stylesheet" href="/_nuxt/ProseA.B_9jSfDy.css">
<link rel="stylesheet" href="/_nuxt/DocsPrevNext.ByMsnGQP.css">
<link rel="stylesheet" href="/_nuxt/DocsToc.BhhHodRA.css">
<link rel="stylesheet" href="/_nuxt/DocsTocLinks.Cr8aui7G.css">
<link rel="stylesheet" href="/_nuxt/ProseH1.C1QHku3J.css">
<link rel="stylesheet" href="/_nuxt/ProseBlockquote.BVZLnJ97.css">
<link rel="stylesheet" href="/_nuxt/ProseP.JZ9aYQx9.css">
<link rel="stylesheet" href="/_nuxt/ProseImg.nadtDK_b.css">
<link rel="stylesheet" href="/_nuxt/ProseH2.DFqHnP3U.css">
<link rel="stylesheet" href="/_nuxt/ProseOl.Zw1jGp1x.css">
<link rel="stylesheet" href="/_nuxt/ProseLi.oUMq_Oay.css">
<link rel="stylesheet" href="/_nuxt/ProseUl.ZPu7LyJp.css">
<link rel="stylesheet" href="/_nuxt/ProseTable.CCUS_BJ6.css">
<link rel="stylesheet" href="/_nuxt/ProseThead.CS-mbO6b.css">
<link rel="stylesheet" href="/_nuxt/ProseTr.BXIVz-Q6.css">
<link rel="stylesheet" href="/_nuxt/ProseTh.CpiIsLya.css">
<link rel="stylesheet" href="/_nuxt/ProseTd.zv8spFSr.css">
<link rel="stylesheet" href="/_nuxt/ProseStrong.kEZmG1pc.css">
<link rel="stylesheet" href="/_nuxt/ProsePre.CchFRBtv.css">
<link rel="stylesheet" href="/_nuxt/ProseCode.hGqjIeRz.css">
<link rel="stylesheet" href="/_nuxt/ProseH3.BL6NEyca.css">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CXJ2fdAB.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DnM6ckxY.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DiDlarbj.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CWMOCUTq.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/prfrliGK.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/ClqCtrfb.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/WTkegDBA.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BPr0oGOJ.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/2ETV-d1z.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DfwIlzWN.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BHloeWX3.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/RlfkODSA.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CBvHC7lm.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Cnxcs8Ow.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Bqg2AslK.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/oL9jraFH.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C4N5kdK3.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DCnPNjGU.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BpWXDgNL.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DDXj8gg1.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/HzHAgKX4.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DCOvvQA7.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BivTU8sc.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CFbYFV0i.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CgJas5qb.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BEj21w-d.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/PVy2bvTw.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BL0lifHx.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/1Io2kNHA.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Bu-hPAU3.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CtkWahKB.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BhsmBU3L.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CCd6Wylz.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BRWi4D1T.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BHUhDG2m.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/RjOL6dZi.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Bdwhfqcg.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/O82UycJE.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Wl01_9ot.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/elmQM_bn.js">
<link rel="prefetch" as="style" href="/_nuxt/page.Dmtwb7Hr.css">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/CWiUpT3k.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/D8gO8QcV.js">
<link rel="prefetch" as="style" href="/_nuxt/useStudio.KYzQV3Di.css">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/C6RYnNE5.js">
<link rel="prefetch" as="style" href="/_nuxt/error-404.D8uONj7L.css">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/Cjt5NVL5.js">
<link rel="prefetch" as="style" href="/_nuxt/error-500.p7T9h8Pv.css">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/D3cn8lx4.js">
<script type="module" src="/_nuxt/CXJ2fdAB.js" crossorigin></script><style id="pinceau-runtime-hydratable">@media{.phy[--]{--puid:a2D87B-v;}.pv-AqetxZ{padding-left:var(--elements-container-padding-mobile);padding-right:var(--elements-container-padding-mobile);}@media (min-width: 475px){.pv-AqetxZ{padding-left:var(--elements-container-padding-xs);padding-right:var(--elements-container-padding-xs);}}@media (min-width: 640px){.pv-AqetxZ{padding-left:var(--elements-container-padding-sm);padding-right:var(--elements-container-padding-sm);}}@media (min-width: 768px){.pv-AqetxZ{padding-left:var(--elements-container-padding-md);padding-right:var(--elements-container-padding-md);}}} </style><style id="pinceau-theme">@media { :root {--pinceau-mq: initial; --docus-search-results-highlight-color: white;--docus-search-results-window-maxHeight: 100%;--docus-search-results-window-maxWidth: 640px;--docus-search-results-window-marginTop: 0;--docus-search-input-borderStyle: solid;--docus-search-input-borderWidth: 1px;--docus-search-backdropFilter: blur(24px);--docus-loadingBar-gradientColorStop3: #0047e1;--docus-loadingBar-gradientColorStop2: #34cdfe;--docus-loadingBar-gradientColorStop1: #00dc82;--docus-loadingBar-height: 3px;--docus-readableLine: 78ch;--docus-footer-height: 145px;--docus-header-height: 64px;--prose-code-inline-padding: 0.2rem 0.375rem 0.2rem 0.375rem;--prose-code-block-backdropFilter: contrast(1);--prose-code-block-border-style: solid;--prose-code-block-border-width: 1px;--prose-tbody-tr-borderBottom-style: dashed;--prose-tbody-tr-borderBottom-width: 1px;--prose-th-textAlign: inherit;--prose-thead-borderBottom-style: solid;--prose-thead-borderBottom-width: 1px;--prose-thead-border-style: solid;--prose-thead-border-width: 0px;--prose-table-textAlign: start;--prose-hr-width: 1px;--prose-hr-style: solid;--prose-li-listStylePosition: outside;--prose-ol-li-markerColor: currentColor;--prose-ol-paddingInlineStart: 21px;--prose-ol-listStyleType: decimal;--prose-ul-li-markerColor: currentColor;--prose-ul-paddingInlineStart: 21px;--prose-ul-listStyleType: disc;--prose-blockquote-border-style: solid;--prose-blockquote-border-width: 4px;--prose-blockquote-quotes: '201C' '201D' '2018' '2019';--prose-blockquote-paddingInlineStart: 24px;--prose-a-code-color-hover: currentColor;--prose-a-code-color-static: currentColor;--prose-a-hasCode-borderBottom: none;--prose-a-border-distance: 2px;--prose-a-border-color-hover: currentColor;--prose-a-border-color-static: currentColor;--prose-a-border-style-hover: solid;--prose-a-border-style-static: dashed;--prose-a-border-width: 1px;--prose-a-color-static: inherit;--prose-a-textDecoration: none;--prose-h6-margin: 3rem 0 2rem;--prose-h5-margin: 3rem 0 2rem;--prose-h4-margin: 3rem 0 2rem;--prose-h3-margin: 3rem 0 2rem;--prose-h2-margin: 3rem 0 2rem;--prose-h1-margin: 0 0 2rem;--typography-lead-loose: 2;--typography-lead-relaxed: 1.625;--typography-lead-normal: 1.5;--typography-lead-snug: 1.375;--typography-lead-tight: 1.25;--typography-lead-none: 1;--typography-lead-10: 2.5rem;--typography-lead-9: 2.25rem;--typography-lead-8: 2rem;--typography-lead-7: 1.75rem;--typography-lead-6: 1.5rem;--typography-lead-5: 1.25rem;--typography-lead-4: 1rem;--typography-lead-3: .75rem;--typography-lead-2: .5rem;--typography-lead-1: .025rem;--typography-fontWeight-black: 900;--typography-fontWeight-extrabold: 800;--typography-fontWeight-bold: 700;--typography-fontWeight-semibold: 600;--typography-fontWeight-medium: 500;--typography-fontWeight-normal: 400;--typography-fontWeight-light: 300;--typography-fontWeight-extralight: 200;--typography-fontWeight-thin: 100;--typography-fontSize-9xl: 128px;--typography-fontSize-8xl: 96px;--typography-fontSize-7xl: 72px;--typography-fontSize-6xl: 60px;--typography-fontSize-5xl: 48px;--typography-fontSize-4xl: 36px;--typography-fontSize-3xl: 30px;--typography-fontSize-2xl: 24px;--typography-fontSize-xl: 20px;--typography-fontSize-lg: 18px;--typography-fontSize-base: 16px;--typography-fontSize-sm: 14px;--typography-fontSize-xs: 12px;--typography-letterSpacing-wide: 0.025em;--typography-letterSpacing-tight: -0.025em;--typography-verticalMargin-base: 24px;--typography-verticalMargin-sm: 16px;--elements-border-secondary-hover: [object Object];--elements-backdrop-background: #fffc;--elements-backdrop-filter: saturate(200%) blur(20px);--elements-container-maxWidth: 80rem;--lead-loose: 2;--lead-relaxed: 1.625;--lead-normal: 1.5;--lead-snug: 1.375;--lead-tight: 1.25;--lead-none: 1;--lead-10: 2.5rem;--lead-9: 2.25rem;--lead-8: 2rem;--lead-7: 1.75rem;--lead-6: 1.5rem;--lead-5: 1.25rem;--lead-4: 1rem;--lead-3: .75rem;--lead-2: .5rem;--lead-1: .025rem;--letterSpacing-widest: 0.1em;--letterSpacing-wider: 0.05em;--letterSpacing-wide: 0.025em;--letterSpacing-normal: 0em;--letterSpacing-tight: -0.025em;--letterSpacing-tighter: -0.05em;--fontSize-9xl: 8rem;--fontSize-8xl: 6rem;--fontSize-7xl: 4.5rem;--fontSize-6xl: 3.75rem;--fontSize-5xl: 3rem;--fontSize-4xl: 2.25rem;--fontSize-3xl: 1.875rem;--fontSize-2xl: 1.5rem;--fontSize-xl: 1.25rem;--fontSize-lg: 1.125rem;--fontSize-base: 1rem;--fontSize-sm: 0.875rem;--fontSize-xs: 0.75rem;--fontWeight-black: 900;--fontWeight-extrabold: 800;--fontWeight-bold: 700;--fontWeight-semibold: 600;--fontWeight-medium: 500;--fontWeight-normal: 400;--fontWeight-light: 300;--fontWeight-extralight: 200;--fontWeight-thin: 100;--font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace;--font-serif: ui-serif, Georgia, Cambria, Times New Roman, Times, serif;--font-sans: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica Neue, Arial, Noto Sans, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji;--opacity-total: 1;--opacity-high: 0.8;--opacity-medium: 0.5;--opacity-soft: 0.3;--opacity-light: 0.15;--opacity-bright: 0.1;--opacity-noOpacity: 0;--borderWidth-lg: 3px;--borderWidth-md: 2px;--borderWidth-sm: 1px;--borderWidth-noBorder: 0;--space-rem-875: 0.875rem;--space-rem-625: 0.625rem;--space-rem-375: 0.375rem;--space-rem-125: 0.125rem;--space-px: 1px;--space-128: 32rem;--space-96: 24rem;--space-80: 20rem;--space-72: 18rem;--space-64: 16rem;--space-60: 15rem;--space-56: 14rem;--space-52: 13rem;--space-48: 12rem;--space-44: 11rem;--space-40: 10rem;--space-36: 9rem;--space-32: 8rem;--space-28: 7rem;--space-24: 6rem;--space-20: 5rem;--space-16: 4rem;--space-14: 3.5rem;--space-12: 3rem;--space-11: 2.75rem;--space-10: 2.5rem;--space-9: 2.25rem;--space-8: 2rem;--space-7: 1.75rem;--space-6: 1.5rem;--space-5: 1.25rem;--space-4: 1rem;--space-3: 0.75rem;--space-2: 0.5rem;--space-1: 0.25rem;--space-0: 0px;--size-full: 100%;--size-7xl: 80rem;--size-6xl: 72rem;--size-5xl: 64rem;--size-4xl: 56rem;--size-3xl: 48rem;--size-2xl: 42rem;--size-xl: 36rem;--size-lg: 32rem;--size-md: 28rem;--size-sm: 24rem;--size-xs: 20rem;--size-200: 200px;--size-104: 104px;--size-80: 80px;--size-64: 64px;--size-56: 56px;--size-48: 48px;--size-40: 40px;--size-32: 32px;--size-24: 24px;--size-20: 20px;--size-16: 16px;--size-12: 12px;--size-8: 8px;--size-6: 6px;--size-4: 4px;--size-2: 2px;--size-0: 0px;--radii-full: 9999px;--radii-3xl: 1.75rem;--radii-2xl: 1.5rem;--radii-xl: 1rem;--radii-lg: 0.75rem;--radii-md: 0.5rem;--radii-sm: 0.375rem;--radii-xs: 0.25rem;--radii-2xs: 0.125rem;--radii-none: 0px;--shadow-none: 0px 0px 0px 0px transparent;--height-screen: 100vh;--width-screen: 100vw;--color-primary-900: #001A1F;--color-primary-800: #00232B;--color-primary-700: #024757;--color-primary-600: #09A0C1;--color-primary-500: #1AD6FF;--color-primary-400: #55E1FF;--color-primary-300: #82E3FF;--color-primary-200: #C5F2FF;--color-primary-100: #DCF7FF;--color-primary-50: #F1FCFF;--color-ruby-900: #380011;--color-ruby-800: #700021;--color-ruby-700: #a90032;--color-ruby-600: #e10043;--color-ruby-500: #ff1a5e;--color-ruby-400: #ff4079;--color-ruby-300: #ff6694;--color-ruby-200: #ff8dae;--color-ruby-100: #ffb3c9;--color-ruby-50: #ffd9e4;--color-pink-900: #380025;--color-pink-800: #70004b;--color-pink-700: #a90070;--color-pink-600: #e10095;--color-pink-500: #ff1ab2;--color-pink-400: #ff40bf;--color-pink-300: #ff66cc;--color-pink-200: #ff8dd8;--color-pink-100: #ffb3e5;--color-pink-50: #ffd9f2;--color-purple-900: #190038;--color-purple-800: #330070;--color-purple-700: #4c00a9;--color-purple-600: #6500e1;--color-purple-500: #811aff;--color-purple-400: #9640ff;--color-purple-300: #ab66ff;--color-purple-200: #c08dff;--color-purple-100: #d5b3ff;--color-purple-50: #ead9ff;--color-royalblue-900: #0b0531;--color-royalblue-800: #160a62;--color-royalblue-700: #211093;--color-royalblue-600: #2c15c4;--color-royalblue-500: #4127e8;--color-royalblue-400: #614bec;--color-royalblue-300: #806ff0;--color-royalblue-200: #a093f3;--color-royalblue-100: #c0b7f7;--color-royalblue-50: #dfdbfb;--color-indigoblue-900: #001238;--color-indigoblue-800: #002370;--color-indigoblue-700: #0035a9;--color-indigoblue-600: #0047e1;--color-indigoblue-500: #1a62ff;--color-indigoblue-400: #407cff;--color-indigoblue-300: #6696ff;--color-indigoblue-200: #8db0ff;--color-indigoblue-100: #b3cbff;--color-indigoblue-50: #d9e5ff;--color-blue-900: #00131D;--color-blue-800: #002235;--color-blue-700: #014267;--color-blue-600: #0069A6;--color-blue-500: #1AADFF;--color-blue-400: #64C7FF;--color-blue-300: #A1DDFF;--color-blue-200: #C6EAFF;--color-blue-100: #DFF3FF;--color-blue-50: #F2FAFF;--color-lightblue-900: #002e38;--color-lightblue-800: #005c70;--color-lightblue-700: #008aa9;--color-lightblue-600: #00b9e1;--color-lightblue-500: #1ad6ff;--color-lightblue-400: #40ddff;--color-lightblue-300: #66e4ff;--color-lightblue-200: #8deaff;--color-lightblue-100: #b3f1ff;--color-lightblue-50: #d9f8ff;--color-teal-900: #062a28;--color-teal-800: #0b544f;--color-teal-700: #117d77;--color-teal-600: #16a79e;--color-teal-500: #1cd1c6;--color-teal-400: #36e4da;--color-teal-300: #5fe9e1;--color-teal-200: #87efe9;--color-teal-100: #aff4f0;--color-teal-50: #d7faf8;--color-pear-900: #2a2b09;--color-pear-800: #545512;--color-pear-700: #7e801b;--color-pear-600: #a8aa24;--color-pear-500: #d0d32f;--color-pear-400: #d8da52;--color-pear-300: #e0e274;--color-pear-200: #e8e997;--color-pear-100: #eff0ba;--color-pear-50: #f7f8dc;--color-red-900: #1C0301;--color-red-800: #340A01;--color-red-700: #701704;--color-red-600: #BB2402;--color-red-500: #FF3B10;--color-red-400: #FF7353;--color-red-300: #FFA692;--color-red-200: #FFDED7;--color-red-100: #FFF3F0;--color-red-50: #FFF9F8;--color-orange-900: #381800;--color-orange-800: #702f00;--color-orange-700: #a94700;--color-orange-600: #e15e00;--color-orange-500: #ff7a1a;--color-orange-400: #ff9040;--color-orange-300: #ffa666;--color-orange-200: #ffbd8d;--color-orange-100: #ffd3b3;--color-orange-50: #ffe9d9;--color-yellow-900: #1B1500;--color-yellow-800: #292100;--color-yellow-700: #614E02;--color-yellow-600: #CBA408;--color-yellow-500: #FBCA05;--color-yellow-400: #FFDC4E;--color-yellow-300: #FFE372;--color-yellow-200: #FFF0B1;--color-yellow-100: #FFF6D3;--color-yellow-50: #FFFCEE;--color-green-900: #00190F;--color-green-800: #002817;--color-green-700: #006037;--color-green-600: #00B467;--color-green-500: #0DD885;--color-green-400: #3CEEA5;--color-green-300: #86FBCB;--color-green-200: #C3FFE6;--color-green-100: #DEFFF1;--color-green-50: #ECFFF7;--color-gray-900: #121110;--color-gray-800: #201E1B;--color-gray-700: #36332E;--color-gray-600: #67635D;--color-gray-500: #97948F;--color-gray-400: #ADA9A4;--color-gray-300: #DBD9D3;--color-gray-200: #ECEBE8;--color-gray-100: #F6F5F4;--color-gray-50: #FBFBFB;--color-black: #0B0A0A;--color-white: #ffffff;--media-portrait: only screen and (orientation: portrait);--media-landscape: only screen and (orientation: landscape);--media-rm: (prefers-reduced-motion: reduce);--media-2xl: (min-width: 1536px);--media-xl: (min-width: 1280px);--media-lg: (min-width: 1024px);--media-md: (min-width: 768px);--media-sm: (min-width: 640px);--media-xs: (min-width: 475px);--docus-search-results-highlight-backgroundColor: var(--color-primary-500);--docus-search-results-selected-backgroundColor: var(--color-gray-300);--docus-search-results-window-borderRadius: none;--docus-search-results-window-marginX: 0;--docus-search-input-backgroundColor: var(--color-gray-200);--docus-search-input-padding: var(--space-2) var(--space-4);--docus-search-input-gap: var(--space-2);--docus-search-input-fontSize: var(--fontSize-sm);--docus-search-input-borderColor: var(--color-gray-200);--docus-search-input-borderRadius: var(--radii-2xs);--docus-footer-padding: var(--space-4) 0;--docus-header-title-color-hover: var(--color-primary-500);--docus-header-title-color-static: var(--color-gray-900);--docus-header-title-fontWeight: var(--fontWeight-bold);--docus-header-title-fontSize: var(--fontSize-2xl);--docus-header-logo-height: var(--space-6);--docus-body-fontFamily: var(--font-sans);--docus-body-color: var(--color-gray-800);--docus-body-backgroundColor: var(--color-white);--prose-code-inline-fontWeight: var(--typography-fontWeight-normal);--prose-code-inline-fontSize: var(--typography-fontSize-sm);--prose-code-inline-borderRadius: var(--radii-xs);--prose-code-block-pre-padding: var(--typography-verticalMargin-sm);--prose-code-block-margin: var(--typography-verticalMargin-base) 0;--prose-code-block-fontSize: var(--typography-fontSize-sm);--prose-tbody-code-inline-fontSize: var(--typography-fontSize-sm);--prose-tbody-td-padding: var(--typography-verticalMargin-sm);--prose-th-fontWeight: var(--typography-fontWeight-semibold);--prose-th-padding: 0 var(--typography-verticalMargin-sm) var(--typography-verticalMargin-sm) var(--typography-verticalMargin-sm);--prose-table-lineHeight: var(--typography-lead-6);--prose-table-fontSize: var(--typography-fontSize-sm);--prose-table-margin: var(--typography-verticalMargin-base) 0;--prose-hr-margin: var(--typography-verticalMargin-base) 0;--prose-li-margin: var(--typography-verticalMargin-sm) 0;--prose-ol-margin: var(--typography-verticalMargin-base) 0;--prose-ul-margin: var(--typography-verticalMargin-base) 0;--prose-blockquote-margin: var(--typography-verticalMargin-base) 0;--prose-a-code-border-style: var(--prose-a-border-style-static);--prose-a-code-border-width: var(--prose-a-border-width);--prose-a-fontWeight: var(--typography-fontWeight-medium);--prose-img-margin: var(--typography-verticalMargin-base) 0;--prose-strong-fontWeight: var(--typography-fontWeight-semibold);--prose-h6-iconSize: var(--typography-fontSize-base);--prose-h6-fontWeight: var(--typography-fontWeight-semibold);--prose-h6-lineHeight: var(--typography-lead-normal);--prose-h6-fontSize: var(--typography-fontSize-lg);--prose-h5-iconSize: var(--typography-fontSize-lg);--prose-h5-fontWeight: var(--typography-fontWeight-semibold);--prose-h5-lineHeight: var(--typography-lead-snug);--prose-h5-fontSize: var(--typography-fontSize-xl);--prose-h4-iconSize: var(--typography-fontSize-lg);--prose-h4-letterSpacing: var(--typography-letterSpacing-tight);--prose-h4-fontWeight: var(--typography-fontWeight-semibold);--prose-h4-lineHeight: var(--typography-lead-snug);--prose-h4-fontSize: var(--typography-fontSize-2xl);--prose-h3-iconSize: var(--typography-fontSize-xl);--prose-h3-letterSpacing: var(--typography-letterSpacing-tight);--prose-h3-fontWeight: var(--typography-fontWeight-semibold);--prose-h3-lineHeight: var(--typography-lead-snug);--prose-h3-fontSize: var(--typography-fontSize-3xl);--prose-h2-iconSize: var(--typography-fontSize-2xl);--prose-h2-letterSpacing: var(--typography-letterSpacing-tight);--prose-h2-fontWeight: var(--typography-fontWeight-semibold);--prose-h2-lineHeight: var(--typography-lead-tight);--prose-h2-fontSize: var(--typography-fontSize-4xl);--prose-h1-iconSize: var(--typography-fontSize-3xl);--prose-h1-letterSpacing: var(--typography-letterSpacing-tight);--prose-h1-fontWeight: var(--typography-fontWeight-bold);--prose-h1-lineHeight: var(--typography-lead-tight);--prose-h1-fontSize: var(--typography-fontSize-5xl);--prose-p-br-margin: var(--typography-verticalMargin-base) 0 0 0;--prose-p-margin: var(--typography-verticalMargin-base) 0;--prose-p-lineHeight: var(--typography-lead-normal);--prose-p-fontSize: var(--typography-fontSize-base);--typography-color-secondary-900: var(--color-gray-900);--typography-color-secondary-800: var(--color-gray-800);--typography-color-secondary-700: var(--color-gray-700);--typography-color-secondary-600: var(--color-gray-600);--typography-color-secondary-500: var(--color-gray-500);--typography-color-secondary-400: var(--color-gray-400);--typography-color-secondary-300: var(--color-gray-300);--typography-color-secondary-200: var(--color-gray-200);--typography-color-secondary-100: var(--color-gray-100);--typography-color-secondary-50: var(--color-gray-50);--typography-color-primary-900: var(--color-primary-900);--typography-color-primary-800: var(--color-primary-800);--typography-color-primary-700: var(--color-primary-700);--typography-color-primary-600: var(--color-primary-600);--typography-color-primary-500: var(--color-primary-500);--typography-color-primary-400: var(--color-primary-400);--typography-color-primary-300: var(--color-primary-300);--typography-color-primary-200: var(--color-primary-200);--typography-color-primary-100: var(--color-primary-100);--typography-color-primary-50: var(--color-primary-50);--typography-font-code: var(--font-mono);--typography-font-body: var(--font-sans);--typography-font-display: var(--font-sans);--typography-body-backgroundColor: var(--color-white);--typography-body-color: var(--color-black);--elements-state-danger-borderColor-secondary: var(--color-red-200);--elements-state-danger-borderColor-primary: var(--color-red-100);--elements-state-danger-backgroundColor-secondary: var(--color-red-100);--elements-state-danger-backgroundColor-primary: var(--color-red-50);--elements-state-danger-color-secondary: var(--color-red-600);--elements-state-danger-color-primary: var(--color-red-500);--elements-state-warning-borderColor-secondary: var(--color-yellow-200);--elements-state-warning-borderColor-primary: var(--color-yellow-100);--elements-state-warning-backgroundColor-secondary: var(--color-yellow-100);--elements-state-warning-backgroundColor-primary: var(--color-yellow-50);--elements-state-warning-color-secondary: var(--color-yellow-700);--elements-state-warning-color-primary: var(--color-yellow-600);--elements-state-success-borderColor-secondary: var(--color-green-200);--elements-state-success-borderColor-primary: var(--color-green-100);--elements-state-success-backgroundColor-secondary: var(--color-green-100);--elements-state-success-backgroundColor-primary: var(--color-green-50);--elements-state-success-color-secondary: var(--color-green-600);--elements-state-success-color-primary: var(--color-green-500);--elements-state-info-borderColor-secondary: var(--color-blue-200);--elements-state-info-borderColor-primary: var(--color-blue-100);--elements-state-info-backgroundColor-secondary: var(--color-blue-100);--elements-state-info-backgroundColor-primary: var(--color-blue-50);--elements-state-info-color-secondary: var(--color-blue-600);--elements-state-info-color-primary: var(--color-blue-500);--elements-state-primary-borderColor-secondary: var(--color-primary-200);--elements-state-primary-borderColor-primary: var(--color-primary-100);--elements-state-primary-backgroundColor-secondary: var(--color-primary-100);--elements-state-primary-backgroundColor-primary: var(--color-primary-50);--elements-state-primary-color-secondary: var(--color-primary-700);--elements-state-primary-color-primary: var(--color-primary-600);--elements-surface-secondary-backgroundColor: var(--color-gray-200);--elements-surface-primary-backgroundColor: var(--color-gray-100);--elements-surface-background-base: var(--color-gray-100);--elements-border-secondary-static: var(--color-gray-200);--elements-border-primary-hover: var(--color-gray-200);--elements-border-primary-static: var(--color-gray-100);--elements-container-padding-md: var(--space-6);--elements-container-padding-sm: var(--space-6);--elements-container-padding-xs: var(--space-4);--elements-container-padding-mobile: var(--space-4);--elements-text-secondary-color-hover: var(--color-gray-700);--elements-text-secondary-color-static: var(--color-gray-500);--elements-text-primary-color-static: var(--color-gray-900);--text-6xl-lineHeight: var(--lead-none);--text-6xl-fontSize: var(--fontSize-6xl);--text-5xl-lineHeight: var(--lead-none);--text-5xl-fontSize: var(--fontSize-5xl);--text-4xl-lineHeight: var(--lead-10);--text-4xl-fontSize: var(--fontSize-4xl);--text-3xl-lineHeight: var(--lead-9);--text-3xl-fontSize: var(--fontSize-3xl);--text-2xl-lineHeight: var(--lead-8);--text-2xl-fontSize: var(--fontSize-2xl);--text-xl-lineHeight: var(--lead-7);--text-xl-fontSize: var(--fontSize-xl);--text-lg-lineHeight: var(--lead-7);--text-lg-fontSize: var(--fontSize-lg);--text-base-lineHeight: var(--lead-6);--text-base-fontSize: var(--fontSize-base);--text-sm-lineHeight: var(--lead-5);--text-sm-fontSize: var(--fontSize-sm);--text-xs-lineHeight: var(--lead-4);--text-xs-fontSize: var(--fontSize-xs);--color-shadow: var(--color-gray-400);--color-secondary-900: var(--color-gray-900);--color-secondary-800: var(--color-gray-800);--color-secondary-700: var(--color-gray-700);--color-secondary-600: var(--color-gray-600);--color-secondary-500: var(--color-gray-500);--color-secondary-400: var(--color-gray-400);--color-secondary-300: var(--color-gray-300);--color-secondary-200: var(--color-gray-200);--color-secondary-100: var(--color-gray-100);--color-secondary-50: var(--color-gray-50);--prose-code-inline-backgroundColor: var(--typography-color-secondary-100);--prose-code-inline-color: var(--typography-color-secondary-700);--prose-code-block-backgroundColor: var(--typography-color-secondary-100);--prose-code-block-color: var(--typography-color-secondary-700);--prose-code-block-border-color: var(--typography-color-secondary-200);--prose-tbody-tr-borderBottom-color: var(--typography-color-secondary-200);--prose-th-color: var(--typography-color-secondary-600);--prose-thead-borderBottom-color: var(--typography-color-secondary-200);--prose-thead-border-color: var(--typography-color-secondary-300);--prose-hr-color: var(--typography-color-secondary-200);--prose-blockquote-border-color: var(--typography-color-secondary-200);--prose-blockquote-color: var(--typography-color-secondary-500);--prose-a-code-background-hover: var(--typography-color-primary-50);--prose-a-code-border-color-hover: var(--typography-color-primary-500);--prose-a-code-border-color-static: var(--typography-color-secondary-400);--prose-a-color-hover: var(--typography-color-primary-500);--shadow-2xl: 0px 25px 50px -12px var(--color-shadow);--shadow-xl: 0px 20px 25px -5px var(--color-shadow), 0px 8px 10px -6px var(--color-shadow);--shadow-lg: 0px 10px 15px -3px var(--color-shadow), 0px 4px 6px -4px var(--color-shadow);--shadow-md: 0px 4px 6px -1px var(--color-shadow), 0px 2px 4px -2px var(--color-shadow);--shadow-sm: 0px 1px 3px 0px var(--color-shadow), 0px 1px 2px -1px var(--color-shadow);--shadow-xs: 0px 1px 2px 0px var(--color-shadow); } }@media { :root.dark {--pinceau-mq: dark; --prose-code-block-backdropFilter: contrast(1);--prose-ol-li-markerColor: currentColor;--prose-ul-li-markerColor: currentColor;--prose-a-code-color-hover: currentColor;--prose-a-code-color-static: currentColor;--prose-a-border-color-hover: currentColor;--prose-a-border-color-static: currentColor;--prose-a-color-static: inherit;--elements-backdrop-background: #0c0d0ccc;--docus-search-results-selected-backgroundColor: var(--color-gray-700);--docus-search-input-backgroundColor: var(--color-gray-800);--docus-search-input-borderColor: transparent;--docus-header-title-color-static: var(--color-gray-100);--docus-body-color: var(--color-gray-200);--docus-body-backgroundColor: var(--color-black);--typography-body-backgroundColor: var(--color-black);--typography-body-color: var(--color-white);--elements-state-danger-borderColor-secondary: var(--color-red-700);--elements-state-danger-borderColor-primary: var(--color-red-800);--elements-state-danger-backgroundColor-secondary: var(--color-red-800);--elements-state-danger-backgroundColor-primary: var(--color-red-900);--elements-state-danger-color-secondary: var(--color-red-200);--elements-state-danger-color-primary: var(--color-red-300);--elements-state-warning-borderColor-secondary: var(--color-yellow-700);--elements-state-warning-borderColor-primary: var(--color-yellow-800);--elements-state-warning-backgroundColor-secondary: var(--color-yellow-800);--elements-state-warning-backgroundColor-primary: var(--color-yellow-900);--elements-state-warning-color-secondary: var(--color-yellow-200);--elements-state-warning-color-primary: var(--color-yellow-400);--elements-state-success-borderColor-secondary: var(--color-green-700);--elements-state-success-borderColor-primary: var(--color-green-800);--elements-state-success-backgroundColor-secondary: var(--color-green-800);--elements-state-success-backgroundColor-primary: var(--color-green-900);--elements-state-success-color-secondary: var(--color-green-200);--elements-state-success-color-primary: var(--color-green-400);--elements-state-info-borderColor-secondary: var(--color-blue-700);--elements-state-info-borderColor-primary: var(--color-blue-800);--elements-state-info-backgroundColor-secondary: var(--color-blue-800);--elements-state-info-backgroundColor-primary: var(--color-blue-900);--elements-state-info-color-secondary: var(--color-blue-200);--elements-state-info-color-primary: var(--color-blue-400);--elements-state-primary-borderColor-secondary: var(--color-primary-700);--elements-state-primary-borderColor-primary: var(--color-primary-800);--elements-state-primary-backgroundColor-secondary: var(--color-primary-800);--elements-state-primary-backgroundColor-primary: var(--color-primary-900);--elements-state-primary-color-secondary: var(--color-primary-200);--elements-state-primary-color-primary: var(--color-primary-400);--elements-surface-secondary-backgroundColor: var(--color-gray-800);--elements-surface-primary-backgroundColor: var(--color-gray-900);--elements-surface-background-base: var(--color-gray-900);--elements-border-secondary-static: var(--color-gray-800);--elements-border-primary-hover: var(--color-gray-800);--elements-border-primary-static: var(--color-gray-900);--elements-text-secondary-color-hover: var(--color-gray-200);--elements-text-secondary-color-static: var(--color-gray-400);--elements-text-primary-color-static: var(--color-gray-50);--color-shadow: var(--color-gray-800);--prose-code-inline-backgroundColor: var(--typography-color-secondary-800);--prose-code-inline-color: var(--typography-color-secondary-200);--prose-code-block-backgroundColor: var(--typography-color-secondary-900);--prose-code-block-color: var(--typography-color-secondary-200);--prose-code-block-border-color: var(--typography-color-secondary-800);--prose-tbody-tr-borderBottom-color: var(--typography-color-secondary-800);--prose-th-color: var(--typography-color-secondary-400);--prose-thead-borderBottom-color: var(--typography-color-secondary-800);--prose-thead-border-color: var(--typography-color-secondary-600);--prose-hr-color: var(--typography-color-secondary-800);--prose-blockquote-border-color: var(--typography-color-secondary-700);--prose-blockquote-color: var(--typography-color-secondary-400);--prose-a-code-background-hover: var(--typography-color-primary-900);--prose-a-code-border-color-hover: var(--typography-color-primary-600);--prose-a-code-border-color-static: var(--typography-color-secondary-600);--prose-a-color-hover: var(--typography-color-primary-400); } }@media (min-width: 640px) { :root {--pinceau-mq: sm; --docus-search-results-window-maxHeight: 320px;--docus-search-results-window-marginTop: 20vh;--docus-footer-height: 100px;--docus-search-results-window-borderRadius: var(--radii-xs);--docus-search-results-window-marginX: var(--space-4);--docus-header-logo-height: var(--space-7); } }</style><script>"use strict";(()=>{const a=window,e=document.documentElement,c=window.localStorage,d=["dark","light"],n=c&&c.getItem&&c.getItem("nuxt-color-mode")||"system";let l=n==="system"?f():n;const i=e.getAttribute("data-color-mode-forced");i&&(l=i),r(l),a["__NUXT_COLOR_MODE__"]={preference:n,value:l,getColorScheme:f,addColorScheme:r,removeColorScheme:u};function r(o){const t=""+o+"",s="theme";e.classList?e.classList.add(t):e.className+=" "+t,s&&e.setAttribute("data-"+s,o)}function u(o){const t=""+o+"",s="theme";e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp(t,"g"),""),s&&e.removeAttribute("data-"+s)}function m(o){return a.matchMedia("(prefers-color-scheme"+o+")")}function f(){if(a.matchMedia&&m("").media!=="not all"){for(const o of d)if(m(":"+o).matches)return o}return"light"}})();
</script></head><body><!----><!--teleport anchor--><!----><!--teleport anchor--><div id="__nuxt"><div class="app-layout" data-v-5518b344><div class="nuxt-progress" style="width:0%;opacity:0;background-size:Infinity% auto;" data-v-5518b344></div><header class="has-dialog" data-v-5518b344 data-v-1fce2464><div class="container pv-AqetxZ pc-a2D87B" data-v-1fce2464 data-v-f95e3fe1><!--[--><div class="section left" data-v-1fce2464><!--[--><button aria-label="Menu" data-v-d3d82abf><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" role="img" class="icon" data-v-d3d82abf style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg></button><!--teleport start--><!--teleport end--><!--]--><a href="/" class="navbar-logo" aria-label="Up4 Tech" data-v-1fce2464 data-v-2c39ff13><span class="title" data-v-2c39ff13>Up4 Tech</span></a></div><div class="section center" data-v-1fce2464><a href="/" class="navbar-logo" aria-label="Up4 Tech" data-v-1fce2464 data-v-2c39ff13><span class="title" data-v-2c39ff13>Up4 Tech</span></a><!----></div><div class="section right" data-v-1fce2464><!--[--><button type="button" aria-label="Search" data-v-639005c9><span class="content" data-v-639005c9><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-639005c9 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21l-6-6m2-5a7 7 0 1 1-14 0a7 7 0 0 1 14 0"/></svg><span data-v-639005c9>Search</span><span data-v-639005c9><kbd data-v-639005c9>⌘</kbd><kbd data-v-639005c9>K</kbd></span></span></button><!--teleport start--><!--teleport end--><!--]--><button aria-label="Color Mode" data-v-1fce2464 data-v-58532cb3><span data-v-58532cb3>...</span></button><div class="social-icons" data-v-1fce2464><!--[--><a href="https://github.com/ramonpzg/edu_content" rel="noopener noreferrer" target="_blank" title="ramonpzg/edu_content" aria-label="ramonpzg/edu_content" data-v-ab03fb65><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-ab03fb65 style="" width="1em" height="1em" viewBox="0 0 496 512" data-v-a6937c2d><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2"/></svg></a><a href="https://nuxt.com" rel="noopener noreferrer" target="_blank" title="Nuxt" aria-label="Nuxt" data-v-ab03fb65><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-ab03fb65 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="M13.464 19.83h8.922c.283 0 .562-.073.807-.21a1.6 1.6 0 0 0 .591-.574a1.53 1.53 0 0 0 .216-.783a1.53 1.53 0 0 0-.217-.782L17.792 7.414a1.6 1.6 0 0 0-.591-.573a1.65 1.65 0 0 0-.807-.21c-.283 0-.562.073-.807.21a1.6 1.6 0 0 0-.59.573L13.463 9.99L10.47 4.953a1.6 1.6 0 0 0-.591-.573a1.65 1.65 0 0 0-.807-.21c-.284 0-.562.073-.807.21a1.6 1.6 0 0 0-.591.573L.216 17.481a1.53 1.53 0 0 0-.217.782c0 .275.074.545.216.783a1.6 1.6 0 0 0 .59.574c.246.137.525.21.808.21h5.6c2.22 0 3.856-.946 4.982-2.79l2.733-4.593l1.464-2.457l4.395 7.382h-5.859Zm-6.341-2.46l-3.908-.002l5.858-9.842l2.923 4.921l-1.957 3.29c-.748 1.196-1.597 1.632-2.916 1.632"/></svg></a><!--]--></div></div><!--]--></div></header><main data-v-5518b344><!--[--><div class="document-driven-page"><div class="container pv-AqetxZ pc-JKqq2R docs-page-content fluid has-toc has-aside" data-v-ba22cf1e data-v-f95e3fe1><!--[--><aside class="aside-nav" data-v-ba22cf1e><nav class="app-aside" data-v-ba22cf1e data-v-47381d57><ul class="docs-aside-tree" data-v-47381d57 data-v-246a485b><!--[--><li class="" data-v-246a485b><button class="title-collapsible-button" data-v-246a485b><span class="content" data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 256 256" data-v-a6937c2d><g fill="currentColor"><path d="m229.06 108.79l-48.7 42l14.88 62.79a8.4 8.4 0 0 1-12.52 9.17L128 189.09l-54.72 33.65a8.4 8.4 0 0 1-12.52-9.17l14.88-62.79l-48.7-42A8.46 8.46 0 0 1 31.73 94l63.91-5.2l24.62-59.6a8.36 8.36 0 0 1 15.48 0l24.62 59.6l63.91 5.2a8.46 8.46 0 0 1 4.79 14.79" opacity=".2"/><path d="M239.18 97.26A16.38 16.38 0 0 0 224.92 86l-59-4.76l-22.78-55.09a16.36 16.36 0 0 0-30.27 0L90.11 81.23L31.08 86a16.46 16.46 0 0 0-9.37 28.86l45 38.83L53 211.75a16.38 16.38 0 0 0 24.5 17.82l50.5-31.08l50.53 31.08A16.4 16.4 0 0 0 203 211.75l-13.76-58.07l45-38.83a16.43 16.43 0 0 0 4.94-17.59m-15.34 5.47l-48.7 42a8 8 0 0 0-2.56 7.91l14.88 62.8a.37.37 0 0 1-.17.48c-.18.14-.23.11-.38 0l-54.72-33.65a8 8 0 0 0-8.38 0l-54.72 33.67c-.15.09-.19.12-.38 0a.37.37 0 0 1-.17-.48l14.88-62.8a8 8 0 0 0-2.56-7.91l-48.7-42c-.12-.1-.23-.19-.13-.5s.18-.27.33-.29l63.92-5.16a8 8 0 0 0 6.72-4.94l24.62-59.61c.08-.17.11-.25.35-.25s.27.08.35.25L153 91.86a8 8 0 0 0 6.75 4.92l63.92 5.16c.15 0 .24 0 .33.29s0 .4-.16.5"/></g></svg><span data-v-246a485b>Set Up</span></span><span data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-246a485b data-v-246a485b><!--[--><li class="has-parent-icon bordered" data-v-246a485b><a href="/introduction" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Introduction</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-246a485b><a href="/introduction/python_installation" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Python Installation</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-246a485b><a href="/introduction/git_installation" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Git Installation</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-246a485b><a href="/introduction/jupyter_intro" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Jupyter Lab &amp; Notebooks Intro</span></span></a><!----></li><!--]--></ul></li><li class="" data-v-246a485b><button class="title-collapsible-button" data-v-246a485b><span class="content" data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 4v12l-4-2l-4 2V4M6 20h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2"/></svg><span data-v-246a485b>Programming</span></span><span data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-246a485b data-v-246a485b><!--[--><li class="has-parent-icon bordered" data-v-246a485b><a href="/programming" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Programming Tutorials</span></span></a><!----></li><li class="has-parent-icon has-children bordered" data-v-246a485b><button class="title-collapsible-button" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Terminal</span></span><span data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 15l5 5l5-5M7 9l5-5l5 5"/></svg></span></button><ul class="docs-aside-tree recursive" style="display:none;" data-v-246a485b data-v-246a485b><!--[--><li class="bordered" data-v-246a485b><a href="/programming/terminal/shell_intro" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Intro to the Terminal</span></span></a><!----></li><!--]--></ul></li><!--]--></ul></li><li class="" data-v-246a485b><button class="title-collapsible-button" data-v-246a485b><span class="content" data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="M5 3v16h16v2H3V3zm15.293 3.293l1.414 1.414L16 13.414l-3-2.999l-4.293 4.292l-1.414-1.414L13 7.586l3 2.999z"/></svg><span data-v-246a485b>Analytics</span></span><span data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-246a485b data-v-246a485b><!--[--><li class="has-parent-icon bordered" data-v-246a485b><a href="/analytics" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Data Analytics</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-246a485b><a href="/analytics/numerical_computing" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Numerical Computing</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-246a485b><a href="/analytics/structured_data" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Intro to pandas</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-246a485b><a href="/analytics/stats_intro" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Intro to Statistics</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-246a485b><a href="/analytics/describing_data" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Describing Data</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-246a485b><a href="/analytics/eda" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Exploratory Data Analysis</span></span></a><!----></li><!--]--></ul></li><li class="" data-v-246a485b><button class="title-collapsible-button" data-v-246a485b><span class="content" data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m8.686 4l2.607-2.607a1 1 0 0 1 1.414 0L15.314 4H19a1 1 0 0 1 1 1v3.686l2.607 2.607a1 1 0 0 1 0 1.414L20 15.314V19a1 1 0 0 1-1 1h-3.686l-2.607 2.607a1 1 0 0 1-1.414 0L8.686 20H5a1 1 0 0 1-1-1v-3.686l-2.607-2.607a1 1 0 0 1 0-1.414L4 8.686V5a1 1 0 0 1 1-1zM6 6v3.515L3.515 12L6 14.485V18h3.515L12 20.485L14.485 18H18v-3.515L20.485 12L18 9.515V6h-3.515L12 3.515L9.515 6zm6 10a4 4 0 1 1 0-8a4 4 0 0 1 0 8m0-2a2 2 0 1 0 0-4a2 2 0 0 0 0 4"/></svg><span data-v-246a485b>Data Engineering</span></span><span data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-246a485b data-v-246a485b><!--[--><li class="has-parent-icon bordered active" data-v-246a485b><a aria-current="page" href="/data-engineering/data_pipelines_getting_started" class="router-link-active router-link-exact-active link padded active" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Data Pipelines From Scratch</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-246a485b><a href="/data-engineering/getting_data" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Getting Data as DataFrames</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-246a485b><a href="/data-engineering/data_cleaning" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Data Cleaning</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-246a485b><a href="/data-engineering/etl_pipes" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>01 ETL Pipelines</span></span></a><!----></li><li class="has-parent-icon bordered active" data-v-246a485b><a aria-current="page" href="/data-engineering/data_pipelines_getting_started" class="router-link-active router-link-exact-active link padded active" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Data Pipelines From Scratch</span></span></a><!----></li><!--]--></ul></li><li class="" data-v-246a485b><button class="title-collapsible-button" data-v-246a485b><span class="content" data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="M15.199 9.944a2.6 2.6 0 0 1-.79-1.55l-.403-3.083l-2.731 1.486a2.6 2.6 0 0 1-1.719.272L6.5 6.5l.57 3.056a2.6 2.6 0 0 1-.273 1.72l-1.486 2.73l3.083.403a2.6 2.6 0 0 1 1.55.79l2.138 2.257l1.336-2.807a2.6 2.6 0 0 1 1.23-1.231l2.808-1.336zm.025 5.564l-2.213 4.65a.6.6 0 0 1-.977.155l-3.542-3.739a.6.6 0 0 0-.358-.182l-5.106-.668a.6.6 0 0 1-.45-.881l2.462-4.524a.6.6 0 0 0 .063-.396L4.16 4.86a.6.6 0 0 1 .7-.7l5.062.943a.6.6 0 0 0 .397-.063l4.523-2.46a.6.6 0 0 1 .882.448l.668 5.107a.6.6 0 0 0 .182.357l3.739 3.542a.6.6 0 0 1-.155.977l-4.65 2.213a.6.6 0 0 0-.284.284m.797 1.927l1.414-1.414l4.243 4.242l-1.415 1.415z"/></svg><span data-v-246a485b>Data Science</span></span><span data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-246a485b data-v-246a485b><!--[--><li class="has-parent-icon bordered" data-v-246a485b><a href="/data-science" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Intro to DS</span></span></a><!----></li><!--]--></ul></li><li class="" data-v-246a485b><button class="title-collapsible-button" data-v-246a485b><span class="content" data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="M13.5 2c0 .444-.193.843-.5 1.118V5h5a3 3 0 0 1 3 3v10a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3V8a3 3 0 0 1 3-3h5V3.118A1.5 1.5 0 1 1 13.5 2M6 7a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V8a1 1 0 0 0-1-1zm-4 3H0v6h2zm20 0h2v6h-2zM9 14.5a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m6 0a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3"/></svg><span data-v-246a485b>Machine Learning Engineering</span></span><span data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-246a485b data-v-246a485b><!--[--><li class="has-parent-icon bordered" data-v-246a485b><a href="/ml-engineering" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Intro to MLE</span></span></a><!----></li><!--]--></ul></li><!--]--></ul></nav></aside><article class="page-body" data-v-ba22cf1e><!--[--><!--[--><div><h1 id="data-pipelines-from-scratch" data-v-b293a8e3><a aria-current="page" href="/data-engineering/data_pipelines_getting_started#data-pipelines-from-scratch" class="router-link-active router-link-exact-active" data-v-b293a8e3><!--[-->Data Pipelines From Scratch<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-b293a8e3 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m13.172 12l-4.95-4.95l1.414-1.413L16 12l-6.364 6.364l-1.414-1.415z"/></svg></a></h1><blockquote data-v-7aaedb56><!--[--><p data-v-3dd08768><!--[-->“Without a systematic way to start and keep data clean, bad data will happen.” ~ Donato Diorio<!--]--></p><!--]--></blockquote><p data-v-3dd08768><!--[--><img src="https://drawio-app.com/wp-content/uploads/2019/05/How-to-create-flow-charts-in-drawio-1-1.png" alt="flow" data-v-2da0c6e8><br>
Source: <a href="https://drawio-app.com/flowcharts/" rel="nofollow" data-v-d1c581be><!--[-->draw.io<!--]--></a><!--]--></p><h2 id="table-of-contents" data-v-3a00cd39><a aria-current="page" href="/data-engineering/data_pipelines_getting_started#table-of-contents" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->Table of Contents<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><ol data-v-18730953><!--[--><li data-v-f93bd10c><!--[--><a aria-current="page" href="/data-engineering/data_pipelines_getting_started##1.-Overview" class="router-link-active router-link-exact-active" data-v-d1c581be><!--[-->Overview<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[--><a aria-current="page" href="/data-engineering/data_pipelines_getting_started##2.-Learning-Outcomes" class="router-link-active router-link-exact-active" data-v-d1c581be><!--[-->Learning Outcomes<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[--><a aria-current="page" href="/data-engineering/data_pipelines_getting_started##3.-Data" class="router-link-active router-link-exact-active" data-v-d1c581be><!--[-->Data<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[--><a aria-current="page" href="/data-engineering/data_pipelines_getting_started##4.-Tools" class="router-link-active router-link-exact-active" data-v-d1c581be><!--[-->Tools<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[--><a aria-current="page" href="/data-engineering/data_pipelines_getting_started##5.-Data-Pipelines" class="router-link-active router-link-exact-active" data-v-d1c581be><!--[-->Data Pipelines<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[--><a aria-current="page" href="/data-engineering/data_pipelines_getting_started##6.-Building-a-Framework" class="router-link-active router-link-exact-active" data-v-d1c581be><!--[-->Building a Framework<!--]--></a><ul data-v-b0218224><!--[--><li data-v-f93bd10c><!--[-->Set Up Dev Environment<!--]--></li><li data-v-f93bd10c><!--[-->Extract<!--]--></li><li data-v-f93bd10c><!--[-->Transform<!--]--></li><li data-v-f93bd10c><!--[-->Load<!--]--></li><!--]--></ul><!--]--></li><li data-v-f93bd10c><!--[--><a aria-current="page" href="/data-engineering/data_pipelines_getting_started##7.-Reproducible-Pipelines" class="router-link-active router-link-exact-active" data-v-d1c581be><!--[-->Reproducible Pipelines<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[--><a aria-current="page" href="/data-engineering/data_pipelines_getting_started##8.-Scheduling" class="router-link-active router-link-exact-active" data-v-d1c581be><!--[-->Scheduling<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[--><a aria-current="page" href="/data-engineering/data_pipelines_getting_started##9.-Exercises" class="router-link-active router-link-exact-active" data-v-d1c581be><!--[-->Exercises<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[--><a aria-current="page" href="/data-engineering/data_pipelines_getting_started##10.-Resources" class="router-link-active router-link-exact-active" data-v-d1c581be><!--[-->Resources<!--]--></a><!--]--></li><!--]--></ol><h2 id="_1-overview" data-v-3a00cd39><a aria-current="page" href="/data-engineering/data_pipelines_getting_started#_1-overview" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->1. Overview<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><p data-v-3dd08768><!--[-->In order to create successful and reproducible data pipelines we need -- at the bare minimum -- tools that allow us manage where and how we store our data, how we run our computations, and how we version control everything we do. This is what we will focus on in this part of the workshop.<!--]--></p><p data-v-3dd08768><!--[-->The assumption of this section is that most of your data work can fit in a computer but, if the need were to arise, you could still use the code in this section with a beefier machine and it would get the job done without a problem.<!--]--></p><p data-v-3dd08768><!--[-->Since the files we&#39;ll interact with will most likely live in a remote server, we&#39;ll<!--]--></p><ol data-v-18730953><!--[--><li data-v-f93bd10c><!--[-->extract a copy of the data we&#39;ll use and save it to our local files;<!--]--></li><li data-v-f93bd10c><!--[-->transform the data into the shape and form we need it to be in;<!--]--></li><li data-v-f93bd10c><!--[-->load it into a local data warehouse based on the popular tool, duckdb;<!--]--></li><li data-v-f93bd10c><!--[-->version our code and data using dvc and git;<!--]--></li><li data-v-f93bd10c><!--[-->create a command line tool to run all of our jobs;<!--]--></li><li data-v-f93bd10c><!--[-->create a reproducible pipeline that can capture different workflows.<!--]--></li><!--]--></ol><p data-v-3dd08768><!--[-->Before we get started, let&#39;s go over the learning outcomes for today. :)<!--]--></p><p data-v-3dd08768><!--[-->Note: While one of the main components of data orchestration is scheduling, you can sill create pipelines and reproducible workflows that can be triggered manually rather than via a schedule.<!--]--></p><h2 id="_2-learning-outcomes" data-v-3a00cd39><a aria-current="page" href="/data-engineering/data_pipelines_getting_started#_2-learning-outcomes" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->2. Learning Outcomes<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><p data-v-3dd08768><!--[-->Before we get started, let&#39;s go over the learning outcomes for this section of the workshop.<!--]--></p><p data-v-3dd08768><!--[-->By the end of this lesson you will be able to,<!--]--></p><ol data-v-18730953><!--[--><li data-v-f93bd10c><!--[-->Discuss what ETL and ELT Pipelines are.<!--]--></li><li data-v-f93bd10c><!--[-->Understand how to read and combine data that comes from different sources.<!--]--></li><li data-v-f93bd10c><!--[-->Create data pipelines using open-source tools.<!--]--></li><li data-v-f93bd10c><!--[-->Develop command line tools.<!--]--></li><!--]--></ol><h2 id="_3-data" data-v-3a00cd39><a aria-current="page" href="/data-engineering/data_pipelines_getting_started#_3-data" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->3. Data<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><p data-v-3dd08768><!--[--><img src="https://upload.wikimedia.org/wikipedia/commons/2/20/Bike_share.jpg" alt="bikes" data-v-2da0c6e8><!--]--></p><p data-v-3dd08768><!--[-->All three data files contain similar information about how many bicycles have been rented each hour, day, week and months for several years and for each city government we are working with.<!--]--></p><p data-v-3dd08768><!--[-->You can get more information about the data of each city using the following links.<!--]--></p><ul data-v-b0218224><!--[--><li data-v-f93bd10c><!--[--><a href="https://archive.ics.uci.edu/ml/datasets/Seoul+Bike+Sharing+Demand#" rel="nofollow" data-v-d1c581be><!--[-->Seoul, South Korea<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[--><a href="https://www.kaggle.com/hmavrodiev/london-bike-sharing-dataset" rel="nofollow" data-v-d1c581be><!--[-->London, England, UK<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[--><a href="https://www.kaggle.com/marklvl/bike-sharing-dataset?select=hour.csv" rel="nofollow" data-v-d1c581be><!--[-->Washington, DC, USA<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[--><a href="https://www.kaggle.com/datasets/imakash3011/rental-bike-sharing" rel="nofollow" data-v-d1c581be><!--[-->Porto, Portugal<!--]--></a> -- This one was shared in Kaggle, but you can also find the original source with more, up-to-date data, <a href="https://capitalbikeshare.com/system-data" rel="nofollow" data-v-d1c581be><!--[-->here<!--]--></a>.<!--]--></li><!--]--></ul><p data-v-3dd08768><!--[-->Note: Some datasets might come with another file containing daily information, but for our purposes, we will be using the hourly one.<!--]--></p><p data-v-3dd08768><!--[-->Here are the variables that appear in all data sets.<!--]--></p>

















































































































<div class="table-wrapper" data-v-a011f4e7><table data-v-a011f4e7><!--[--><thead data-v-ecc07e8d><!--[--><tr data-v-b801bbf1><!--[--><th align="center" data-v-b2c09405><!--[-->London<!--]--></th><th align="center" data-v-b2c09405><!--[-->Seoul<!--]--></th><th align="center" data-v-b2c09405><!--[-->Washington<!--]--></th><th align="center" data-v-b2c09405><!--[-->Porto<!--]--></th><!--]--></tr><!--]--></thead><tbody><!--[--><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[-->date<!--]--></td><td align="center" data-v-cdda4551><!--[-->Date<!--]--></td><td align="center" data-v-cdda4551><!--[-->instant<!--]--></td><td align="center" data-v-cdda4551><!--[-->instant<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[-->count<!--]--></td><td align="center" data-v-cdda4551><!--[-->Rented Bike Count<!--]--></td><td align="center" data-v-cdda4551><!--[-->date<!--]--></td><td align="center" data-v-cdda4551><!--[-->dteday<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[-->temperature<!--]--></td><td align="center" data-v-cdda4551><!--[-->Hour<!--]--></td><td align="center" data-v-cdda4551><!--[-->seasons<!--]--></td><td align="center" data-v-cdda4551><!--[-->season<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[-->t2<!--]--></td><td align="center" data-v-cdda4551><!--[-->Temperature(C)<!--]--></td><td align="center" data-v-cdda4551><!--[-->year<!--]--></td><td align="center" data-v-cdda4551><!--[-->yr<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[-->humidity<!--]--></td><td align="center" data-v-cdda4551><!--[-->Humidity(%)<!--]--></td><td align="center" data-v-cdda4551><!--[-->month<!--]--></td><td align="center" data-v-cdda4551><!--[-->mnth<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[-->wind_speed<!--]--></td><td align="center" data-v-cdda4551><!--[-->Wind speed (m/s)<!--]--></td><td align="center" data-v-cdda4551><!--[-->hour<!--]--></td><td align="center" data-v-cdda4551><!--[-->hr<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[-->weather_code<!--]--></td><td align="center" data-v-cdda4551><!--[-->Visibility  (10m)<!--]--></td><td align="center" data-v-cdda4551><!--[-->is_holiday<!--]--></td><td align="center" data-v-cdda4551><!--[-->holiday<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[-->is_holiday<!--]--></td><td align="center" data-v-cdda4551><!--[-->Dew point temperature(ï¿½C)<!--]--></td><td align="center" data-v-cdda4551><!--[-->weekday<!--]--></td><td align="center" data-v-cdda4551><!--[-->weekday<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[-->is_weekend<!--]--></td><td align="center" data-v-cdda4551><!--[-->Solar Radiation (MJ/m2)<!--]--></td><td align="center" data-v-cdda4551><!--[-->workingday<!--]--></td><td align="center" data-v-cdda4551><!--[-->workingday<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[-->seasons<!--]--></td><td align="center" data-v-cdda4551><!--[-->Rainfall(mm)<!--]--></td><td align="center" data-v-cdda4551><!--[-->weathersit<!--]--></td><td align="center" data-v-cdda4551><!--[-->weathersit<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[--><!--]--></td><td align="center" data-v-cdda4551><!--[-->Snowfall(cm)<!--]--></td><td align="center" data-v-cdda4551><!--[-->temperature<!--]--></td><td align="center" data-v-cdda4551><!--[-->temp<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[--><!--]--></td><td align="center" data-v-cdda4551><!--[-->Seasons<!--]--></td><td align="center" data-v-cdda4551><!--[-->count<!--]--></td><td align="center" data-v-cdda4551><!--[-->atemp<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[--><!--]--></td><td align="center" data-v-cdda4551><!--[-->Holiday<!--]--></td><td align="center" data-v-cdda4551><!--[-->humidity<!--]--></td><td align="center" data-v-cdda4551><!--[-->hum<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[--><!--]--></td><td align="center" data-v-cdda4551><!--[-->Functioning Day<!--]--></td><td align="center" data-v-cdda4551><!--[-->wind_speed<!--]--></td><td align="center" data-v-cdda4551><!--[-->windspeed<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[--><!--]--></td><td align="center" data-v-cdda4551><!--[--><!--]--></td><td align="center" data-v-cdda4551><!--[-->casual<!--]--></td><td align="center" data-v-cdda4551><!--[-->casual<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[--><!--]--></td><td align="center" data-v-cdda4551><!--[--><!--]--></td><td align="center" data-v-cdda4551><!--[-->registered<!--]--></td><td align="center" data-v-cdda4551><!--[-->registered<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[--><!--]--></td><td align="center" data-v-cdda4551><!--[--><!--]--></td><td align="center" data-v-cdda4551><!--[--><!--]--></td><td align="center" data-v-cdda4551><!--[-->cnt<!--]--></td><!--]--></tr><!--]--></tbody><!--]--></table></div><p data-v-3dd08768><!--[-->Since all of these datasets were generated with different logic (e.g. celsius vs fahrenheit, or other divergent measures) and, most likely, by different systems, we can expect more inconsistencies than just unmatching column names, numerical formats, and data collected.<!--]--></p><p data-v-3dd08768><!--[-->We will walk through an example pipeline and several cleaning steps after we discuss the tools we will be using today.<!--]--></p><h2 id="_4-tools" data-v-3a00cd39><a aria-current="page" href="/data-engineering/data_pipelines_getting_started#_4-tools" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->4. Tools<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><p data-v-3dd08768><!--[-->The tools that we will use in this section of the workshop are the following.<!--]--></p><ul data-v-b0218224><!--[--><li data-v-f93bd10c><!--[--><a href="https://pandas.pydata.org/" rel="nofollow" data-v-d1c581be><!--[-->pandas<!--]--></a> - &quot;is a fast, powerful, flexible and easy to use open source data analysis and manipulation tool, built on top of the Python programming language.&quot;<!--]--></li><li data-v-f93bd10c><!--[--><a href="https://dvc.org/" rel="nofollow" data-v-d1c581be><!--[-->dvc<!--]--></a> - &quot;DVC is built to make ML models shareable and reproducible. It is designed to handle large files, data sets, machine learning models, and metrics as well as code.&quot;<!--]--></li><li data-v-f93bd10c><!--[--><a href="https://ibis-project.org/" rel="nofollow" data-v-d1c581be><!--[-->ibis<!--]--></a> - &quot;Ibis is a Python library that provides a lightweight, universal interface for data wrangling. It helps Python users explore and transform data of any size, stored anywhere.&quot;<!--]--></li><li data-v-f93bd10c><!--[--><a href="https://typer.tiangolo.com/" rel="nofollow" data-v-d1c581be><!--[-->typer<!--]--></a> - &quot;Typer is a library for building CLI applications that users will love using and developers will love creating. Based on Python 3.6+ type hints.&quot;<!--]--></li><li data-v-f93bd10c><!--[--><a href="https://docs.python.org/3/library/pathlib.html" rel="nofollow" data-v-d1c581be><!--[-->pathlib<!--]--></a> - allows us to manipulate paths as if they were python objects.<!--]--></li><!--]--></ul><p data-v-3dd08768><!--[-->Let&#39;s get started building data pipelines! :)<!--]--></p><h2 id="_5-data-pipelines" data-v-3a00cd39><a aria-current="page" href="/data-engineering/data_pipelines_getting_started#_5-data-pipelines" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->5. Data Pipelines<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><p data-v-3dd08768><!--[--><img src="https://editor.analyticsvidhya.com/uploads/899101.png" alt="etl_pipe" data-v-2da0c6e8><br>
Source: <a href="https://www.striim.com/" rel="nofollow" data-v-d1c581be><!--[-->Striim<!--]--></a><!--]--></p><p data-v-3dd08768><!--[-->There are different kinds of data pipelines, but two, in particular, dominate a big part of the data engineering world today, ETL and ELT pipelines.<!--]--></p><p data-v-3dd08768><!--[--><strong data-v-b1d4d84a><!--[-->What are ETL Pipelines?<!--]--></strong><!--]--></p><p data-v-3dd08768><!--[-->The acronym ETL stands for Extract, Transform, and Load, and it is the process where data gets extracted from one or multiple sources, it gets processed in-transit, and then it gets loaded into place where data consumers can use (e.g. a data warehouse). These consumers can be data analysts, data scientists, and machine learning engineers, among many others.<!--]--></p><p data-v-3dd08768><!--[--><strong data-v-b1d4d84a><!--[-->What are ELT Pipelines?<!--]--></strong>
With this approach, all the data, structured and unstructured, gets loaded into a data lake or warehouse before it gets transformed. With this approach, a lot of money spent on compute can be saved by only processing the data we need rather than all of it.<!--]--></p><p data-v-3dd08768><!--[--><strong data-v-b1d4d84a><!--[-->What are Reverse ETL Pipelines?<!--]--></strong>
Reverse ETL tools take data from the data lake or warehouse back into business (critical) applications. For example, information about new customers that have not yet been populated into salesforce or other marketing tools for further use by the marketing, sales, and finance teams, and so on...<!--]--></p><p data-v-3dd08768><!--[--><strong data-v-b1d4d84a><!--[-->Why should you learn how to create them?<!--]--></strong><!--]--></p><p data-v-3dd08768><!--[-->Data Pipeline tools enable data integration strategies by allowing companies to gather data from multiple data sources and consolidate it into a single, centralized location. ETL tools also make it possible for different types of data to work together, for example, data generated by the company can be combined with GPS and Temperature data coming from different sources.<!--]--></p><p data-v-3dd08768><!--[-->As data professionals, our task is to create value for our organizations, our clients and our collaborators using some of or all the data at our disposal. However, there are factors that can delay this process a little bit or a lot, for example, we often need to understand beforehand,<!--]--></p><ol data-v-18730953><!--[--><li data-v-f93bd10c><!--[-->Information about the process by which the data we&#39;re dealing with was generated, e.g.
<ul data-v-b0218224><!--[--><li data-v-f93bd10c><!--[-->Point of sale<!--]--></li><li data-v-f93bd10c><!--[-->Clicks on an online marketplace like Amazon, Etzy, Ebay, ect.<!--]--></li><li data-v-f93bd10c><!--[-->A/B Test Results<!--]--></li><li data-v-f93bd10c><!--[-->...<!--]--></li><!--]--></ul><!--]--></li><li data-v-f93bd10c><!--[-->Information about the transformations that occurred during the cleaning and merging process, prior to us jumping on board,
<ul data-v-b0218224><!--[--><li data-v-f93bd10c><!--[-->Celsius degrees were converted into fahrenheit<!--]--></li><li data-v-f93bd10c><!--[-->Prices in Chilean pesos were converted to Rands<!--]--></li><li data-v-f93bd10c><!--[-->Non-numerical and unavailable observations now contain &quot;Not Available&quot; or &quot;Unknown&quot;<!--]--></li><li data-v-f93bd10c><!--[-->...<!--]--></li><!--]--></ul><!--]--></li><li data-v-f93bd10c><!--[-->Information about how the data was stored and where. For instance,
<ul data-v-b0218224><!--[--><li data-v-f93bd10c><!--[-->Parquet format<!--]--></li><li data-v-f93bd10c><!--[-->NOSQL or SQL database<!--]--></li><li data-v-f93bd10c><!--[-->CSV<!--]--></li><li data-v-f93bd10c><!--[-->...<!--]--></li><!--]--></ul><!--]--></li><!--]--></ol><p data-v-3dd08768><!--[-->Understanding how the three processes described above flow will help us have more knowledge about the data that we are going to use, and how to best access it, transform it, and model it before we put it to good use.<!--]--></p><p data-v-3dd08768><!--[-->Let&#39;s walk through an example of a data pipeline using data from wildfires between 1983-2020 in the United States. You can find more information about the dataset <a href="https://www.kaggle.com/kkhandekar/total-wildfires-acres-affected-1983-2020" rel="nofollow" data-v-d1c581be><!--[-->here<!--]--></a>.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>import pandas as pd
</span></span><span class="line" line="2"><span>from pathlib import Path
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>!pwd
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>data_path = Path().cwd().parent/&quot;data&quot;
</span></span><span class="line" line="2"><span>data_path
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>example_data_in = data_path.joinpath(&quot;example&quot;, &quot;federal_firefighting_costs.csv&quot;)
</span></span><span class="line" line="2"><span>pd.read_csv(example_data_in).head()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>pd.read_csv(example_data_in).dtypes
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->As you can see, most columns contain a <code class="" data-v-d83432f1><!--[-->$<!--]--></code> dollar sign and some <code class="" data-v-d83432f1><!--[-->,<!--]--></code> commas, and because this forces Python to treat numbers as objects (or strings) rather than <code class="" data-v-d83432f1><!--[-->int<!--]--></code>&#39;s or <code class="" data-v-d83432f1><!--[-->float<!--]--></code>&#39;s, we will have to remove these signs in our transformation step after extracting the data and before loading a clean version of it to a new location. Let&#39;s create 3 re-usable functions.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>def extract(path):
</span></span><span class="line" line="2"><span>    return pd.read_csv(path)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->As you saw above, only the last 5 variables have commas (<code class="" data-v-d83432f1><!--[-->,<!--]--></code>) and dollar symbols (<code class="" data-v-d83432f1><!--[-->$<!--]--></code>) so we will replace both with an empty space (<code class="" data-v-d83432f1><!--[-->&quot;&quot;<!--]--></code>) using a <code class="" data-v-d83432f1><!--[-->for<!--]--></code> loop.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>def transform(data):
</span></span><span class="line" line="2"><span>    for col in data.iloc[:, 1:].columns:
</span></span><span class="line" line="3"><span>        data[col] = data[col].str.replace(r&#39;[^0-9]+&#39;, &#39;&#39;, regex=True).astype(int)
</span></span><span class="line" line="4"><span>    return data
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->For the &quot;load&quot; process, we will save the data as a <code class="" data-v-d83432f1><!--[-->parquet<!--]--></code> file. This is one of the most popular formats to save data in due to its compression capabilities, orientation, and speed gains in analytical workloads.<!--]--></p><p data-v-3dd08768><!--[-->Here&#39;s an example on the differences between the row-like format and the columnar format of parquet files. If this interests you you can read more about it <a href="https://datos.gob.es/en/blog/why-should-you-use-parquet-files-if-you-process-lot-data" rel="nofollow" data-v-d1c581be><!--[-->here<!--]--></a><!--]--></p><p data-v-3dd08768><!--[--><img src="https://www.scylladb.com/wp-content/uploads/columnar-database-diagram.png" alt="colvsrow" data-v-2da0c6e8><br>
Source: <a href="https://www.scylladb.com/glossary/columnar-database/" rel="nofollow" data-v-d1c581be><!--[-->Scylla DB<!--]--></a><!--]--></p><div class="highlight-null prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="" style=""><!--[--><code>def load(data, path):
    data.to_parquet(path)
    print(&quot;Successfully Loaded Your Modified Data!&quot;)
</code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->Let&#39;s create an output path and with a file name to save our data as.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>data_path
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>example_data_out = data_path.joinpath(&quot;example&quot;, &quot;my_test.parquet&quot;)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->When we have all the steps ready, we create a new function containing our graph using the <code class="" data-v-d83432f1><!--[-->flow<!--]--></code> decorator. We can give this function a name, for example, <code class="" data-v-d83432f1><!--[-->&quot;Example Pipeline! 😎&quot;<!--]--></code> and then chain the tasks we created previously in the order in which they should be run.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>def example_etl(example_data_in, example_data_out):
</span></span><span class="line" line="2"><span>    data = extract(example_data_in)
</span></span><span class="line" line="3"><span>    data_clean = transform(data)
</span></span><span class="line" line="4"><span>    load(data_clean, example_data_out)
</span></span><span class="line" line="5"><span>    print(&quot;Your Pipeline Ran Successfully!&quot;)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->We are ready to run our workflow.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>example_etl(example_data_in, example_data_out)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->To make sure we did everything correctly, let&#39;s create a quick visualization with pandas.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>pd.read_parquet(example_data_out).plot(
</span></span><span class="line" line="2"><span>    x=&#39;Year&#39;,
</span></span><span class="line" line="3"><span>    y=&quot;ForestService&quot;, 
</span></span><span class="line" line="4"><span>    kind=&#39;line&#39;,
</span></span><span class="line" line="5"><span>    title=&quot;Forest Service costs by year&quot;
</span></span><span class="line" line="6"><span>);
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><h2 id="_6-building-a-framework" data-v-3a00cd39><a aria-current="page" href="/data-engineering/data_pipelines_getting_started#_6-building-a-framework" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->6. Building a Framework<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><p data-v-3dd08768><!--[-->In order to do our data engineering work with a personalized framework, there are a few strategies we would take.<!--]--></p><ul data-v-b0218224><!--[--><li data-v-f93bd10c><!--[-->We could keep the code in our computers and copy it to a new project whenever we need to create new pipelines.<!--]--></li><li data-v-f93bd10c><!--[-->We could create a package and either upload it to PyPI or <a href="https://gemfury.com/" rel="nofollow" data-v-d1c581be><!--[-->Gemfury<!--]--></a> (a private repository of packages for different programming languages).<!--]--></li><li data-v-f93bd10c><!--[-->We could keep in neatly organized in GitHub and clone the repository to every new project.<!--]--></li><!--]--></ul><p data-v-3dd08768><!--[-->For this use case, it would be great to work with a library that we could continuously update rather than notebooks and files getting copied around. This will help us stay organized and manage dependencies more effectively.<!--]--></p><p data-v-3dd08768><!--[-->Let&#39;s get started. :)<!--]--></p><h3 id="_61-setting-up-a-dev-environment" data-v-4d9f06da><a aria-current="page" href="/data-engineering/data_pipelines_getting_started#_61-setting-up-a-dev-environment" class="router-link-active router-link-exact-active" data-v-4d9f06da><!--[-->6.1 Setting Up a Dev Environment<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-4d9f06da style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m16 12l-6 6V6z"/></svg></a></h3><p data-v-3dd08768><!--[-->Building frameworks can be super straightforward or a slightly cumbersome project. Because of this and because we are already using an environment to run this workshop in, I will leave here what I think is an excellent resource for learning about how to create Python Packages.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>from IPython.display import HTML
</span></span><span class="line" line="2"><span>HTML(&quot;&quot;&quot;
</span></span><span class="line" line="3"><span>&lt;div align=&quot;center&quot;&gt;
</span></span><span class="line" line="4"><span>    &lt;iframe width=&quot;700&quot; height=&quot;450&quot;
</span></span><span class="line" line="5"><span>    src=&quot;https://youtube.com/embed/l7zS8Ld4_iA&quot;
</span></span><span class="line" line="6"><span>    &lt;/iframe&gt;
</span></span><span class="line" line="7"><span>&lt;/div&gt;
</span></span><span class="line" line="8"><span>&quot;&quot;&quot;)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><h3 id="_62-extract" data-v-4d9f06da><a aria-current="page" href="/data-engineering/data_pipelines_getting_started#_62-extract" class="router-link-active router-link-exact-active" data-v-4d9f06da><!--[-->6.2 Extract<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-4d9f06da style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m16 12l-6 6V6z"/></svg></a></h3><p data-v-3dd08768><!--[-->Extracting data might seem straightforward, but it can come with plenty of caveats. For example, to access sensitive data you might need not only credentials but also access to VPNs (virtual private networks), you might have similar data in different kinds of formats (customer tables stored in legacy databases and new ones), or you might have different data all stored in one place (images, tables, and text all in a datalake) -- if you&#39;re lucky.<!--]--></p><p data-v-3dd08768><!--[-->To tackle these challenges, (1) access and (2) distribution of data, companies such as <a href="https://airbyte.com/" rel="nofollow" data-v-d1c581be><!--[-->Airbyte<!--]--></a>, <a href="https://www.fivetran.com/" rel="nofollow" data-v-d1c581be><!--[-->Fivetran<!--]--></a>, and others, have come up with solutions that do all the heavy lifting for us. They have created tools that either give you connectors to common data sources (such as S3, BigQuery, and others), or give you an API so that you can develop a custom connector.<!--]--></p><p data-v-3dd08768><!--[-->That said, what we&#39;ll do in this section is to create functions that allow us to extract data in different formats or download a dataset from the web. We will create one for each of the examples that we have for the workshop today. Let&#39;s get started loading some data.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>import urllib.request
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>def get_and_load_file(url, path_out, file_name):
</span></span><span class="line" line="2"><span>    path = Path(path_out)
</span></span><span class="line" line="3"><span>    if not path.exists(): path.mkdir(parents=True)
</span></span><span class="line" line="4"><span>    urllib.request.urlretrieve(url, path.joinpath(file_name))
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>get_and_load_file(
</span></span><span class="line" line="2"><span>    url=&quot;https://archive.ics.uci.edu/ml/machine-learning-databases/00560/SeoulBikeData.csv&quot;,
</span></span><span class="line" line="3"><span>    path_out=&quot;../data/example&quot;,
</span></span><span class="line" line="4"><span>    file_name=&quot;seoul_exp.csv&quot;
</span></span><span class="line" line="5"><span>)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->The function above will download the file into the <code class="" data-v-d83432f1><!--[-->&quot;data/example&quot;<!--]--></code> directory. If we do not specify a path for the file to <code class="" data-v-d83432f1><!--[-->urllib.request.urlretrieve<!--]--></code>, it would download the file into a temporary directory since it wouldn&#39;t know what to do with it or where to put it.<!--]--></p><p data-v-3dd08768><!--[-->A popular alternative to <code class="" data-v-d83432f1><!--[-->urllib<!--]--></code> is <code class="" data-v-d83432f1><!--[-->wget<!--]--></code>, so you can switch the tools in this function easily. The former is part of the Python Standard Library (so you&#39;ll never have to install it), and the latter can be installed with <code class="" data-v-d83432f1><!--[-->pip<!--]--></code> or <code class="" data-v-d83432f1><!--[-->conda<!--]--></code>.<!--]--></p><p data-v-3dd08768><!--[-->Let&#39;s create two more, one for csv files and the other for parquet files.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>def extract_from_csv(path_in, encoding=None):
</span></span><span class="line" line="2"><span>    return pd.read_csv(path_in, encoding=encoding)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>seoul_df = extract_from_csv(
</span></span><span class="line" line="2"><span>    path_in=data_path.joinpath(&quot;seoul&quot;, &quot;raw&quot;, &quot;SeoulBikeData.csv&quot;)
</span></span><span class="line" line="3"><span>)
</span></span><span class="line" line="4"><span>seoul_df.head()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->The reason, we&#39;ve added <code class="" data-v-d83432f1><!--[-->enconing<!--]--></code> to our function is that files are not always shared in <code class="" data-v-d83432f1><!--[-->utf-8<!--]--></code> abd it is important to account for this discrepancy when creating an ETL framework. In fact, one of our datasets has a tricky format itself.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>{1: &quot;value&quot;, 1: &quot;value&quot;, 1: &quot;value&quot;, 1: &quot;value&quot;, }
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>def extract_from_parquet(path_in, **kwargs):
</span></span><span class="line" line="2"><span>    return pd.read_parquet(path_in, **kwargs)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>porto_df = extract_from_parquet(
</span></span><span class="line" line="2"><span>    path_in=data_path.joinpath(&quot;porto&quot;, &quot;bike_sharing_hourly.parquet&quot;)
</span></span><span class="line" line="3"><span>)
</span></span><span class="line" line="4"><span>porto_df.head()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->One of our files is stored in a SQLite database so we&#39;ll use the <code class="" data-v-d83432f1><!--[-->sqlite3<!--]--></code> module, which is part of of the <a href="https://docs.python.org/3/library/index.html" rel="nofollow" data-v-d1c581be><!--[-->Python Standard Library<!--]--></a>, to read it.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>import sqlite3
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>def extract_from_db(path_in, query):
</span></span><span class="line" line="2"><span>    conn = sqlite3.connect(path_in)
</span></span><span class="line" line="3"><span>    return pd.read_sql_query(query, conn)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>london_df = extract_from_db(
</span></span><span class="line" line="2"><span>    path_in=data_path.joinpath(&quot;london&quot;, &quot;london_bikes.db&quot;),
</span></span><span class="line" line="3"><span>    query=&quot;SELECT * FROM uk_bikes&quot;
</span></span><span class="line" line="4"><span>)
</span></span><span class="line" line="5"><span>london_df.head()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->Lastly, JSON files can be tricky to handle so we&#39;ll try two quick cases here using a try-except approach, but take note that as your projects evolve, it is highly likely that this function might change. A very good tool to handle large amounts of unstructured JSON that can later be formatted as a dataframe (or many), is <a href="https://examples.dask.org/bag.html" rel="nofollow" data-v-d1c581be><!--[-->Dask Bags<!--]--></a>.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>def extract_from_json(path_in, **kwargs):
</span></span><span class="line" line="2"><span>    try:
</span></span><span class="line" line="3"><span>        data =  pd.read_json(path_in, kwargs)
</span></span><span class="line" line="4"><span>    except:
</span></span><span class="line" line="5"><span>        with open(path_in, &#39;r&#39;) as f:
</span></span><span class="line" line="6"><span>            data = json.loads(f.read())
</span></span><span class="line" line="7"><span>            data = pd.json_normalize(data, kwargs)
</span></span><span class="line" line="8"><span>    return data
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>dc_df = extract_from_json(
</span></span><span class="line" line="2"><span>    path_in=data_path.joinpath(&quot;wash_dc&quot;, &quot;washington.json&quot;)
</span></span><span class="line" line="3"><span>)
</span></span><span class="line" line="4"><span>dc_df.head()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->Now that we have our functions, we want to create a file and attach to it the minimum functionality possible to use it as a command line tool. We will do this with the popular package called <code class="" data-v-d83432f1><!--[-->typer<!--]--></code>. It offers a delightful user experience, it respects (and annoys you at times) by type-checking your code, and it provides you with beautifully-formatted output based on the <a href="https://rich.readthedocs.io/en/latest/" rel="nofollow" data-v-d1c581be><!--[-->rich<!--]--></a> python library.<!--]--></p><p data-v-3dd08768><!--[-->With <code class="" data-v-d83432f1><!--[-->typer<!--]--></code> we can create CLIs in several ways, and, for our purposes, we will pick the most straightforward one which works by adding <code class="" data-v-d83432f1><!--[-->typer.run()<!--]--></code> around a main function that encapsulates your application logic, in our case, our extract function and the upcoming ones.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>%%writefile ../src/data_eng/extract.py
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span>import urllib.request
</span></span><span class="line" line="4"><span>from pathlib import Path
</span></span><span class="line" line="5"><span>import pandas as pd
</span></span><span class="line" line="6"><span>import json
</span></span><span class="line" line="7"><span>import typer
</span></span><span class="line" line="8"><span>from typing import Optional
</span></span><span class="line" line="9"><span>from load import save_data
</span></span><span class="line" line="10"><span emptylineplaceholder="true">
</span></span><span class="line" line="11"><span emptylineplaceholder="true">
</span></span><span class="line" line="12"><span>def get_and_load_file(url, path_out, file_name):
</span></span><span class="line" line="13"><span>    path = Path(path_out)
</span></span><span class="line" line="14"><span>    if not path.exists():
</span></span><span class="line" line="15"><span>        path.mkdir(parents=True)
</span></span><span class="line" line="16"><span>    urllib.request.urlretrieve(url, path.joinpath(file_name))
</span></span><span class="line" line="17"><span emptylineplaceholder="true">
</span></span><span class="line" line="18"><span>def extract_from_csv(path_in, encoding=None):
</span></span><span class="line" line="19"><span>    return pd.read_csv(path_in, encoding=encoding)
</span></span><span class="line" line="20"><span emptylineplaceholder="true">
</span></span><span class="line" line="21"><span>def extract_from_db(path_in, query):
</span></span><span class="line" line="22"><span>    conn = sqlite3.connect(path_in)
</span></span><span class="line" line="23"><span>    return pd.read_sql_query(query, conn)
</span></span><span class="line" line="24"><span emptylineplaceholder="true">
</span></span><span class="line" line="25"><span>def extract_from_parquet(path_in, **kwargs):
</span></span><span class="line" line="26"><span>    return pd.read_parquet(path_in, **kwargs)
</span></span><span class="line" line="27"><span emptylineplaceholder="true">
</span></span><span class="line" line="28"><span>def extract_from_json(path_in, **kwargs):
</span></span><span class="line" line="29"><span>    try:
</span></span><span class="line" line="30"><span>        data =  pd.read_json(path_in, **kwargs)
</span></span><span class="line" line="31"><span>    except:
</span></span><span class="line" line="32"><span>        with open(path_in, &#39;r&#39;) as f:
</span></span><span class="line" line="33"><span>            data = json.loads(f.read())
</span></span><span class="line" line="34"><span>            data = pd.json_normalize(data, kwargs)
</span></span><span class="line" line="35"><span>    return data
</span></span><span class="line" line="36"><span emptylineplaceholder="true">
</span></span><span class="line" line="37"><span>def main(
</span></span><span class="line" line="38"><span>    arg: str = typer.Option(...),
</span></span><span class="line" line="39"><span>    url: Optional[str] = typer.Option(None),
</span></span><span class="line" line="40"><span>    path_in: Optional[str] = typer.Option(None),
</span></span><span class="line" line="41"><span>    path_out: Optional[str] = typer.Option(None),
</span></span><span class="line" line="42"><span>    encoding: Optional[str] = typer.Option(None),
</span></span><span class="line" line="43"><span>    file_name: Optional[str] = typer.Option(None),
</span></span><span class="line" line="44"><span>    query: Optional[str] = typer.Option(None),
</span></span><span class="line" line="45"><span>):
</span></span><span class="line" line="46"><span>    if arg == &quot;get&quot;:
</span></span><span class="line" line="47"><span>        get_and_load_file(url, path_out, file_name)
</span></span><span class="line" line="48"><span>    elif arg == &quot;csv&quot;:
</span></span><span class="line" line="49"><span>        data = extract_from_csv(path_in, encoding=encoding)
</span></span><span class="line" line="50"><span>        save_data(data, path_out, file_name)
</span></span><span class="line" line="51"><span>    elif arg == &quot;pq&quot;:
</span></span><span class="line" line="52"><span>        data = extract_from_parquet(path_in)
</span></span><span class="line" line="53"><span>        save_data(data, path_out, file_name)
</span></span><span class="line" line="54"><span>    elif arg == &quot;json&quot;:
</span></span><span class="line" line="55"><span>        data = extract_from_json(path_in)
</span></span><span class="line" line="56"><span>        save_data(data, path_out, file_name)
</span></span><span class="line" line="57"><span>    elif arg == &quot;db&quot;:
</span></span><span class="line" line="58"><span>        data = extract_from_db(path_in, query)
</span></span><span class="line" line="59"><span>        save_data(data, path_out, file_name)
</span></span><span class="line" line="60"><span>    else:
</span></span><span class="line" line="61"><span>        print(f&quot;Could not understand argument {arg}. Please use &#39;pq&#39; for parquet files, &#39;db&#39; for database, json, or csv in lowercase.&quot;)
</span></span><span class="line" line="62"><span emptylineplaceholder="true">
</span></span><span class="line" line="63"><span>    print(&quot;Data Extracted Successfully!&quot;)
</span></span><span class="line" line="64"><span emptylineplaceholder="true">
</span></span><span class="line" line="65"><span emptylineplaceholder="true">
</span></span><span class="line" line="66"><span>if __name__ == &quot;__main__&quot;:
</span></span><span class="line" line="67"><span>    typer.run(main)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->Note that we added different parameters to our <code class="" data-v-d83432f1><!--[-->main<!--]--></code> function to control the behavior of our CLI app.<!--]--></p><ul data-v-b0218224><!--[--><li data-v-f93bd10c><!--[--><code class="" data-v-d83432f1><!--[-->arg<!--]--></code> - the kind of data we&#39;re extracting.<!--]--></li><li data-v-f93bd10c><!--[--><code class="" data-v-d83432f1><!--[-->url<!--]--></code> - the url for when we need to download files from somewhere<!--]--></li><li data-v-f93bd10c><!--[--><code class="" data-v-d83432f1><!--[-->path_in<!--]--></code> - where is the data at<!--]--></li><li data-v-f93bd10c><!--[--><code class="" data-v-d83432f1><!--[-->path_out<!--]--></code> - where is that data going to<!--]--></li><li data-v-f93bd10c><!--[--><code class="" data-v-d83432f1><!--[-->encoding<!--]--></code> - what kind of enconding are we reading the file with<!--]--></li><li data-v-f93bd10c><!--[--><code class="" data-v-d83432f1><!--[-->file_name<!--]--></code> - what is going to be the new name of the output file<!--]--></li><li data-v-f93bd10c><!--[--><code class="" data-v-d83432f1><!--[-->query<!--]--></code> - query for the data we want from the SQL database<!--]--></li><!--]--></ul><p data-v-3dd08768><!--[-->A few important things to note:<!--]--></p><ul data-v-b0218224><!--[--><li data-v-f93bd10c><!--[-->parameters containing underscores <code class="" data-v-d83432f1><!--[-->_<!--]--></code> will be switched into a dash <code class="" data-v-d83432f1><!--[-->-<!--]--></code> by <code class="" data-v-d83432f1><!--[-->typer<!--]--></code>, so <code class="" data-v-d83432f1><!--[-->file_name<!--]--></code> will be <code class="" data-v-d83432f1><!--[-->file-name<!--]--></code><!--]--></li><li data-v-f93bd10c><!--[-->commands are run with two dashes and with a space in between it and the argument being passes, e.g. <code class="" data-v-d83432f1><!--[-->--name PyCon<!--]--></code><!--]--></li><li data-v-f93bd10c><!--[--><code class="" data-v-d83432f1><!--[-->typer.Option(None)<!--]--></code> indicates to <code class="" data-v-d83432f1><!--[-->typer<!--]--></code> that this command can be optional, hence, when we change the kind of file we&#39;re extracting we can by pass having to put an option on others.<!--]--></li><li data-v-f93bd10c><!--[-->by adding <code class="" data-v-d83432f1><!--[-->Optional<!--]--></code> around the type of a function parameter, you are also letting typer that that parameter is optional and that its default argument is <code class="" data-v-d83432f1><!--[-->None<!--]--></code>.<!--]--></li><li data-v-f93bd10c><!--[-->a parameter with only a type is a required parameter.<!--]--></li><!--]--></ul><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>pd.read_parquet(&quot;../data/seoul/raw/testing_cli_extract2.csv&quot;).head()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><h3 id="_63-transform" data-v-4d9f06da><a aria-current="page" href="/data-engineering/data_pipelines_getting_started#_63-transform" class="router-link-active router-link-exact-active" data-v-4d9f06da><!--[-->6.3 Transform<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-4d9f06da style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m16 12l-6 6V6z"/></svg></a></h3><iframe src="https://giphy.com/embed/R9zXHWAHyTjnq" width="400" height="300"></iframe><p data-v-3dd08768><!--[-->Depending on tasks that await the final output files or tables of an ETL pipeline (e.g. reporting metrics, building machine learning models, forecasting, etc.), this step can be very convoluted or slightly straightforward. In general, though, this step can include lots of cleaning and normalization functions, and a schema setter, among many others.<!--]--></p><p data-v-3dd08768><!--[-->The cleaning steps might include dealing with missing values, cleaning emails, names, addresses, and others, or putting values of similar nature into the same format (e.g. different weather measurements into one).<!--]--></p><p data-v-3dd08768><!--[-->Normalization can be anything from changing column names with the same values but different names to have the same one, or height in cm vs feet and inches to be in the same measure, or ..., you get the point. :)<!--]--></p><p data-v-3dd08768><!--[-->A schema is the way in which we represent not only the content and type of our new data files/tables, but also the way in which we represent their relationship. A common schema is the <a href="https://www.databricks.com/glossary/star-schema" rel="nofollow" data-v-d1c581be><!--[-->star schema<!--]--></a>. An uncommon (but rising star) schema is the <a href="https://www.activityschema.com/" rel="nofollow" data-v-d1c581be><!--[-->activity schema<!--]--></a>.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>import re
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>#create some toy data for our Bicycle problem
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span>toy_data = pd.DataFrame({&quot;Postal Codes&quot;: [22345, 32442, 20007], 
</span></span><span class="line" line="4"><span>                         &quot;Cities&#39;&quot;:       [&quot;Miami,  FL&quot;, &quot;Dallas, TX&quot;, &quot;Washington, DC&quot;],
</span></span><span class="line" line="5"><span>                         &quot;Dates as mm-dd-yyy&quot;:         pd.date_range(start=&#39;9/27/2021&#39;, periods=3)})
</span></span><span class="line" line="6"><span>toy_data
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>def clean_col_names(index_of_cols: pd.Index):
</span></span><span class="line" line="2"><span>    return [re.sub(r&#39;[^a-zA-Z0-9\s_]&#39;, &#39;&#39;, col).lower().replace(r&quot; &quot;, &quot;_&quot;) for col in index_of_cols]
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>clean_col_names(toy_data)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>def extract_dates(data, date_col, hour_col=None):
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span>    data[&quot;date&quot;] = pd.to_datetime(data[date_col], infer_datetime_format=True)
</span></span><span class="line" line="4"><span>    if not data.columns.isin([&quot;hour&quot;, &quot;Hour&quot;, &quot;hr&quot;, &quot;HR&quot;]).any():
</span></span><span class="line" line="5"><span>        data[&quot;hour&quot;] = data[&#39;date&#39;].dt.hour
</span></span><span class="line" line="6"><span>        #Time series datasets need to be ordered by time.
</span></span><span class="line" line="7"><span>        data.sort_values([&quot;date&quot;, &quot;hour&quot;], inplace=True)
</span></span><span class="line" line="8"><span>    elif hour_col:
</span></span><span class="line" line="9"><span>        data.sort_values([&quot;date&quot;, hour_col], inplace=True)
</span></span><span class="line" line="10"><span>    else:
</span></span><span class="line" line="11"><span>        print(&quot;You must figure out how the hour works in your file.&quot;)
</span></span><span class="line" line="12"><span emptylineplaceholder="true">
</span></span><span class="line" line="13"><span>    data[&quot;year&quot;]           = data[&#39;date&#39;].dt.year
</span></span><span class="line" line="14"><span>    data[&quot;month&quot;]          = data[&#39;date&#39;].dt.month
</span></span><span class="line" line="15"><span>    data[&quot;week&quot;]           = data[&#39;date&#39;].dt.isocalendar().week
</span></span><span class="line" line="16"><span>    data[&quot;day&quot;]            = data[&#39;date&#39;].dt.day
</span></span><span class="line" line="17"><span>    data[&quot;day_of_week&quot;]    = data[&#39;date&#39;].dt.dayofweek
</span></span><span class="line" line="18"><span>    data[&quot;is_month_start&quot;] = data[&#39;date&#39;].dt.is_month_start    
</span></span><span class="line" line="19"><span emptylineplaceholder="true">
</span></span><span class="line" line="20"><span>    data.drop(&#39;date&#39;, axis=1, inplace=True)
</span></span><span class="line" line="21"><span>    return data
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>extract_dates(london_df, &quot;timestamp&quot;).head()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->A common tasks in data science is to create dummy variables, which is ofter referred to as one-hot encoding. These are binary representations of a category, for example, if you have a columns with different kinds of cars, after you one-hot encode it, you will have one column for sedan, coupe, convertible, and so on, and each will be represented with a 0 or a 1 for when it is available and when it isn&#39;t, respectively.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>def one_hot(data, cols_list, **kwargs):
</span></span><span class="line" line="2"><span>    return pd.get_dummies(data=data, columns=cols_list, **kwargs)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>one_hot(seoul_df, [&quot;Seasons&quot;, &quot;Holiday&quot;], drop_first=True).head()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>def add_location_cols(data, place):
</span></span><span class="line" line="2"><span>    data[&quot;loc_id&quot;] = place
</span></span><span class="line" line="3"><span>    return data
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>add_location_cols(dc_df, &quot;DC&quot;).head()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>def fix_and_drop(data, col_to_fix, mapping, cols_to_drop):
</span></span><span class="line" line="2"><span>    data[col_to_fix] = data[col_to_fix].map(mapping)
</span></span><span class="line" line="3"><span>    return data.drop(cols_to_drop, axis=1)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>seasons_london = {&#39;Spring&#39;: 0, &#39;Summer&#39;: 1, &#39;Fall&#39;: 2, &#39;Winter&#39;: 3}
</span></span><span class="line" line="2"><span>cols_drop_london = [&#39;t2&#39;, &#39;weather_code&#39;]
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>london_df.head()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>london_df[&quot;seasonreal&quot;].map(seasons_london).value_counts()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>fix_and_drop(london_df, &quot;seasonreal&quot;, seasons_london, cols_drop_london).head()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>def order_and_merge(data_lists, date=None):
</span></span><span class="line" line="2"><span>    pick_order = data_lists[0].columns #takes order of columns of the first dataset
</span></span><span class="line" line="3"><span>    #reindexing columns by the order of the first dataset, then sorting by date and hour.
</span></span><span class="line" line="4"><span>    if date:
</span></span><span class="line" line="5"><span>        new_list = [d.reindex(columns=pick_order).sort_values([date, &#39;hour&#39;]) for d in data_lists]
</span></span><span class="line" line="6"><span>    else:
</span></span><span class="line" line="7"><span>        new_list = data_lists
</span></span><span class="line" line="8"><span>    return pd.concat(new_list) #merge all
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><h3 id="exercise" data-v-4d9f06da><a aria-current="page" href="/data-engineering/data_pipelines_getting_started#exercise" class="router-link-active router-link-exact-active" data-v-4d9f06da><!--[-->Exercise<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-4d9f06da style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m16 12l-6 6V6z"/></svg></a></h3><p data-v-3dd08768><!--[-->Pick any two datasets and<!--]--></p><ul data-v-b0218224><!--[--><li data-v-f93bd10c><!--[-->select 5 columns from each<!--]--></li><li data-v-f93bd10c><!--[-->change column names as appropriate<!--]--></li><li data-v-f93bd10c><!--[-->use the order_and_nerge function to combine both<!--]--></li><!--]--></ul><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>london_df.head()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>london_df_small = london_df[[&quot;cnt&quot;, &quot;t1&quot;, &quot;wind_speed&quot;, &quot;seasonreal&quot;, &quot;hour&quot;]]
</span></span><span class="line" line="2"><span>london_df_small.tail()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>seoul_df.head()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>seoul_df_small = seoul_df[[&quot;Rented Bike Count&quot;, &quot;Temperature(�C)&quot;, &quot;Wind speed (m/s)&quot;, &quot;Seasons&quot;, &quot;Hour&quot;]]
</span></span><span class="line" line="2"><span>seoul_df_small.head()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>seoul_df_small.columns = london_df_small.columns
</span></span><span class="line" line="2"><span>seoul_df_small.columns == london_df_small.columns
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>order_and_merge([seoul_df_small, london_df_small]).shape
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->Finally, we take the same approach as with the extract set of functions and wrap our transform workflow into a <code class="" data-v-d83432f1><!--[-->main<!--]--></code> function, and then that <code class="" data-v-d83432f1><!--[-->main<!--]--></code> function into a typer CLI.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>%%writefile ../src/data_eng/transform.py
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span>import pandas as pd, re
</span></span><span class="line" line="4"><span>from pathlib import Path
</span></span><span class="line" line="5"><span>from extract import save_data
</span></span><span class="line" line="6"><span>import typer
</span></span><span class="line" line="7"><span>from typing import Optional, List
</span></span><span class="line" line="8"><span emptylineplaceholder="true">
</span></span><span class="line" line="9"><span>def clean_col_names(index_of_cols: pd.Index):
</span></span><span class="line" line="10"><span>    return [re.sub(r&#39;[^a-zA-Z0-9\s_]&#39;, &#39;&#39;, col).lower().replace(r&quot; &quot;, &quot;_&quot;) for col in index_of_cols]
</span></span><span class="line" line="11"><span emptylineplaceholder="true">
</span></span><span class="line" line="12"><span>def extract_dates(data, date_col, hour_col=None):
</span></span><span class="line" line="13"><span emptylineplaceholder="true">
</span></span><span class="line" line="14"><span>    data[&quot;date&quot;] = pd.to_datetime(data[date_col], infer_datetime_format=True)
</span></span><span class="line" line="15"><span>    if not data.columns.isin([&quot;hour&quot;, &quot;Hour&quot;, &quot;hr&quot;, &quot;HR&quot;]).any():
</span></span><span class="line" line="16"><span>        data[&quot;hour&quot;] = data[&#39;date&#39;].dt.hour
</span></span><span class="line" line="17"><span>        #Time series datasets need to be ordered by time.
</span></span><span class="line" line="18"><span>        data.sort_values([&quot;date&quot;, &quot;hour&quot;], inplace=True)
</span></span><span class="line" line="19"><span>    elif hour_col:
</span></span><span class="line" line="20"><span>        data.sort_values([&quot;date&quot;, hour_col], inplace=True)
</span></span><span class="line" line="21"><span>    else:
</span></span><span class="line" line="22"><span>        print(&quot;You must figure out how the hour works in your file.&quot;)
</span></span><span class="line" line="23"><span emptylineplaceholder="true">
</span></span><span class="line" line="24"><span>    data[&quot;year&quot;]           = data[&#39;date&#39;].dt.year
</span></span><span class="line" line="25"><span>    data[&quot;month&quot;]          = data[&#39;date&#39;].dt.month
</span></span><span class="line" line="26"><span>    data[&quot;week&quot;]           = data[&#39;date&#39;].dt.isocalendar().week
</span></span><span class="line" line="27"><span>    data[&quot;day&quot;]            = data[&#39;date&#39;].dt.day
</span></span><span class="line" line="28"><span>    data[&quot;day_of_week&quot;]    = data[&#39;date&#39;].dt.dayofweek
</span></span><span class="line" line="29"><span>    data[&quot;is_month_start&quot;] = data[&#39;date&#39;].dt.is_month_start    
</span></span><span class="line" line="30"><span emptylineplaceholder="true">
</span></span><span class="line" line="31"><span>    data.drop(&#39;date&#39;, axis=1, inplace=True)
</span></span><span class="line" line="32"><span>    return data
</span></span><span class="line" line="33"><span emptylineplaceholder="true">
</span></span><span class="line" line="34"><span>def one_hot(data, cols_list):
</span></span><span class="line" line="35"><span>    return pd.get_dummies(data=data, columns=cols_list)
</span></span><span class="line" line="36"><span emptylineplaceholder="true">
</span></span><span class="line" line="37"><span>def add_location_cols(data, place):
</span></span><span class="line" line="38"><span>    data[&quot;loc_id&quot;] = place
</span></span><span class="line" line="39"><span>    return data
</span></span><span class="line" line="40"><span emptylineplaceholder="true">
</span></span><span class="line" line="41"><span>def fix_and_drop(data, col_to_fix, mapping, cols_to_drop):
</span></span><span class="line" line="42"><span>    data[col_to_fix] = data[col_to_fix].map(mapping)
</span></span><span class="line" line="43"><span>    return data.drop(cols_to_drop, axis=1)
</span></span><span class="line" line="44"><span emptylineplaceholder="true">
</span></span><span class="line" line="45"><span>def order_and_merge(data_lists):
</span></span><span class="line" line="46"><span>    pick_order = data_lists[0].columns #takes order of columns of the first dataset
</span></span><span class="line" line="47"><span>    new_list = [d.reindex(columns=pick_order).sort_values([&#39;date&#39;, &#39;hour&#39;]) for d in data_lists] #reindexing columns by the order of the first dataset, then sorting by date and hour.
</span></span><span class="line" line="48"><span>    return pd.concat(new_list) #merge all
</span></span><span class="line" line="49"><span emptylineplaceholder="true">
</span></span><span class="line" line="50"><span>def main(
</span></span><span class="line" line="51"><span>    path_in:   str           = typer.Option(...),
</span></span><span class="line" line="52"><span>    date_col:  Optional[str] = typer.Option(None),
</span></span><span class="line" line="53"><span>    hour_col:  Optional[str] = typer.Option(None),
</span></span><span class="line" line="54"><span>    cols_list: List[str]     = typer.Option(None),
</span></span><span class="line" line="55"><span>    place:     Optional[str] = typer.Option(None),
</span></span><span class="line" line="56"><span>    path_out:  Optional[str] = typer.Option(None),
</span></span><span class="line" line="57"><span>    file_name: Optional[str] = typer.Option(None)
</span></span><span class="line" line="58"><span>):
</span></span><span class="line" line="59"><span>    data = pd.read_parquet(path_in)
</span></span><span class="line" line="60"><span>    # data.columns = clean_col_names(data.columns)
</span></span><span class="line" line="61"><span>    data = extract_dates(data, date_col, hour_col)
</span></span><span class="line" line="62"><span>    if cols_list:
</span></span><span class="line" line="63"><span>        data = one_hot(data, cols_list)
</span></span><span class="line" line="64"><span>    data.columns = clean_col_names(data.columns)
</span></span><span class="line" line="65"><span>    data = add_location_cols(data, place)
</span></span><span class="line" line="66"><span>    save_data(data, path_out, file_name)
</span></span><span class="line" line="67"><span emptylineplaceholder="true">
</span></span><span class="line" line="68"><span>    print(&quot;Data Extracted and Transformed Successfully!&quot;)
</span></span><span class="line" line="69"><span emptylineplaceholder="true">
</span></span><span class="line" line="70"><span>if __name__ == &quot;__main__&quot;:
</span></span><span class="line" line="71"><span>    typer.run(main)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>pd.read_parquet(&quot;../data/seoul/interim/cli_test_clean.parquet&quot;).head()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><h3 id="_62-load" data-v-4d9f06da><a aria-current="page" href="/data-engineering/data_pipelines_getting_started#_62-load" class="router-link-active router-link-exact-active" data-v-4d9f06da><!--[-->6.2 Load<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-4d9f06da style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m16 12l-6 6V6z"/></svg></a></h3><p data-v-3dd08768><!--[-->The loading stage, at least for analytical purposes, tends to be a data warehouse like BigQuery, Redshift, etc., but it can also be a directory in a data lake where files are saved in the highly optimized parquet format.<!--]--></p><p data-v-3dd08768><!--[-->In order for us to simulate a data warehouse locally, we will create a duckdb database using the python library <code class="" data-v-d83432f1><!--[-->ibis<!--]--></code>. The reason we will do it this ways is that ibis can translate the schema of our files into the duckdb SQL in one line of code. Effectively saving us boilerplate code that may or may not end up accounting for every feature in our dataframes.<!--]--></p><p data-v-3dd08768><!--[-->Ibis is a very cool project, especially if your SQL skills as basic as mine, so I highly encourage you to check it out. :)<!--]--></p><div class="highlight-null prose-code" meta="{python" data-v-e0eae3fb><!----><!--[--><pre class="" style=""><!--[--><code>import ibis
from pathlib import Path
</code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-null prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="" style=""><!--[--><code>data_path = Path().cwd().parent/&quot;data/&quot;
</code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-null prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="" style=""><!--[--><code>def create_db(path_in, path_out, file_name, table_name):
    path = Path(path_out)
    conn = ibis.duckdb.connect(path.joinpath(file_name))
    conn.register(path_in, table_name=table_name)
    print(f&quot;Successfully loaded the {table_name} table!&quot;)
</code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-null prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="" style=""><!--[--><code>create_db(
    path_in=data_path.joinpath(&quot;porto&quot;, &quot;bike_sharing_hourly.parquet&quot;),
    path_out=&quot;../data/dwarehouse&quot;,
    file_name=&quot;mytest_dw.ddb&quot;,
    table_name=&quot;one_day&quot;
)
</code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->Let&#39;s read in our data to check that it was loaded successfully.<!--]--></p><div class="highlight-null prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="" style=""><!--[--><code>import duckdb
</code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-null prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="" style=""><!--[--><code>duck = duckdb.connect(&quot;../data/dwarehouse/mytest_dw.ddb&quot;)
duck.query(&quot;SELECT * FROM one_day&quot;).df().head()
</code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-null prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="" style=""><!--[--><code>def create_parquet(path_in, path_out, file_name):
    path = Path(path_out)
    pd.read_parquet(path_in).to_parquet(path.joinpath(file_name))
    print(f&quot;Successfully loaded the {file_name} table!&quot;)
</code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-null prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="" style=""><!--[--><code>def save_data(data, path_out, file_name):
    path_out = Path(path_out)
    if not path_out.exists(): path_out.mkdir(parents=True)
    data.to_parquet(path_out.joinpath(file_name))
    print(f&quot;Successfully loaded the {file_name} table!&quot;)
</code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->We take the same steps as before and wrap our main function with <code class="" data-v-d83432f1><!--[-->typer.run()<!--]--></code> to make it a CLI, we test that it works well, and then go on to the next stage.<!--]--></p><div class="highlight-null prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="" style=""><!--[--><code>%%writefile ../src/data_eng/load.py

from pathlib import Path
import ibis
import typer
from typing import Optional
import pandas as pd


def create_db(path_in, path_out, file_name, table_name):
    path = Path(path_out)
    conn = ibis.duckdb.connect(path.joinpath(file_name))
    conn.register(path_in, table_name=table_name)
    print(f&quot;Successfully loaded the {table_name} table!&quot;)

def create_parquet(path_in, path_out, file_name):
    path = Path(path_out)
    pd.read_parquet(path_in).to_parquet(path.joinpath(file_name))
    print(f&quot;Successfully loaded the {file_name} table!&quot;)

def save_data(data, path_out, file_name):
    path_out = Path(path_out)
    if not path_out.exists(): path_out.mkdir(parents=True)
    data.to_parquet(path_out.joinpath(file_name))
    print(f&quot;Successfully loaded the {file_name} table!&quot;)


def main(
    kind: str = typer.Option(...),
    path_in: Optional[str] = typer.Option(None), 
    path_out: Optional[str] = typer.Option(None),
    file_name: Optional[str] = typer.Option(None),
    table_name: Optional[str] = typer.Option(None)
):
    if kind == &quot;db&quot;:
        create_db(path_in, path_out, file_name, table_name)
    elif kind == &quot;pq&quot;:
        create_parquet(path_in, path_out, file_name)
    else:
        print(f&quot;Could not understand argument {kind}. Please use &#39;pq&#39; for parquet files or &#39;db&#39; for database.&quot;)

    print(&quot;Data Extracted Successfully!&quot;)

if __name__ == &quot;__main__&quot;:
    typer.run(main)
</code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><h2 id="_7-reproducible-pipelines" data-v-3a00cd39><a aria-current="page" href="/data-engineering/data_pipelines_getting_started#_7-reproducible-pipelines" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->7. Reproducible Pipelines<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><p data-v-3dd08768><!--[-->Data Version Control or <code class="" data-v-d83432f1><!--[-->dvc<!--]--></code> is a tool for version almost any kind of file you can think of. From images, text, videos, and excel spreadsheets, to machine learning models and other artifacts. In addition, it is also an excellent tool for tracking machine learning experiments and for creating language agnostic pipelines where you can automatically version control the inputs and outputs of your workflows.<!--]--></p><p data-v-3dd08768><!--[-->If you have ever used git then the following commands will feel like home<!--]--></p><ul data-v-b0218224><!--[--><li data-v-f93bd10c><!--[--><code class="" data-v-d83432f1><!--[-->dvc init<!--]--></code> --&gt; this the first step to get started using dvc (after installing it of course)<!--]--></li><li data-v-f93bd10c><!--[--><code class="" data-v-d83432f1><!--[-->dvc remote add -d storage gdrive://your_hash<!--]--></code> --&gt; since we will be tracking files somewhere, this command will help set up a remote repository for these.<!--]--></li><li data-v-f93bd10c><!--[--><code class="" data-v-d83432f1><!--[-->dvc add<!--]--></code> --&gt; add a file to track.<!--]--></li><li data-v-f93bd10c><!--[--><code class="" data-v-d83432f1><!--[-->dvc push<!--]--></code> --&gt; push the file to your remote repository.<!--]--></li><li data-v-f93bd10c><!--[--><code class="" data-v-d83432f1><!--[-->dvc pull<!--]--></code> --&gt; pull the file from your remote repository and into your local machine.<!--]--></li><li data-v-f93bd10c><!--[--><code class="" data-v-d83432f1><!--[-->dvc stage<!--]--></code> --&gt; allows you to start adding steps to a pipeline. It will create a <code class="" data-v-d83432f1><!--[-->dvc.yml<!--]--></code> file containing the steps of the pipeline. This can be modified manually as well.<!--]--></li><li data-v-f93bd10c><!--[--><code class="" data-v-d83432f1><!--[-->dvc repro<!--]--></code> --&gt; Once we finish our stage, or as we add steps to it, we can run our pipeline with this command. The best part is that the steps will get cashed, so if nothing changes, nothing will get rerun.<!--]--></li><li data-v-f93bd10c><!--[--><code class="" data-v-d83432f1><!--[-->dvc dag<!--]--></code> --&gt; allows you to visualize your pipelines as a graph in the terminal.<!--]--></li><!--]--></ul><p data-v-3dd08768><!--[-->Finally, some of the settings for our repo will be available at <code class="" data-v-d83432f1><!--[-->.dvc/config<!--]--></code> and these can be changed manually at any time.<!--]--></p><p data-v-3dd08768><!--[-->Open a terminal in the main directory for this workshop and follow along.<!--]--></p><p data-v-3dd08768><!--[-->To create our pipeline, we&#39;ll add the stages step by step.<!--]--></p><div class="highlight-sh prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-sh shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-dark:#B392F0;--shiki-default:#6F42C1">dvc</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> stage</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> add</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> --name</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> seoul_extract</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> \
</span></span><span class="line" line="2"><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5">    --deps</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> data/seoul/SeoulBikeData.csv</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> \
</span></span><span class="line" line="3"><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5">    --outs</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> data/seoul/raw/seoul_raw.parquet</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> \
</span></span><span class="line" line="4"><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62">    python</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> src/data_eng/extract.py</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> --arg</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> csv</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> \
</span></span><span class="line" line="5"><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5">        --path-in</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> data/seoul/SeoulBikeData.csv</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> \
</span></span><span class="line" line="6"><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5">        --path-out</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> data/seoul/raw</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> \
</span></span><span class="line" line="7"><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5">        --file-name</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> seoul_raw.parquet</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> --encoding</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> iso-8859-1
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-bash prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-bash shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-dark:#B392F0;--shiki-default:#6F42C1">dvc</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> stage</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> add</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> --name</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> seoul_transform</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> \
</span></span><span class="line" line="2"><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5">    --deps</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> data/seoul/raw/seoul_raw.parquet</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> \
</span></span><span class="line" line="3"><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5">    --outs</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> data/seoul/interim/seoul_clean.parquet</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> \
</span></span><span class="line" line="4"><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62">    python</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> src/data_eng/transform.py</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> \
</span></span><span class="line" line="5"><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5">        --path-in</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> data/seoul/seoul_raw.parquet</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> \
</span></span><span class="line" line="6"><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5">        --date-col</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> Date</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> --hour-col</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> Hour</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> --place</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> Seoul</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> \
</span></span><span class="line" line="7"><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5">        --path-out</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> data/seoul/interim</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> --file-name</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> seoul_clean.parquet
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><h3 id="exercise-1" data-v-4d9f06da><a aria-current="page" href="/data-engineering/data_pipelines_getting_started#exercise-1" class="router-link-active router-link-exact-active" data-v-4d9f06da><!--[-->Exercise<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-4d9f06da style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m16 12l-6 6V6z"/></svg></a></h3><p data-v-3dd08768><!--[-->Add the load stage into our pipeline following the examples above.<!--]--></p><div class="highlight-bash prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-bash shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-dark:#B392F0;--shiki-default:#6F42C1">dvc</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> stage</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> add</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> --name</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> seoul_load</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> \
</span></span><span class="line" line="2"><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5">    --deps</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> data/seoul/interim/seoul_clean.parquet</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> \
</span></span><span class="line" line="3"><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5">    --outs</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> data/dwarehouse/analytics.db</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> \
</span></span><span class="line" line="4"><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62">    python</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> src/data_eng/load.py</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> --kind</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> db</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> \
</span></span><span class="line" line="5"><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5">        --path-in</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> data/seoul/interim/seoul_clean.parquet</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> \
</span></span><span class="line" line="6"><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5">        --path-out</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> data/dwarehouse</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> --name</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> analytics.db</span><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5"> \
</span></span><span class="line" line="7"><span style="--shiki-dark:#79B8FF;--shiki-default:#005CC5">        --table-name</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> seoul_main
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->Finally we can run our pipeline, evaluate it, and push our files into our remote storage.<!--]--></p><div class="highlight-sh prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-sh shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-dark:#6A737D;--shiki-default:#6A737D"># 1
</span></span><span class="line" line="2"><span style="--shiki-dark:#B392F0;--shiki-default:#6F42C1">dvc</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> repro
</span></span><span class="line" line="3"><span emptylineplaceholder="true">
</span></span><span class="line" line="4"><span style="--shiki-dark:#6A737D;--shiki-default:#6A737D"># 2
</span></span><span class="line" line="5"><span style="--shiki-dark:#B392F0;--shiki-default:#6F42C1">dvc</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> dag
</span></span><span class="line" line="6"><span emptylineplaceholder="true">
</span></span><span class="line" line="7"><span style="--shiki-dark:#6A737D;--shiki-default:#6A737D"># 3
</span></span><span class="line" line="8"><span style="--shiki-dark:#B392F0;--shiki-default:#6F42C1">dvc</span><span style="--shiki-dark:#9ECBFF;--shiki-default:#032F62"> push
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->Afterwards, dvc will provide us with git files to track for our project.<!--]--></p><h2 id="_8-scheduling" data-v-3a00cd39><a aria-current="page" href="/data-engineering/data_pipelines_getting_started#_8-scheduling" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->8. Scheduling<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><p data-v-3dd08768><!--[-->Scheduling our workflows can be super convenient and time-savior when we know we need to run tasks repeatedly. A very common tool for the task is cron, and here is an excellent tutorial to get started with it.<!--]--></p><p data-v-3dd08768><!--[-->Note: Windows users would need to use Windows Subsystem for Linux to use cron or some other tool, potentially in PowerShell.<!--]--></p><div class="highlight-null prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="" style=""><!--[--><code>from IPython.display import HTML
HTML(&quot;&quot;&quot;
&lt;div align=&quot;center&quot;&gt;
    &lt;iframe width=&quot;700&quot; height=&quot;450&quot;
    src=&quot;https://www.youtube.com/embed/QZJ1drMQz1A&quot;
    title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; 
    clipboard-write; encrypted-media; gyroscope; picture-in-picture; 
    web-share&quot; allowfullscreen&gt;
    &lt;/iframe&gt;
&lt;/div&gt;
&quot;&quot;&quot;)
</code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><h2 id="_9-exercises" data-v-3a00cd39><a aria-current="page" href="/data-engineering/data_pipelines_getting_started#_9-exercises" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->9. Exercises<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><h3 id="exercise-1-1" data-v-4d9f06da><a aria-current="page" href="/data-engineering/data_pipelines_getting_started#exercise-1-1" class="router-link-active router-link-exact-active" data-v-4d9f06da><!--[-->Exercise 1<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-4d9f06da style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m16 12l-6 6V6z"/></svg></a></h3><ol data-v-18730953><!--[--><li data-v-f93bd10c><!--[-->Open the terminal, create a new directory named <code class="" data-v-d83432f1><!--[-->dc_bikes<!--]--></code>, and cd into it.<!--]--></li><li data-v-f93bd10c><!--[-->Create two subdirectories, data and src.<!--]--></li><li data-v-f93bd10c><!--[-->Create an ETL pipeline with two functions in the transform step.<!--]--></li><!--]--></ol><h3 id="exercise-2" data-v-4d9f06da><a aria-current="page" href="/data-engineering/data_pipelines_getting_started#exercise-2" class="router-link-active router-link-exact-active" data-v-4d9f06da><!--[-->Exercise 2<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-4d9f06da style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m16 12l-6 6V6z"/></svg></a></h3><ol data-v-18730953><!--[--><li data-v-f93bd10c><!--[-->Initialize a git and a dvc repository for the project in Exercise 1.<!--]--></li><li data-v-f93bd10c><!--[-->Create a new repo in GitHub and commit your initial changes.<!--]--></li><li data-v-f93bd10c><!--[-->Create a dvc pipeline with your three stages.<!--]--></li><li data-v-f93bd10c><!--[-->Commit your changes.<!--]--></li><!--]--></ol><h2 id="_10-resources" data-v-3a00cd39><a aria-current="page" href="/data-engineering/data_pipelines_getting_started#_10-resources" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->10. Resources<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><p data-v-3dd08768><!--[-->If you&#39;d like to expand your knowledge around the tools and concepts that we covered in this lesson, you might find the following list of resources helpful.<!--]--></p><ul data-v-b0218224><!--[--><li data-v-f93bd10c><!--[-->To learn more about pandas --&gt; <a href="https://wesmckinney.com/book/" rel="nofollow" data-v-d1c581be><!--[-->Python for Data Analysis, 3E by Wes McKinney<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[-->To learn more about ibis --&gt; <a href="https://ibis-project.org/blog/ibis_substrait_to_duckdb/" rel="nofollow" data-v-d1c581be><!--[-->Ibis + Substrait + DuckDB by Gil Forsyth<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[-->To learn more about duckdb --&gt; <a href="https://www.youtube.com/watch?v=AjsB6lM2-zw&amp;ab_channel=DatawithMarc" rel="nofollow" data-v-d1c581be><!--[-->DuckDB Tutorial by Data with Marc<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[-->To learn more about dvc --&gt; <a href="https://towardsdev.com/ml-pipeline-decoupled-i-managed-to-write-a-framework-agnostic-ml-pipeline-with-dvc-rust-python-287de68104c9" rel="nofollow" data-v-d1c581be><!--[-->ML Pipeline Decoupled: I managed to Write a Framework Agnostic ML Pipeline with DVC, Rust &amp; Python<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[-->To learn more about typer --&gt; <a href="https://towardsdatascience.com/data-and-machine-learning-model-versioning-with-dvc-34fdadd06b15" rel="nofollow" data-v-d1c581be><!--[-->Data and Machine Learning Model Versioning with DVC by Ruben Winastwan<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[-->To learn more about cron --&gt; <a href="https://www.hostinger.com/tutorials/cron-job" rel="nofollow" data-v-d1c581be><!--[-->Cron Job: A Comprehensive Guide for Beginners 2023 by Linas L.<!--]--></a><!--]--></li><!--]--></ul><style>html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}</style></div><!--]--><!--]--><!--[--><div class="docs-page-bottom" data-v-ba22cf1e data-v-bca27376><div class="edit-link" data-v-bca27376><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-bca27376 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="M21 12a1 1 0 0 0-1 1v6a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h6a1 1 0 0 0 0-2H5a3 3 0 0 0-3 3v14a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-6a1 1 0 0 0-1-1m-15 .76V17a1 1 0 0 0 1 1h4.24a1 1 0 0 0 .71-.29l6.92-6.93L21.71 8a1 1 0 0 0 0-1.42l-4.24-4.29a1 1 0 0 0-1.42 0l-2.82 2.83l-6.94 6.93a1 1 0 0 0-.29.71m10.76-8.35l2.83 2.83l-1.42 1.42l-2.83-2.83ZM8 13.17l5.93-5.93l2.83 2.83L10.83 16H8Z"/></svg><!--[--><a href="https://github.com/ramonpzg/edu_content/edit/main/.starters/default/content/3.data-engineering/1.data_pipelines_getting_started.md" rel="noopener noreferrer" data-v-bca27376 data-v-d1c581be><!--[--><span data-v-bca27376> Edit this page on GitHub </span><!--]--></a><!--]--></div><!----></div><div class="docs-prev-next" data-v-ba22cf1e data-v-b1d5f4ad><a href="/analytics/eda" class="prev" data-v-b1d5f4ad><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-b1d5f4ad style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m11 17l-5-5m0 0l5-5m-5 5h12"/></svg><div class="wrapper" data-v-b1d5f4ad><span class="directory" data-v-b1d5f4ad>Analytics</span><span class="title" data-v-b1d5f4ad>Exploratory Data Analysis</span></div></a><a href="/data-engineering/getting_data" class="next" data-v-b1d5f4ad><div class="wrapper" data-v-b1d5f4ad><span class="directory" data-v-b1d5f4ad>Data Engineering</span><span class="title" data-v-b1d5f4ad>Getting Data as DataFrames</span></div><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-b1d5f4ad style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m13 7l5 5m0 0l-5 5m5-5H6"/></svg></a></div><!--]--></article><div class="toc" data-v-ba22cf1e><div class="toc-wrapper" data-v-ba22cf1e><button data-v-ba22cf1e><span class="title" data-v-ba22cf1e>Table of Contents</span><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-ba22cf1e style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 5l7 7l-7 7"/></svg></button><div class="docs-toc-wrapper" data-v-ba22cf1e><div class="docs-toc" data-v-ba22cf1e data-v-ea8b373f><!--[--><div class="docs-toc-title" data-v-ea8b373f><span data-v-ea8b373f>Table of Contents</span></div><ul class="docs-toc-links" data-v-ea8b373f data-v-8eeb45b0><!--[--><li class="depth-2" data-v-8eeb45b0><a href="#table-of-contents" class="" data-v-8eeb45b0>Table of Contents</a><!----></li><li class="depth-2" data-v-8eeb45b0><a href="#_1-overview" class="" data-v-8eeb45b0>1. Overview</a><!----></li><li class="depth-2" data-v-8eeb45b0><a href="#_2-learning-outcomes" class="" data-v-8eeb45b0>2. Learning Outcomes</a><!----></li><li class="depth-2" data-v-8eeb45b0><a href="#_3-data" class="" data-v-8eeb45b0>3. Data</a><!----></li><li class="depth-2" data-v-8eeb45b0><a href="#_4-tools" class="" data-v-8eeb45b0>4. Tools</a><!----></li><li class="depth-2" data-v-8eeb45b0><a href="#_5-data-pipelines" class="" data-v-8eeb45b0>5. Data Pipelines</a><!----></li><li class="depth-2" data-v-8eeb45b0><a href="#_6-building-a-framework" class="" data-v-8eeb45b0>6. Building a Framework</a><ul class="docs-toc-links" data-v-8eeb45b0 data-v-8eeb45b0><!--[--><li class="depth-3" data-v-8eeb45b0><a href="#_61-setting-up-a-dev-environment" class="" data-v-8eeb45b0>6.1 Setting Up a Dev Environment</a><!----></li><li class="depth-3" data-v-8eeb45b0><a href="#_62-extract" class="" data-v-8eeb45b0>6.2 Extract</a><!----></li><li class="depth-3" data-v-8eeb45b0><a href="#_63-transform" class="" data-v-8eeb45b0>6.3 Transform</a><!----></li><li class="depth-3" data-v-8eeb45b0><a href="#exercise" class="" data-v-8eeb45b0>Exercise</a><!----></li><li class="depth-3" data-v-8eeb45b0><a href="#_62-load" class="" data-v-8eeb45b0>6.2 Load</a><!----></li><!--]--></ul></li><li class="depth-2" data-v-8eeb45b0><a href="#_7-reproducible-pipelines" class="" data-v-8eeb45b0>7. Reproducible Pipelines</a><ul class="docs-toc-links" data-v-8eeb45b0 data-v-8eeb45b0><!--[--><li class="depth-3" data-v-8eeb45b0><a href="#exercise-1" class="" data-v-8eeb45b0>Exercise</a><!----></li><!--]--></ul></li><li class="depth-2" data-v-8eeb45b0><a href="#_8-scheduling" class="" data-v-8eeb45b0>8. Scheduling</a><!----></li><li class="depth-2" data-v-8eeb45b0><a href="#_9-exercises" class="" data-v-8eeb45b0>9. Exercises</a><ul class="docs-toc-links" data-v-8eeb45b0 data-v-8eeb45b0><!--[--><li class="depth-3" data-v-8eeb45b0><a href="#exercise-1-1" class="" data-v-8eeb45b0>Exercise 1</a><!----></li><li class="depth-3" data-v-8eeb45b0><a href="#exercise-2" class="" data-v-8eeb45b0>Exercise 2</a><!----></li><!--]--></ul></li><li class="depth-2" data-v-8eeb45b0><a href="#_10-resources" class="" data-v-8eeb45b0>10. Resources</a><!----></li><!--]--></ul><!--]--></div></div></div></div><!--]--></div></div><!--]--></main><footer data-v-5518b344 data-v-e014242d><div class="container pv-AqetxZ pc-WeORjx footer-container" data-v-e014242d data-v-f95e3fe1><!--[--><div class="left" data-v-e014242d><a href="ramonpzg.github.io" rel="noopener" target="_blank" data-v-e014242d><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon left-icon" data-v-e014242d style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg><p data-v-e014242d>With ❤️ from the DR 🇩🇴</p></a></div><div class="center" data-v-e014242d><!--[--><!--]--></div><div class="right" data-v-e014242d><!--[--><!--]--><!--[--><a href="https://github.com/ramonpzg/edu_content" rel="noopener noreferrer" target="_blank" title="ramonpzg/edu_content" aria-label="ramonpzg/edu_content" data-v-ab03fb65><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-ab03fb65 style="" width="1em" height="1em" viewBox="0 0 496 512" data-v-a6937c2d><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2"/></svg></a><a href="https://nuxt.com" rel="noopener noreferrer" target="_blank" title="Nuxt" aria-label="Nuxt" data-v-ab03fb65><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-ab03fb65 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="M13.464 19.83h8.922c.283 0 .562-.073.807-.21a1.6 1.6 0 0 0 .591-.574a1.53 1.53 0 0 0 .216-.783a1.53 1.53 0 0 0-.217-.782L17.792 7.414a1.6 1.6 0 0 0-.591-.573a1.65 1.65 0 0 0-.807-.21c-.283 0-.562.073-.807.21a1.6 1.6 0 0 0-.59.573L13.463 9.99L10.47 4.953a1.6 1.6 0 0 0-.591-.573a1.65 1.65 0 0 0-.807-.21c-.284 0-.562.073-.807.21a1.6 1.6 0 0 0-.591.573L.216 17.481a1.53 1.53 0 0 0-.217.782c0 .275.074.545.216.783a1.6 1.6 0 0 0 .59.574c.246.137.525.21.808.21h5.6c2.22 0 3.856-.946 4.982-2.79l2.733-4.593l1.464-2.457l4.395 7.382h-5.859Zm-6.341-2.46l-3.908-.002l5.858-9.842l2.923 4.921l-1.957 3.29c-.748 1.196-1.597 1.632-2.916 1.632"/></svg></a><!--]--></div><!--]--></div></footer></div></div><div id="teleports"></div><script type="application/json" id="__NUXT_DATA__" data-ssr="true" data-src="/data-engineering/data_pipelines_getting_started/_payload.json">[{"state":1,"once":5551,"_errors":5553,"serverRendered":2302,"path":7,"prerenderedAt":5556},["Reactive",2],{"$sdd-pages":3,"$sdd-surrounds":5398,"$sdd-globals":5413,"$scolor-mode":5415,"$sdd-navigation":5417,"$sicons":5496,"$sasideScroll":5542,"$sdocus-docs-aside-collapse-map-/":5543,"$sdocus-docs-aside-collapse-map-/introduction":5544,"$sdocus-docs-aside-collapse-map-/programming":5545,"$sdocus-docs-aside-collapse-map-/programming/terminal":5546,"$sdocus-docs-aside-collapse-map-/analytics":5547,"$sdocus-docs-aside-collapse-map-/data-engineering":5548,"$sdocus-docs-aside-collapse-map-/data-science":5549,"$sdocus-docs-aside-collapse-map-/ml-engineering":5550},["ShallowRef",4],["ShallowReactive",5],{"/data-engineering/data_pipelines_getting_started":6},{"_path":7,"_dir":8,"_draft":9,"_partial":9,"_locale":10,"title":11,"description":10,"body":12,"_type":5392,"_id":5393,"_source":5394,"_file":5395,"_extension":5396,"layout":5397},"/data-engineering/data_pipelines_getting_started","data-engineering",false,"","Data Pipelines From Scratch",{"type":13,"children":14,"toc":5368},"root",[15,23,33,57,64,183,189,194,199,204,237,242,247,253,258,263,286,292,300,305,310,364,369,374,376,771,776,781,787,792,855,860,866,885,890,899,904,914,924,932,937,942,1027,1032,1044,1075,1089,1112,1135,1149,1186,1209,1244,1285,1298,1309,1328,1336,1341,1354,1368,1388,1436,1441,1455,1460,1516,1522,1527,1554,1559,1564,1571,1576,1649,1655,1660,1683,1688,1702,1741,1788,1809,1845,1850,1873,1911,1932,1946,1969,2007,2029,2043,2074,2120,2133,2203,2241,2262,2282,2852,2865,2945,2950,3048,3062,3068,3075,3080,3085,3090,3112,3126,3180,3203,3217,3387,3401,3406,3429,3443,3473,3487,3518,3541,3554,3568,3582,3652,3658,3663,3681,3694,3717,3730,3753,3776,3790,3809,4341,4355,4361,4366,4378,4383,4392,4400,4408,4416,4421,4429,4437,4445,4453,4465,4473,4479,4491,4496,4595,4608,4613,4618,4779,4938,4943,4948,5093,5098,5180,5185,5191,5196,5201,5209,5215,5221,5247,5253,5276,5282,5287,5362],{"type":16,"tag":17,"props":18,"children":20},"element","h1",{"id":19},"data-pipelines-from-scratch",[21],{"type":22,"value":11},"text",{"type":16,"tag":24,"props":25,"children":26},"blockquote",{},[27],{"type":16,"tag":28,"props":29,"children":30},"p",{},[31],{"type":22,"value":32},"“Without a systematic way to start and keep data clean, bad data will happen.” ~ Donato Diorio",{"type":16,"tag":28,"props":34,"children":35},{},[36,42,46,48],{"type":16,"tag":37,"props":38,"children":41},"img",{"alt":39,"src":40},"flow","https://drawio-app.com/wp-content/uploads/2019/05/How-to-create-flow-charts-in-drawio-1-1.png",[],{"type":16,"tag":43,"props":44,"children":45},"br",{},[],{"type":22,"value":47},"\nSource: ",{"type":16,"tag":49,"props":50,"children":54},"a",{"href":51,"rel":52},"https://drawio-app.com/flowcharts/",[53],"nofollow",[55],{"type":22,"value":56},"draw.io",{"type":16,"tag":58,"props":59,"children":61},"h2",{"id":60},"table-of-contents",[62],{"type":22,"value":63},"Table of Contents",{"type":16,"tag":65,"props":66,"children":67},"ol",{},[68,78,87,96,105,114,147,156,165,174],{"type":16,"tag":69,"props":70,"children":71},"li",{},[72],{"type":16,"tag":49,"props":73,"children":75},{"href":74},"##1.-Overview",[76],{"type":22,"value":77},"Overview",{"type":16,"tag":69,"props":79,"children":80},{},[81],{"type":16,"tag":49,"props":82,"children":84},{"href":83},"##2.-Learning-Outcomes",[85],{"type":22,"value":86},"Learning Outcomes",{"type":16,"tag":69,"props":88,"children":89},{},[90],{"type":16,"tag":49,"props":91,"children":93},{"href":92},"##3.-Data",[94],{"type":22,"value":95},"Data",{"type":16,"tag":69,"props":97,"children":98},{},[99],{"type":16,"tag":49,"props":100,"children":102},{"href":101},"##4.-Tools",[103],{"type":22,"value":104},"Tools",{"type":16,"tag":69,"props":106,"children":107},{},[108],{"type":16,"tag":49,"props":109,"children":111},{"href":110},"##5.-Data-Pipelines",[112],{"type":22,"value":113},"Data Pipelines",{"type":16,"tag":69,"props":115,"children":116},{},[117,123],{"type":16,"tag":49,"props":118,"children":120},{"href":119},"##6.-Building-a-Framework",[121],{"type":22,"value":122},"Building a Framework",{"type":16,"tag":124,"props":125,"children":126},"ul",{},[127,132,137,142],{"type":16,"tag":69,"props":128,"children":129},{},[130],{"type":22,"value":131},"Set Up Dev Environment",{"type":16,"tag":69,"props":133,"children":134},{},[135],{"type":22,"value":136},"Extract",{"type":16,"tag":69,"props":138,"children":139},{},[140],{"type":22,"value":141},"Transform",{"type":16,"tag":69,"props":143,"children":144},{},[145],{"type":22,"value":146},"Load",{"type":16,"tag":69,"props":148,"children":149},{},[150],{"type":16,"tag":49,"props":151,"children":153},{"href":152},"##7.-Reproducible-Pipelines",[154],{"type":22,"value":155},"Reproducible Pipelines",{"type":16,"tag":69,"props":157,"children":158},{},[159],{"type":16,"tag":49,"props":160,"children":162},{"href":161},"##8.-Scheduling",[163],{"type":22,"value":164},"Scheduling",{"type":16,"tag":69,"props":166,"children":167},{},[168],{"type":16,"tag":49,"props":169,"children":171},{"href":170},"##9.-Exercises",[172],{"type":22,"value":173},"Exercises",{"type":16,"tag":69,"props":175,"children":176},{},[177],{"type":16,"tag":49,"props":178,"children":180},{"href":179},"##10.-Resources",[181],{"type":22,"value":182},"Resources",{"type":16,"tag":58,"props":184,"children":186},{"id":185},"_1-overview",[187],{"type":22,"value":188},"1. Overview",{"type":16,"tag":28,"props":190,"children":191},{},[192],{"type":22,"value":193},"In order to create successful and reproducible data pipelines we need -- at the bare minimum -- tools that allow us manage where and how we store our data, how we run our computations, and how we version control everything we do. This is what we will focus on in this part of the workshop.",{"type":16,"tag":28,"props":195,"children":196},{},[197],{"type":22,"value":198},"The assumption of this section is that most of your data work can fit in a computer but, if the need were to arise, you could still use the code in this section with a beefier machine and it would get the job done without a problem.",{"type":16,"tag":28,"props":200,"children":201},{},[202],{"type":22,"value":203},"Since the files we'll interact with will most likely live in a remote server, we'll",{"type":16,"tag":65,"props":205,"children":206},{},[207,212,217,222,227,232],{"type":16,"tag":69,"props":208,"children":209},{},[210],{"type":22,"value":211},"extract a copy of the data we'll use and save it to our local files;",{"type":16,"tag":69,"props":213,"children":214},{},[215],{"type":22,"value":216},"transform the data into the shape and form we need it to be in;",{"type":16,"tag":69,"props":218,"children":219},{},[220],{"type":22,"value":221},"load it into a local data warehouse based on the popular tool, duckdb;",{"type":16,"tag":69,"props":223,"children":224},{},[225],{"type":22,"value":226},"version our code and data using dvc and git;",{"type":16,"tag":69,"props":228,"children":229},{},[230],{"type":22,"value":231},"create a command line tool to run all of our jobs;",{"type":16,"tag":69,"props":233,"children":234},{},[235],{"type":22,"value":236},"create a reproducible pipeline that can capture different workflows.",{"type":16,"tag":28,"props":238,"children":239},{},[240],{"type":22,"value":241},"Before we get started, let's go over the learning outcomes for today. :)",{"type":16,"tag":28,"props":243,"children":244},{},[245],{"type":22,"value":246},"Note: While one of the main components of data orchestration is scheduling, you can sill create pipelines and reproducible workflows that can be triggered manually rather than via a schedule.",{"type":16,"tag":58,"props":248,"children":250},{"id":249},"_2-learning-outcomes",[251],{"type":22,"value":252},"2. Learning Outcomes",{"type":16,"tag":28,"props":254,"children":255},{},[256],{"type":22,"value":257},"Before we get started, let's go over the learning outcomes for this section of the workshop.",{"type":16,"tag":28,"props":259,"children":260},{},[261],{"type":22,"value":262},"By the end of this lesson you will be able to,",{"type":16,"tag":65,"props":264,"children":265},{},[266,271,276,281],{"type":16,"tag":69,"props":267,"children":268},{},[269],{"type":22,"value":270},"Discuss what ETL and ELT Pipelines are.",{"type":16,"tag":69,"props":272,"children":273},{},[274],{"type":22,"value":275},"Understand how to read and combine data that comes from different sources.",{"type":16,"tag":69,"props":277,"children":278},{},[279],{"type":22,"value":280},"Create data pipelines using open-source tools.",{"type":16,"tag":69,"props":282,"children":283},{},[284],{"type":22,"value":285},"Develop command line tools.",{"type":16,"tag":58,"props":287,"children":289},{"id":288},"_3-data",[290],{"type":22,"value":291},"3. Data",{"type":16,"tag":28,"props":293,"children":294},{},[295],{"type":16,"tag":37,"props":296,"children":299},{"alt":297,"src":298},"bikes","https://upload.wikimedia.org/wikipedia/commons/2/20/Bike_share.jpg",[],{"type":16,"tag":28,"props":301,"children":302},{},[303],{"type":22,"value":304},"All three data files contain similar information about how many bicycles have been rented each hour, day, week and months for several years and for each city government we are working with.",{"type":16,"tag":28,"props":306,"children":307},{},[308],{"type":22,"value":309},"You can get more information about the data of each city using the following links.",{"type":16,"tag":124,"props":311,"children":312},{},[313,323,333,343],{"type":16,"tag":69,"props":314,"children":315},{},[316],{"type":16,"tag":49,"props":317,"children":320},{"href":318,"rel":319},"https://archive.ics.uci.edu/ml/datasets/Seoul+Bike+Sharing+Demand#",[53],[321],{"type":22,"value":322},"Seoul, South Korea",{"type":16,"tag":69,"props":324,"children":325},{},[326],{"type":16,"tag":49,"props":327,"children":330},{"href":328,"rel":329},"https://www.kaggle.com/hmavrodiev/london-bike-sharing-dataset",[53],[331],{"type":22,"value":332},"London, England, UK",{"type":16,"tag":69,"props":334,"children":335},{},[336],{"type":16,"tag":49,"props":337,"children":340},{"href":338,"rel":339},"https://www.kaggle.com/marklvl/bike-sharing-dataset?select=hour.csv",[53],[341],{"type":22,"value":342},"Washington, DC, USA",{"type":16,"tag":69,"props":344,"children":345},{},[346,353,355,362],{"type":16,"tag":49,"props":347,"children":350},{"href":348,"rel":349},"https://www.kaggle.com/datasets/imakash3011/rental-bike-sharing",[53],[351],{"type":22,"value":352},"Porto, Portugal",{"type":22,"value":354}," -- This one was shared in Kaggle, but you can also find the original source with more, up-to-date data, ",{"type":16,"tag":49,"props":356,"children":359},{"href":357,"rel":358},"https://capitalbikeshare.com/system-data",[53],[360],{"type":22,"value":361},"here",{"type":22,"value":363},".",{"type":16,"tag":28,"props":365,"children":366},{},[367],{"type":22,"value":368},"Note: Some datasets might come with another file containing daily information, but for our purposes, we will be using the hourly one.",{"type":16,"tag":28,"props":370,"children":371},{},[372],{"type":22,"value":373},"Here are the variables that appear in all data sets.",{"type":22,"value":375},"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",{"type":16,"tag":377,"props":378,"children":379},"table",{},[380,410],{"type":16,"tag":381,"props":382,"children":383},"thead",{},[384],{"type":16,"tag":385,"props":386,"children":387},"tr",{},[388,395,400,405],{"type":16,"tag":389,"props":390,"children":392},"th",{"align":391},"center",[393],{"type":22,"value":394},"London",{"type":16,"tag":389,"props":396,"children":397},{"align":391},[398],{"type":22,"value":399},"Seoul",{"type":16,"tag":389,"props":401,"children":402},{"align":391},[403],{"type":22,"value":404},"Washington",{"type":16,"tag":389,"props":406,"children":407},{"align":391},[408],{"type":22,"value":409},"Porto",{"type":16,"tag":411,"props":412,"children":413},"tbody",{},[414,437,459,482,505,528,551,574,595,617,638,658,678,698,718,736,754],{"type":16,"tag":385,"props":415,"children":416},{},[417,423,428,433],{"type":16,"tag":418,"props":419,"children":420},"td",{"align":391},[421],{"type":22,"value":422},"date",{"type":16,"tag":418,"props":424,"children":425},{"align":391},[426],{"type":22,"value":427},"Date",{"type":16,"tag":418,"props":429,"children":430},{"align":391},[431],{"type":22,"value":432},"instant",{"type":16,"tag":418,"props":434,"children":435},{"align":391},[436],{"type":22,"value":432},{"type":16,"tag":385,"props":438,"children":439},{},[440,445,450,454],{"type":16,"tag":418,"props":441,"children":442},{"align":391},[443],{"type":22,"value":444},"count",{"type":16,"tag":418,"props":446,"children":447},{"align":391},[448],{"type":22,"value":449},"Rented Bike Count",{"type":16,"tag":418,"props":451,"children":452},{"align":391},[453],{"type":22,"value":422},{"type":16,"tag":418,"props":455,"children":456},{"align":391},[457],{"type":22,"value":458},"dteday",{"type":16,"tag":385,"props":460,"children":461},{},[462,467,472,477],{"type":16,"tag":418,"props":463,"children":464},{"align":391},[465],{"type":22,"value":466},"temperature",{"type":16,"tag":418,"props":468,"children":469},{"align":391},[470],{"type":22,"value":471},"Hour",{"type":16,"tag":418,"props":473,"children":474},{"align":391},[475],{"type":22,"value":476},"seasons",{"type":16,"tag":418,"props":478,"children":479},{"align":391},[480],{"type":22,"value":481},"season",{"type":16,"tag":385,"props":483,"children":484},{},[485,490,495,500],{"type":16,"tag":418,"props":486,"children":487},{"align":391},[488],{"type":22,"value":489},"t2",{"type":16,"tag":418,"props":491,"children":492},{"align":391},[493],{"type":22,"value":494},"Temperature(C)",{"type":16,"tag":418,"props":496,"children":497},{"align":391},[498],{"type":22,"value":499},"year",{"type":16,"tag":418,"props":501,"children":502},{"align":391},[503],{"type":22,"value":504},"yr",{"type":16,"tag":385,"props":506,"children":507},{},[508,513,518,523],{"type":16,"tag":418,"props":509,"children":510},{"align":391},[511],{"type":22,"value":512},"humidity",{"type":16,"tag":418,"props":514,"children":515},{"align":391},[516],{"type":22,"value":517},"Humidity(%)",{"type":16,"tag":418,"props":519,"children":520},{"align":391},[521],{"type":22,"value":522},"month",{"type":16,"tag":418,"props":524,"children":525},{"align":391},[526],{"type":22,"value":527},"mnth",{"type":16,"tag":385,"props":529,"children":530},{},[531,536,541,546],{"type":16,"tag":418,"props":532,"children":533},{"align":391},[534],{"type":22,"value":535},"wind_speed",{"type":16,"tag":418,"props":537,"children":538},{"align":391},[539],{"type":22,"value":540},"Wind speed (m/s)",{"type":16,"tag":418,"props":542,"children":543},{"align":391},[544],{"type":22,"value":545},"hour",{"type":16,"tag":418,"props":547,"children":548},{"align":391},[549],{"type":22,"value":550},"hr",{"type":16,"tag":385,"props":552,"children":553},{},[554,559,564,569],{"type":16,"tag":418,"props":555,"children":556},{"align":391},[557],{"type":22,"value":558},"weather_code",{"type":16,"tag":418,"props":560,"children":561},{"align":391},[562],{"type":22,"value":563},"Visibility  (10m)",{"type":16,"tag":418,"props":565,"children":566},{"align":391},[567],{"type":22,"value":568},"is_holiday",{"type":16,"tag":418,"props":570,"children":571},{"align":391},[572],{"type":22,"value":573},"holiday",{"type":16,"tag":385,"props":575,"children":576},{},[577,581,586,591],{"type":16,"tag":418,"props":578,"children":579},{"align":391},[580],{"type":22,"value":568},{"type":16,"tag":418,"props":582,"children":583},{"align":391},[584],{"type":22,"value":585},"Dew point temperature(ï¿½C)",{"type":16,"tag":418,"props":587,"children":588},{"align":391},[589],{"type":22,"value":590},"weekday",{"type":16,"tag":418,"props":592,"children":593},{"align":391},[594],{"type":22,"value":590},{"type":16,"tag":385,"props":596,"children":597},{},[598,603,608,613],{"type":16,"tag":418,"props":599,"children":600},{"align":391},[601],{"type":22,"value":602},"is_weekend",{"type":16,"tag":418,"props":604,"children":605},{"align":391},[606],{"type":22,"value":607},"Solar Radiation (MJ/m2)",{"type":16,"tag":418,"props":609,"children":610},{"align":391},[611],{"type":22,"value":612},"workingday",{"type":16,"tag":418,"props":614,"children":615},{"align":391},[616],{"type":22,"value":612},{"type":16,"tag":385,"props":618,"children":619},{},[620,624,629,634],{"type":16,"tag":418,"props":621,"children":622},{"align":391},[623],{"type":22,"value":476},{"type":16,"tag":418,"props":625,"children":626},{"align":391},[627],{"type":22,"value":628},"Rainfall(mm)",{"type":16,"tag":418,"props":630,"children":631},{"align":391},[632],{"type":22,"value":633},"weathersit",{"type":16,"tag":418,"props":635,"children":636},{"align":391},[637],{"type":22,"value":633},{"type":16,"tag":385,"props":639,"children":640},{},[641,644,649,653],{"type":16,"tag":418,"props":642,"children":643},{"align":391},[],{"type":16,"tag":418,"props":645,"children":646},{"align":391},[647],{"type":22,"value":648},"Snowfall(cm)",{"type":16,"tag":418,"props":650,"children":651},{"align":391},[652],{"type":22,"value":466},{"type":16,"tag":418,"props":654,"children":655},{"align":391},[656],{"type":22,"value":657},"temp",{"type":16,"tag":385,"props":659,"children":660},{},[661,664,669,673],{"type":16,"tag":418,"props":662,"children":663},{"align":391},[],{"type":16,"tag":418,"props":665,"children":666},{"align":391},[667],{"type":22,"value":668},"Seasons",{"type":16,"tag":418,"props":670,"children":671},{"align":391},[672],{"type":22,"value":444},{"type":16,"tag":418,"props":674,"children":675},{"align":391},[676],{"type":22,"value":677},"atemp",{"type":16,"tag":385,"props":679,"children":680},{},[681,684,689,693],{"type":16,"tag":418,"props":682,"children":683},{"align":391},[],{"type":16,"tag":418,"props":685,"children":686},{"align":391},[687],{"type":22,"value":688},"Holiday",{"type":16,"tag":418,"props":690,"children":691},{"align":391},[692],{"type":22,"value":512},{"type":16,"tag":418,"props":694,"children":695},{"align":391},[696],{"type":22,"value":697},"hum",{"type":16,"tag":385,"props":699,"children":700},{},[701,704,709,713],{"type":16,"tag":418,"props":702,"children":703},{"align":391},[],{"type":16,"tag":418,"props":705,"children":706},{"align":391},[707],{"type":22,"value":708},"Functioning Day",{"type":16,"tag":418,"props":710,"children":711},{"align":391},[712],{"type":22,"value":535},{"type":16,"tag":418,"props":714,"children":715},{"align":391},[716],{"type":22,"value":717},"windspeed",{"type":16,"tag":385,"props":719,"children":720},{},[721,724,727,732],{"type":16,"tag":418,"props":722,"children":723},{"align":391},[],{"type":16,"tag":418,"props":725,"children":726},{"align":391},[],{"type":16,"tag":418,"props":728,"children":729},{"align":391},[730],{"type":22,"value":731},"casual",{"type":16,"tag":418,"props":733,"children":734},{"align":391},[735],{"type":22,"value":731},{"type":16,"tag":385,"props":737,"children":738},{},[739,742,745,750],{"type":16,"tag":418,"props":740,"children":741},{"align":391},[],{"type":16,"tag":418,"props":743,"children":744},{"align":391},[],{"type":16,"tag":418,"props":746,"children":747},{"align":391},[748],{"type":22,"value":749},"registered",{"type":16,"tag":418,"props":751,"children":752},{"align":391},[753],{"type":22,"value":749},{"type":16,"tag":385,"props":755,"children":756},{},[757,760,763,766],{"type":16,"tag":418,"props":758,"children":759},{"align":391},[],{"type":16,"tag":418,"props":761,"children":762},{"align":391},[],{"type":16,"tag":418,"props":764,"children":765},{"align":391},[],{"type":16,"tag":418,"props":767,"children":768},{"align":391},[769],{"type":22,"value":770},"cnt",{"type":16,"tag":28,"props":772,"children":773},{},[774],{"type":22,"value":775},"Since all of these datasets were generated with different logic (e.g. celsius vs fahrenheit, or other divergent measures) and, most likely, by different systems, we can expect more inconsistencies than just unmatching column names, numerical formats, and data collected.",{"type":16,"tag":28,"props":777,"children":778},{},[779],{"type":22,"value":780},"We will walk through an example pipeline and several cleaning steps after we discuss the tools we will be using today.",{"type":16,"tag":58,"props":782,"children":784},{"id":783},"_4-tools",[785],{"type":22,"value":786},"4. Tools",{"type":16,"tag":28,"props":788,"children":789},{},[790],{"type":22,"value":791},"The tools that we will use in this section of the workshop are the following.",{"type":16,"tag":124,"props":793,"children":794},{},[795,807,819,831,843],{"type":16,"tag":69,"props":796,"children":797},{},[798,805],{"type":16,"tag":49,"props":799,"children":802},{"href":800,"rel":801},"https://pandas.pydata.org/",[53],[803],{"type":22,"value":804},"pandas",{"type":22,"value":806}," - \"is a fast, powerful, flexible and easy to use open source data analysis and manipulation tool, built on top of the Python programming language.\"",{"type":16,"tag":69,"props":808,"children":809},{},[810,817],{"type":16,"tag":49,"props":811,"children":814},{"href":812,"rel":813},"https://dvc.org/",[53],[815],{"type":22,"value":816},"dvc",{"type":22,"value":818}," - \"DVC is built to make ML models shareable and reproducible. It is designed to handle large files, data sets, machine learning models, and metrics as well as code.\"",{"type":16,"tag":69,"props":820,"children":821},{},[822,829],{"type":16,"tag":49,"props":823,"children":826},{"href":824,"rel":825},"https://ibis-project.org/",[53],[827],{"type":22,"value":828},"ibis",{"type":22,"value":830}," - \"Ibis is a Python library that provides a lightweight, universal interface for data wrangling. It helps Python users explore and transform data of any size, stored anywhere.\"",{"type":16,"tag":69,"props":832,"children":833},{},[834,841],{"type":16,"tag":49,"props":835,"children":838},{"href":836,"rel":837},"https://typer.tiangolo.com/",[53],[839],{"type":22,"value":840},"typer",{"type":22,"value":842}," - \"Typer is a library for building CLI applications that users will love using and developers will love creating. Based on Python 3.6+ type hints.\"",{"type":16,"tag":69,"props":844,"children":845},{},[846,853],{"type":16,"tag":49,"props":847,"children":850},{"href":848,"rel":849},"https://docs.python.org/3/library/pathlib.html",[53],[851],{"type":22,"value":852},"pathlib",{"type":22,"value":854}," - allows us to manipulate paths as if they were python objects.",{"type":16,"tag":28,"props":856,"children":857},{},[858],{"type":22,"value":859},"Let's get started building data pipelines! :)",{"type":16,"tag":58,"props":861,"children":863},{"id":862},"_5-data-pipelines",[864],{"type":22,"value":865},"5. Data Pipelines",{"type":16,"tag":28,"props":867,"children":868},{},[869,874,877,878],{"type":16,"tag":37,"props":870,"children":873},{"alt":871,"src":872},"etl_pipe","https://editor.analyticsvidhya.com/uploads/899101.png",[],{"type":16,"tag":43,"props":875,"children":876},{},[],{"type":22,"value":47},{"type":16,"tag":49,"props":879,"children":882},{"href":880,"rel":881},"https://www.striim.com/",[53],[883],{"type":22,"value":884},"Striim",{"type":16,"tag":28,"props":886,"children":887},{},[888],{"type":22,"value":889},"There are different kinds of data pipelines, but two, in particular, dominate a big part of the data engineering world today, ETL and ELT pipelines.",{"type":16,"tag":28,"props":891,"children":892},{},[893],{"type":16,"tag":894,"props":895,"children":896},"strong",{},[897],{"type":22,"value":898},"What are ETL Pipelines?",{"type":16,"tag":28,"props":900,"children":901},{},[902],{"type":22,"value":903},"The acronym ETL stands for Extract, Transform, and Load, and it is the process where data gets extracted from one or multiple sources, it gets processed in-transit, and then it gets loaded into place where data consumers can use (e.g. a data warehouse). These consumers can be data analysts, data scientists, and machine learning engineers, among many others.",{"type":16,"tag":28,"props":905,"children":906},{},[907,912],{"type":16,"tag":894,"props":908,"children":909},{},[910],{"type":22,"value":911},"What are ELT Pipelines?",{"type":22,"value":913},"\nWith this approach, all the data, structured and unstructured, gets loaded into a data lake or warehouse before it gets transformed. With this approach, a lot of money spent on compute can be saved by only processing the data we need rather than all of it.",{"type":16,"tag":28,"props":915,"children":916},{},[917,922],{"type":16,"tag":894,"props":918,"children":919},{},[920],{"type":22,"value":921},"What are Reverse ETL Pipelines?",{"type":22,"value":923},"\nReverse ETL tools take data from the data lake or warehouse back into business (critical) applications. For example, information about new customers that have not yet been populated into salesforce or other marketing tools for further use by the marketing, sales, and finance teams, and so on...",{"type":16,"tag":28,"props":925,"children":926},{},[927],{"type":16,"tag":894,"props":928,"children":929},{},[930],{"type":22,"value":931},"Why should you learn how to create them?",{"type":16,"tag":28,"props":933,"children":934},{},[935],{"type":22,"value":936},"Data Pipeline tools enable data integration strategies by allowing companies to gather data from multiple data sources and consolidate it into a single, centralized location. ETL tools also make it possible for different types of data to work together, for example, data generated by the company can be combined with GPS and Temperature data coming from different sources.",{"type":16,"tag":28,"props":938,"children":939},{},[940],{"type":22,"value":941},"As data professionals, our task is to create value for our organizations, our clients and our collaborators using some of or all the data at our disposal. However, there are factors that can delay this process a little bit or a lot, for example, we often need to understand beforehand,",{"type":16,"tag":65,"props":943,"children":944},{},[945,973,1000],{"type":16,"tag":69,"props":946,"children":947},{},[948,950],{"type":22,"value":949},"Information about the process by which the data we're dealing with was generated, e.g.\n",{"type":16,"tag":124,"props":951,"children":952},{},[953,958,963,968],{"type":16,"tag":69,"props":954,"children":955},{},[956],{"type":22,"value":957},"Point of sale",{"type":16,"tag":69,"props":959,"children":960},{},[961],{"type":22,"value":962},"Clicks on an online marketplace like Amazon, Etzy, Ebay, ect.",{"type":16,"tag":69,"props":964,"children":965},{},[966],{"type":22,"value":967},"A/B Test Results",{"type":16,"tag":69,"props":969,"children":970},{},[971],{"type":22,"value":972},"...",{"type":16,"tag":69,"props":974,"children":975},{},[976,978],{"type":22,"value":977},"Information about the transformations that occurred during the cleaning and merging process, prior to us jumping on board,\n",{"type":16,"tag":124,"props":979,"children":980},{},[981,986,991,996],{"type":16,"tag":69,"props":982,"children":983},{},[984],{"type":22,"value":985},"Celsius degrees were converted into fahrenheit",{"type":16,"tag":69,"props":987,"children":988},{},[989],{"type":22,"value":990},"Prices in Chilean pesos were converted to Rands",{"type":16,"tag":69,"props":992,"children":993},{},[994],{"type":22,"value":995},"Non-numerical and unavailable observations now contain \"Not Available\" or \"Unknown\"",{"type":16,"tag":69,"props":997,"children":998},{},[999],{"type":22,"value":972},{"type":16,"tag":69,"props":1001,"children":1002},{},[1003,1005],{"type":22,"value":1004},"Information about how the data was stored and where. For instance,\n",{"type":16,"tag":124,"props":1006,"children":1007},{},[1008,1013,1018,1023],{"type":16,"tag":69,"props":1009,"children":1010},{},[1011],{"type":22,"value":1012},"Parquet format",{"type":16,"tag":69,"props":1014,"children":1015},{},[1016],{"type":22,"value":1017},"NOSQL or SQL database",{"type":16,"tag":69,"props":1019,"children":1020},{},[1021],{"type":22,"value":1022},"CSV",{"type":16,"tag":69,"props":1024,"children":1025},{},[1026],{"type":22,"value":972},{"type":16,"tag":28,"props":1028,"children":1029},{},[1030],{"type":22,"value":1031},"Understanding how the three processes described above flow will help us have more knowledge about the data that we are going to use, and how to best access it, transform it, and model it before we put it to good use.",{"type":16,"tag":28,"props":1033,"children":1034},{},[1035,1037,1043],{"type":22,"value":1036},"Let's walk through an example of a data pipeline using data from wildfires between 1983-2020 in the United States. You can find more information about the dataset ",{"type":16,"tag":49,"props":1038,"children":1041},{"href":1039,"rel":1040},"https://www.kaggle.com/kkhandekar/total-wildfires-acres-affected-1983-2020",[53],[1042],{"type":22,"value":361},{"type":22,"value":363},{"type":16,"tag":1045,"props":1046,"children":1050},"pre",{"code":1047,"language":1048,"meta":10,"className":1049,"style":10},"import pandas as pd\nfrom pathlib import Path\n","python","language-python shiki shiki-themes github-dark github-light",[1051],{"type":16,"tag":1052,"props":1053,"children":1054},"code",{"__ignoreMap":10},[1055,1066],{"type":16,"tag":1056,"props":1057,"children":1060},"span",{"class":1058,"line":1059},"line",1,[1061],{"type":16,"tag":1056,"props":1062,"children":1063},{},[1064],{"type":22,"value":1065},"import pandas as pd\n",{"type":16,"tag":1056,"props":1067,"children":1069},{"class":1058,"line":1068},2,[1070],{"type":16,"tag":1056,"props":1071,"children":1072},{},[1073],{"type":22,"value":1074},"from pathlib import Path\n",{"type":16,"tag":1045,"props":1076,"children":1078},{"code":1077,"language":1048,"meta":10,"className":1049,"style":10},"!pwd\n",[1079],{"type":16,"tag":1052,"props":1080,"children":1081},{"__ignoreMap":10},[1082],{"type":16,"tag":1056,"props":1083,"children":1084},{"class":1058,"line":1059},[1085],{"type":16,"tag":1056,"props":1086,"children":1087},{},[1088],{"type":22,"value":1077},{"type":16,"tag":1045,"props":1090,"children":1092},{"code":1091,"language":1048,"meta":10,"className":1049,"style":10},"data_path = Path().cwd().parent/\"data\"\ndata_path\n",[1093],{"type":16,"tag":1052,"props":1094,"children":1095},{"__ignoreMap":10},[1096,1104],{"type":16,"tag":1056,"props":1097,"children":1098},{"class":1058,"line":1059},[1099],{"type":16,"tag":1056,"props":1100,"children":1101},{},[1102],{"type":22,"value":1103},"data_path = Path().cwd().parent/\"data\"\n",{"type":16,"tag":1056,"props":1105,"children":1106},{"class":1058,"line":1068},[1107],{"type":16,"tag":1056,"props":1108,"children":1109},{},[1110],{"type":22,"value":1111},"data_path\n",{"type":16,"tag":1045,"props":1113,"children":1115},{"code":1114,"language":1048,"meta":10,"className":1049,"style":10},"example_data_in = data_path.joinpath(\"example\", \"federal_firefighting_costs.csv\")\npd.read_csv(example_data_in).head()\n",[1116],{"type":16,"tag":1052,"props":1117,"children":1118},{"__ignoreMap":10},[1119,1127],{"type":16,"tag":1056,"props":1120,"children":1121},{"class":1058,"line":1059},[1122],{"type":16,"tag":1056,"props":1123,"children":1124},{},[1125],{"type":22,"value":1126},"example_data_in = data_path.joinpath(\"example\", \"federal_firefighting_costs.csv\")\n",{"type":16,"tag":1056,"props":1128,"children":1129},{"class":1058,"line":1068},[1130],{"type":16,"tag":1056,"props":1131,"children":1132},{},[1133],{"type":22,"value":1134},"pd.read_csv(example_data_in).head()\n",{"type":16,"tag":1045,"props":1136,"children":1138},{"code":1137,"language":1048,"meta":10,"className":1049,"style":10},"pd.read_csv(example_data_in).dtypes\n",[1139],{"type":16,"tag":1052,"props":1140,"children":1141},{"__ignoreMap":10},[1142],{"type":16,"tag":1056,"props":1143,"children":1144},{"class":1058,"line":1059},[1145],{"type":16,"tag":1056,"props":1146,"children":1147},{},[1148],{"type":22,"value":1137},{"type":16,"tag":28,"props":1150,"children":1151},{},[1152,1154,1160,1162,1168,1170,1176,1178,1184],{"type":22,"value":1153},"As you can see, most columns contain a ",{"type":16,"tag":1052,"props":1155,"children":1157},{"className":1156},[],[1158],{"type":22,"value":1159},"$",{"type":22,"value":1161}," dollar sign and some ",{"type":16,"tag":1052,"props":1163,"children":1165},{"className":1164},[],[1166],{"type":22,"value":1167},",",{"type":22,"value":1169}," commas, and because this forces Python to treat numbers as objects (or strings) rather than ",{"type":16,"tag":1052,"props":1171,"children":1173},{"className":1172},[],[1174],{"type":22,"value":1175},"int",{"type":22,"value":1177},"'s or ",{"type":16,"tag":1052,"props":1179,"children":1181},{"className":1180},[],[1182],{"type":22,"value":1183},"float",{"type":22,"value":1185},"'s, we will have to remove these signs in our transformation step after extracting the data and before loading a clean version of it to a new location. Let's create 3 re-usable functions.",{"type":16,"tag":1045,"props":1187,"children":1189},{"code":1188,"language":1048,"meta":10,"className":1049,"style":10},"def extract(path):\n    return pd.read_csv(path)\n",[1190],{"type":16,"tag":1052,"props":1191,"children":1192},{"__ignoreMap":10},[1193,1201],{"type":16,"tag":1056,"props":1194,"children":1195},{"class":1058,"line":1059},[1196],{"type":16,"tag":1056,"props":1197,"children":1198},{},[1199],{"type":22,"value":1200},"def extract(path):\n",{"type":16,"tag":1056,"props":1202,"children":1203},{"class":1058,"line":1068},[1204],{"type":16,"tag":1056,"props":1205,"children":1206},{},[1207],{"type":22,"value":1208},"    return pd.read_csv(path)\n",{"type":16,"tag":28,"props":1210,"children":1211},{},[1212,1214,1219,1221,1226,1228,1234,1236,1242],{"type":22,"value":1213},"As you saw above, only the last 5 variables have commas (",{"type":16,"tag":1052,"props":1215,"children":1217},{"className":1216},[],[1218],{"type":22,"value":1167},{"type":22,"value":1220},") and dollar symbols (",{"type":16,"tag":1052,"props":1222,"children":1224},{"className":1223},[],[1225],{"type":22,"value":1159},{"type":22,"value":1227},") so we will replace both with an empty space (",{"type":16,"tag":1052,"props":1229,"children":1231},{"className":1230},[],[1232],{"type":22,"value":1233},"\"\"",{"type":22,"value":1235},") using a ",{"type":16,"tag":1052,"props":1237,"children":1239},{"className":1238},[],[1240],{"type":22,"value":1241},"for",{"type":22,"value":1243}," loop.",{"type":16,"tag":1045,"props":1245,"children":1247},{"code":1246,"language":1048,"meta":10,"className":1049,"style":10},"def transform(data):\n    for col in data.iloc[:, 1:].columns:\n        data[col] = data[col].str.replace(r'[^0-9]+', '', regex=True).astype(int)\n    return data\n",[1248],{"type":16,"tag":1052,"props":1249,"children":1250},{"__ignoreMap":10},[1251,1259,1267,1276],{"type":16,"tag":1056,"props":1252,"children":1253},{"class":1058,"line":1059},[1254],{"type":16,"tag":1056,"props":1255,"children":1256},{},[1257],{"type":22,"value":1258},"def transform(data):\n",{"type":16,"tag":1056,"props":1260,"children":1261},{"class":1058,"line":1068},[1262],{"type":16,"tag":1056,"props":1263,"children":1264},{},[1265],{"type":22,"value":1266},"    for col in data.iloc[:, 1:].columns:\n",{"type":16,"tag":1056,"props":1268,"children":1270},{"class":1058,"line":1269},3,[1271],{"type":16,"tag":1056,"props":1272,"children":1273},{},[1274],{"type":22,"value":1275},"        data[col] = data[col].str.replace(r'[^0-9]+', '', regex=True).astype(int)\n",{"type":16,"tag":1056,"props":1277,"children":1279},{"class":1058,"line":1278},4,[1280],{"type":16,"tag":1056,"props":1281,"children":1282},{},[1283],{"type":22,"value":1284},"    return data\n",{"type":16,"tag":28,"props":1286,"children":1287},{},[1288,1290,1296],{"type":22,"value":1289},"For the \"load\" process, we will save the data as a ",{"type":16,"tag":1052,"props":1291,"children":1293},{"className":1292},[],[1294],{"type":22,"value":1295},"parquet",{"type":22,"value":1297}," file. This is one of the most popular formats to save data in due to its compression capabilities, orientation, and speed gains in analytical workloads.",{"type":16,"tag":28,"props":1299,"children":1300},{},[1301,1303],{"type":22,"value":1302},"Here's an example on the differences between the row-like format and the columnar format of parquet files. If this interests you you can read more about it ",{"type":16,"tag":49,"props":1304,"children":1307},{"href":1305,"rel":1306},"https://datos.gob.es/en/blog/why-should-you-use-parquet-files-if-you-process-lot-data",[53],[1308],{"type":22,"value":361},{"type":16,"tag":28,"props":1310,"children":1311},{},[1312,1317,1320,1321],{"type":16,"tag":37,"props":1313,"children":1316},{"alt":1314,"src":1315},"colvsrow","https://www.scylladb.com/wp-content/uploads/columnar-database-diagram.png",[],{"type":16,"tag":43,"props":1318,"children":1319},{},[],{"type":22,"value":47},{"type":16,"tag":49,"props":1322,"children":1325},{"href":1323,"rel":1324},"https://www.scylladb.com/glossary/columnar-database/",[53],[1326],{"type":22,"value":1327},"Scylla DB",{"type":16,"tag":1045,"props":1329,"children":1331},{"code":1330,"meta":10},"def load(data, path):\n    data.to_parquet(path)\n    print(\"Successfully Loaded Your Modified Data!\")\n",[1332],{"type":16,"tag":1052,"props":1333,"children":1334},{"__ignoreMap":10},[1335],{"type":22,"value":1330},{"type":16,"tag":28,"props":1337,"children":1338},{},[1339],{"type":22,"value":1340},"Let's create an output path and with a file name to save our data as.",{"type":16,"tag":1045,"props":1342,"children":1343},{"code":1111,"language":1048,"meta":10,"className":1049,"style":10},[1344],{"type":16,"tag":1052,"props":1345,"children":1346},{"__ignoreMap":10},[1347],{"type":16,"tag":1056,"props":1348,"children":1349},{"class":1058,"line":1059},[1350],{"type":16,"tag":1056,"props":1351,"children":1352},{},[1353],{"type":22,"value":1111},{"type":16,"tag":1045,"props":1355,"children":1357},{"code":1356,"language":1048,"meta":10,"className":1049,"style":10},"example_data_out = data_path.joinpath(\"example\", \"my_test.parquet\")\n",[1358],{"type":16,"tag":1052,"props":1359,"children":1360},{"__ignoreMap":10},[1361],{"type":16,"tag":1056,"props":1362,"children":1363},{"class":1058,"line":1059},[1364],{"type":16,"tag":1056,"props":1365,"children":1366},{},[1367],{"type":22,"value":1356},{"type":16,"tag":28,"props":1369,"children":1370},{},[1371,1373,1378,1380,1386],{"type":22,"value":1372},"When we have all the steps ready, we create a new function containing our graph using the ",{"type":16,"tag":1052,"props":1374,"children":1376},{"className":1375},[],[1377],{"type":22,"value":39},{"type":22,"value":1379}," decorator. We can give this function a name, for example, ",{"type":16,"tag":1052,"props":1381,"children":1383},{"className":1382},[],[1384],{"type":22,"value":1385},"\"Example Pipeline! 😎\"",{"type":22,"value":1387}," and then chain the tasks we created previously in the order in which they should be run.",{"type":16,"tag":1045,"props":1389,"children":1391},{"code":1390,"language":1048,"meta":10,"className":1049,"style":10},"def example_etl(example_data_in, example_data_out):\n    data = extract(example_data_in)\n    data_clean = transform(data)\n    load(data_clean, example_data_out)\n    print(\"Your Pipeline Ran Successfully!\")\n",[1392],{"type":16,"tag":1052,"props":1393,"children":1394},{"__ignoreMap":10},[1395,1403,1411,1419,1427],{"type":16,"tag":1056,"props":1396,"children":1397},{"class":1058,"line":1059},[1398],{"type":16,"tag":1056,"props":1399,"children":1400},{},[1401],{"type":22,"value":1402},"def example_etl(example_data_in, example_data_out):\n",{"type":16,"tag":1056,"props":1404,"children":1405},{"class":1058,"line":1068},[1406],{"type":16,"tag":1056,"props":1407,"children":1408},{},[1409],{"type":22,"value":1410},"    data = extract(example_data_in)\n",{"type":16,"tag":1056,"props":1412,"children":1413},{"class":1058,"line":1269},[1414],{"type":16,"tag":1056,"props":1415,"children":1416},{},[1417],{"type":22,"value":1418},"    data_clean = transform(data)\n",{"type":16,"tag":1056,"props":1420,"children":1421},{"class":1058,"line":1278},[1422],{"type":16,"tag":1056,"props":1423,"children":1424},{},[1425],{"type":22,"value":1426},"    load(data_clean, example_data_out)\n",{"type":16,"tag":1056,"props":1428,"children":1430},{"class":1058,"line":1429},5,[1431],{"type":16,"tag":1056,"props":1432,"children":1433},{},[1434],{"type":22,"value":1435},"    print(\"Your Pipeline Ran Successfully!\")\n",{"type":16,"tag":28,"props":1437,"children":1438},{},[1439],{"type":22,"value":1440},"We are ready to run our workflow.",{"type":16,"tag":1045,"props":1442,"children":1444},{"code":1443,"language":1048,"meta":10,"className":1049,"style":10},"example_etl(example_data_in, example_data_out)\n",[1445],{"type":16,"tag":1052,"props":1446,"children":1447},{"__ignoreMap":10},[1448],{"type":16,"tag":1056,"props":1449,"children":1450},{"class":1058,"line":1059},[1451],{"type":16,"tag":1056,"props":1452,"children":1453},{},[1454],{"type":22,"value":1443},{"type":16,"tag":28,"props":1456,"children":1457},{},[1458],{"type":22,"value":1459},"To make sure we did everything correctly, let's create a quick visualization with pandas.",{"type":16,"tag":1045,"props":1461,"children":1463},{"code":1462,"language":1048,"meta":10,"className":1049,"style":10},"pd.read_parquet(example_data_out).plot(\n    x='Year',\n    y=\"ForestService\", \n    kind='line',\n    title=\"Forest Service costs by year\"\n);\n",[1464],{"type":16,"tag":1052,"props":1465,"children":1466},{"__ignoreMap":10},[1467,1475,1483,1491,1499,1507],{"type":16,"tag":1056,"props":1468,"children":1469},{"class":1058,"line":1059},[1470],{"type":16,"tag":1056,"props":1471,"children":1472},{},[1473],{"type":22,"value":1474},"pd.read_parquet(example_data_out).plot(\n",{"type":16,"tag":1056,"props":1476,"children":1477},{"class":1058,"line":1068},[1478],{"type":16,"tag":1056,"props":1479,"children":1480},{},[1481],{"type":22,"value":1482},"    x='Year',\n",{"type":16,"tag":1056,"props":1484,"children":1485},{"class":1058,"line":1269},[1486],{"type":16,"tag":1056,"props":1487,"children":1488},{},[1489],{"type":22,"value":1490},"    y=\"ForestService\", \n",{"type":16,"tag":1056,"props":1492,"children":1493},{"class":1058,"line":1278},[1494],{"type":16,"tag":1056,"props":1495,"children":1496},{},[1497],{"type":22,"value":1498},"    kind='line',\n",{"type":16,"tag":1056,"props":1500,"children":1501},{"class":1058,"line":1429},[1502],{"type":16,"tag":1056,"props":1503,"children":1504},{},[1505],{"type":22,"value":1506},"    title=\"Forest Service costs by year\"\n",{"type":16,"tag":1056,"props":1508,"children":1510},{"class":1058,"line":1509},6,[1511],{"type":16,"tag":1056,"props":1512,"children":1513},{},[1514],{"type":22,"value":1515},");\n",{"type":16,"tag":58,"props":1517,"children":1519},{"id":1518},"_6-building-a-framework",[1520],{"type":22,"value":1521},"6. Building a Framework",{"type":16,"tag":28,"props":1523,"children":1524},{},[1525],{"type":22,"value":1526},"In order to do our data engineering work with a personalized framework, there are a few strategies we would take.",{"type":16,"tag":124,"props":1528,"children":1529},{},[1530,1535,1549],{"type":16,"tag":69,"props":1531,"children":1532},{},[1533],{"type":22,"value":1534},"We could keep the code in our computers and copy it to a new project whenever we need to create new pipelines.",{"type":16,"tag":69,"props":1536,"children":1537},{},[1538,1540,1547],{"type":22,"value":1539},"We could create a package and either upload it to PyPI or ",{"type":16,"tag":49,"props":1541,"children":1544},{"href":1542,"rel":1543},"https://gemfury.com/",[53],[1545],{"type":22,"value":1546},"Gemfury",{"type":22,"value":1548}," (a private repository of packages for different programming languages).",{"type":16,"tag":69,"props":1550,"children":1551},{},[1552],{"type":22,"value":1553},"We could keep in neatly organized in GitHub and clone the repository to every new project.",{"type":16,"tag":28,"props":1555,"children":1556},{},[1557],{"type":22,"value":1558},"For this use case, it would be great to work with a library that we could continuously update rather than notebooks and files getting copied around. This will help us stay organized and manage dependencies more effectively.",{"type":16,"tag":28,"props":1560,"children":1561},{},[1562],{"type":22,"value":1563},"Let's get started. :)",{"type":16,"tag":1565,"props":1566,"children":1568},"h3",{"id":1567},"_61-setting-up-a-dev-environment",[1569],{"type":22,"value":1570},"6.1 Setting Up a Dev Environment",{"type":16,"tag":28,"props":1572,"children":1573},{},[1574],{"type":22,"value":1575},"Building frameworks can be super straightforward or a slightly cumbersome project. Because of this and because we are already using an environment to run this workshop in, I will leave here what I think is an excellent resource for learning about how to create Python Packages.",{"type":16,"tag":1045,"props":1577,"children":1579},{"code":1578,"language":1048,"meta":10,"className":1049,"style":10},"from IPython.display import HTML\nHTML(\"\"\"\n\u003Cdiv align=\"center\">\n    \u003Ciframe width=\"700\" height=\"450\"\n    src=\"https://youtube.com/embed/l7zS8Ld4_iA\"\n    \u003C/iframe>\n\u003C/div>\n\"\"\")\n",[1580],{"type":16,"tag":1052,"props":1581,"children":1582},{"__ignoreMap":10},[1583,1591,1599,1607,1615,1623,1631,1640],{"type":16,"tag":1056,"props":1584,"children":1585},{"class":1058,"line":1059},[1586],{"type":16,"tag":1056,"props":1587,"children":1588},{},[1589],{"type":22,"value":1590},"from IPython.display import HTML\n",{"type":16,"tag":1056,"props":1592,"children":1593},{"class":1058,"line":1068},[1594],{"type":16,"tag":1056,"props":1595,"children":1596},{},[1597],{"type":22,"value":1598},"HTML(\"\"\"\n",{"type":16,"tag":1056,"props":1600,"children":1601},{"class":1058,"line":1269},[1602],{"type":16,"tag":1056,"props":1603,"children":1604},{},[1605],{"type":22,"value":1606},"\u003Cdiv align=\"center\">\n",{"type":16,"tag":1056,"props":1608,"children":1609},{"class":1058,"line":1278},[1610],{"type":16,"tag":1056,"props":1611,"children":1612},{},[1613],{"type":22,"value":1614},"    \u003Ciframe width=\"700\" height=\"450\"\n",{"type":16,"tag":1056,"props":1616,"children":1617},{"class":1058,"line":1429},[1618],{"type":16,"tag":1056,"props":1619,"children":1620},{},[1621],{"type":22,"value":1622},"    src=\"https://youtube.com/embed/l7zS8Ld4_iA\"\n",{"type":16,"tag":1056,"props":1624,"children":1625},{"class":1058,"line":1509},[1626],{"type":16,"tag":1056,"props":1627,"children":1628},{},[1629],{"type":22,"value":1630},"    \u003C/iframe>\n",{"type":16,"tag":1056,"props":1632,"children":1634},{"class":1058,"line":1633},7,[1635],{"type":16,"tag":1056,"props":1636,"children":1637},{},[1638],{"type":22,"value":1639},"\u003C/div>\n",{"type":16,"tag":1056,"props":1641,"children":1643},{"class":1058,"line":1642},8,[1644],{"type":16,"tag":1056,"props":1645,"children":1646},{},[1647],{"type":22,"value":1648},"\"\"\")\n",{"type":16,"tag":1565,"props":1650,"children":1652},{"id":1651},"_62-extract",[1653],{"type":22,"value":1654},"6.2 Extract",{"type":16,"tag":28,"props":1656,"children":1657},{},[1658],{"type":22,"value":1659},"Extracting data might seem straightforward, but it can come with plenty of caveats. For example, to access sensitive data you might need not only credentials but also access to VPNs (virtual private networks), you might have similar data in different kinds of formats (customer tables stored in legacy databases and new ones), or you might have different data all stored in one place (images, tables, and text all in a datalake) -- if you're lucky.",{"type":16,"tag":28,"props":1661,"children":1662},{},[1663,1665,1672,1674,1681],{"type":22,"value":1664},"To tackle these challenges, (1) access and (2) distribution of data, companies such as ",{"type":16,"tag":49,"props":1666,"children":1669},{"href":1667,"rel":1668},"https://airbyte.com/",[53],[1670],{"type":22,"value":1671},"Airbyte",{"type":22,"value":1673},", ",{"type":16,"tag":49,"props":1675,"children":1678},{"href":1676,"rel":1677},"https://www.fivetran.com/",[53],[1679],{"type":22,"value":1680},"Fivetran",{"type":22,"value":1682},", and others, have come up with solutions that do all the heavy lifting for us. They have created tools that either give you connectors to common data sources (such as S3, BigQuery, and others), or give you an API so that you can develop a custom connector.",{"type":16,"tag":28,"props":1684,"children":1685},{},[1686],{"type":22,"value":1687},"That said, what we'll do in this section is to create functions that allow us to extract data in different formats or download a dataset from the web. We will create one for each of the examples that we have for the workshop today. Let's get started loading some data.",{"type":16,"tag":1045,"props":1689,"children":1691},{"code":1690,"language":1048,"meta":10,"className":1049,"style":10},"import urllib.request\n",[1692],{"type":16,"tag":1052,"props":1693,"children":1694},{"__ignoreMap":10},[1695],{"type":16,"tag":1056,"props":1696,"children":1697},{"class":1058,"line":1059},[1698],{"type":16,"tag":1056,"props":1699,"children":1700},{},[1701],{"type":22,"value":1690},{"type":16,"tag":1045,"props":1703,"children":1705},{"code":1704,"language":1048,"meta":10,"className":1049,"style":10},"def get_and_load_file(url, path_out, file_name):\n    path = Path(path_out)\n    if not path.exists(): path.mkdir(parents=True)\n    urllib.request.urlretrieve(url, path.joinpath(file_name))\n",[1706],{"type":16,"tag":1052,"props":1707,"children":1708},{"__ignoreMap":10},[1709,1717,1725,1733],{"type":16,"tag":1056,"props":1710,"children":1711},{"class":1058,"line":1059},[1712],{"type":16,"tag":1056,"props":1713,"children":1714},{},[1715],{"type":22,"value":1716},"def get_and_load_file(url, path_out, file_name):\n",{"type":16,"tag":1056,"props":1718,"children":1719},{"class":1058,"line":1068},[1720],{"type":16,"tag":1056,"props":1721,"children":1722},{},[1723],{"type":22,"value":1724},"    path = Path(path_out)\n",{"type":16,"tag":1056,"props":1726,"children":1727},{"class":1058,"line":1269},[1728],{"type":16,"tag":1056,"props":1729,"children":1730},{},[1731],{"type":22,"value":1732},"    if not path.exists(): path.mkdir(parents=True)\n",{"type":16,"tag":1056,"props":1734,"children":1735},{"class":1058,"line":1278},[1736],{"type":16,"tag":1056,"props":1737,"children":1738},{},[1739],{"type":22,"value":1740},"    urllib.request.urlretrieve(url, path.joinpath(file_name))\n",{"type":16,"tag":1045,"props":1742,"children":1744},{"code":1743,"language":1048,"meta":10,"className":1049,"style":10},"get_and_load_file(\n    url=\"https://archive.ics.uci.edu/ml/machine-learning-databases/00560/SeoulBikeData.csv\",\n    path_out=\"../data/example\",\n    file_name=\"seoul_exp.csv\"\n)\n",[1745],{"type":16,"tag":1052,"props":1746,"children":1747},{"__ignoreMap":10},[1748,1756,1764,1772,1780],{"type":16,"tag":1056,"props":1749,"children":1750},{"class":1058,"line":1059},[1751],{"type":16,"tag":1056,"props":1752,"children":1753},{},[1754],{"type":22,"value":1755},"get_and_load_file(\n",{"type":16,"tag":1056,"props":1757,"children":1758},{"class":1058,"line":1068},[1759],{"type":16,"tag":1056,"props":1760,"children":1761},{},[1762],{"type":22,"value":1763},"    url=\"https://archive.ics.uci.edu/ml/machine-learning-databases/00560/SeoulBikeData.csv\",\n",{"type":16,"tag":1056,"props":1765,"children":1766},{"class":1058,"line":1269},[1767],{"type":16,"tag":1056,"props":1768,"children":1769},{},[1770],{"type":22,"value":1771},"    path_out=\"../data/example\",\n",{"type":16,"tag":1056,"props":1773,"children":1774},{"class":1058,"line":1278},[1775],{"type":16,"tag":1056,"props":1776,"children":1777},{},[1778],{"type":22,"value":1779},"    file_name=\"seoul_exp.csv\"\n",{"type":16,"tag":1056,"props":1781,"children":1782},{"class":1058,"line":1429},[1783],{"type":16,"tag":1056,"props":1784,"children":1785},{},[1786],{"type":22,"value":1787},")\n",{"type":16,"tag":28,"props":1789,"children":1790},{},[1791,1793,1799,1801,1807],{"type":22,"value":1792},"The function above will download the file into the ",{"type":16,"tag":1052,"props":1794,"children":1796},{"className":1795},[],[1797],{"type":22,"value":1798},"\"data/example\"",{"type":22,"value":1800}," directory. If we do not specify a path for the file to ",{"type":16,"tag":1052,"props":1802,"children":1804},{"className":1803},[],[1805],{"type":22,"value":1806},"urllib.request.urlretrieve",{"type":22,"value":1808},", it would download the file into a temporary directory since it wouldn't know what to do with it or where to put it.",{"type":16,"tag":28,"props":1810,"children":1811},{},[1812,1814,1820,1822,1828,1830,1836,1838,1844],{"type":22,"value":1813},"A popular alternative to ",{"type":16,"tag":1052,"props":1815,"children":1817},{"className":1816},[],[1818],{"type":22,"value":1819},"urllib",{"type":22,"value":1821}," is ",{"type":16,"tag":1052,"props":1823,"children":1825},{"className":1824},[],[1826],{"type":22,"value":1827},"wget",{"type":22,"value":1829},", so you can switch the tools in this function easily. The former is part of the Python Standard Library (so you'll never have to install it), and the latter can be installed with ",{"type":16,"tag":1052,"props":1831,"children":1833},{"className":1832},[],[1834],{"type":22,"value":1835},"pip",{"type":22,"value":1837}," or ",{"type":16,"tag":1052,"props":1839,"children":1841},{"className":1840},[],[1842],{"type":22,"value":1843},"conda",{"type":22,"value":363},{"type":16,"tag":28,"props":1846,"children":1847},{},[1848],{"type":22,"value":1849},"Let's create two more, one for csv files and the other for parquet files.",{"type":16,"tag":1045,"props":1851,"children":1853},{"code":1852,"language":1048,"meta":10,"className":1049,"style":10},"def extract_from_csv(path_in, encoding=None):\n    return pd.read_csv(path_in, encoding=encoding)\n",[1854],{"type":16,"tag":1052,"props":1855,"children":1856},{"__ignoreMap":10},[1857,1865],{"type":16,"tag":1056,"props":1858,"children":1859},{"class":1058,"line":1059},[1860],{"type":16,"tag":1056,"props":1861,"children":1862},{},[1863],{"type":22,"value":1864},"def extract_from_csv(path_in, encoding=None):\n",{"type":16,"tag":1056,"props":1866,"children":1867},{"class":1058,"line":1068},[1868],{"type":16,"tag":1056,"props":1869,"children":1870},{},[1871],{"type":22,"value":1872},"    return pd.read_csv(path_in, encoding=encoding)\n",{"type":16,"tag":1045,"props":1874,"children":1876},{"code":1875,"language":1048,"meta":10,"className":1049,"style":10},"seoul_df = extract_from_csv(\n    path_in=data_path.joinpath(\"seoul\", \"raw\", \"SeoulBikeData.csv\")\n)\nseoul_df.head()\n",[1877],{"type":16,"tag":1052,"props":1878,"children":1879},{"__ignoreMap":10},[1880,1888,1896,1903],{"type":16,"tag":1056,"props":1881,"children":1882},{"class":1058,"line":1059},[1883],{"type":16,"tag":1056,"props":1884,"children":1885},{},[1886],{"type":22,"value":1887},"seoul_df = extract_from_csv(\n",{"type":16,"tag":1056,"props":1889,"children":1890},{"class":1058,"line":1068},[1891],{"type":16,"tag":1056,"props":1892,"children":1893},{},[1894],{"type":22,"value":1895},"    path_in=data_path.joinpath(\"seoul\", \"raw\", \"SeoulBikeData.csv\")\n",{"type":16,"tag":1056,"props":1897,"children":1898},{"class":1058,"line":1269},[1899],{"type":16,"tag":1056,"props":1900,"children":1901},{},[1902],{"type":22,"value":1787},{"type":16,"tag":1056,"props":1904,"children":1905},{"class":1058,"line":1278},[1906],{"type":16,"tag":1056,"props":1907,"children":1908},{},[1909],{"type":22,"value":1910},"seoul_df.head()\n",{"type":16,"tag":28,"props":1912,"children":1913},{},[1914,1916,1922,1924,1930],{"type":22,"value":1915},"The reason, we've added ",{"type":16,"tag":1052,"props":1917,"children":1919},{"className":1918},[],[1920],{"type":22,"value":1921},"enconing",{"type":22,"value":1923}," to our function is that files are not always shared in ",{"type":16,"tag":1052,"props":1925,"children":1927},{"className":1926},[],[1928],{"type":22,"value":1929},"utf-8",{"type":22,"value":1931}," abd it is important to account for this discrepancy when creating an ETL framework. In fact, one of our datasets has a tricky format itself.",{"type":16,"tag":1045,"props":1933,"children":1935},{"code":1934,"language":1048,"meta":10,"className":1049,"style":10},"{1: \"value\", 1: \"value\", 1: \"value\", 1: \"value\", }\n",[1936],{"type":16,"tag":1052,"props":1937,"children":1938},{"__ignoreMap":10},[1939],{"type":16,"tag":1056,"props":1940,"children":1941},{"class":1058,"line":1059},[1942],{"type":16,"tag":1056,"props":1943,"children":1944},{},[1945],{"type":22,"value":1934},{"type":16,"tag":1045,"props":1947,"children":1949},{"code":1948,"language":1048,"meta":10,"className":1049,"style":10},"def extract_from_parquet(path_in, **kwargs):\n    return pd.read_parquet(path_in, **kwargs)\n",[1950],{"type":16,"tag":1052,"props":1951,"children":1952},{"__ignoreMap":10},[1953,1961],{"type":16,"tag":1056,"props":1954,"children":1955},{"class":1058,"line":1059},[1956],{"type":16,"tag":1056,"props":1957,"children":1958},{},[1959],{"type":22,"value":1960},"def extract_from_parquet(path_in, **kwargs):\n",{"type":16,"tag":1056,"props":1962,"children":1963},{"class":1058,"line":1068},[1964],{"type":16,"tag":1056,"props":1965,"children":1966},{},[1967],{"type":22,"value":1968},"    return pd.read_parquet(path_in, **kwargs)\n",{"type":16,"tag":1045,"props":1970,"children":1972},{"code":1971,"language":1048,"meta":10,"className":1049,"style":10},"porto_df = extract_from_parquet(\n    path_in=data_path.joinpath(\"porto\", \"bike_sharing_hourly.parquet\")\n)\nporto_df.head()\n",[1973],{"type":16,"tag":1052,"props":1974,"children":1975},{"__ignoreMap":10},[1976,1984,1992,1999],{"type":16,"tag":1056,"props":1977,"children":1978},{"class":1058,"line":1059},[1979],{"type":16,"tag":1056,"props":1980,"children":1981},{},[1982],{"type":22,"value":1983},"porto_df = extract_from_parquet(\n",{"type":16,"tag":1056,"props":1985,"children":1986},{"class":1058,"line":1068},[1987],{"type":16,"tag":1056,"props":1988,"children":1989},{},[1990],{"type":22,"value":1991},"    path_in=data_path.joinpath(\"porto\", \"bike_sharing_hourly.parquet\")\n",{"type":16,"tag":1056,"props":1993,"children":1994},{"class":1058,"line":1269},[1995],{"type":16,"tag":1056,"props":1996,"children":1997},{},[1998],{"type":22,"value":1787},{"type":16,"tag":1056,"props":2000,"children":2001},{"class":1058,"line":1278},[2002],{"type":16,"tag":1056,"props":2003,"children":2004},{},[2005],{"type":22,"value":2006},"porto_df.head()\n",{"type":16,"tag":28,"props":2008,"children":2009},{},[2010,2012,2018,2020,2027],{"type":22,"value":2011},"One of our files is stored in a SQLite database so we'll use the ",{"type":16,"tag":1052,"props":2013,"children":2015},{"className":2014},[],[2016],{"type":22,"value":2017},"sqlite3",{"type":22,"value":2019}," module, which is part of of the ",{"type":16,"tag":49,"props":2021,"children":2024},{"href":2022,"rel":2023},"https://docs.python.org/3/library/index.html",[53],[2025],{"type":22,"value":2026},"Python Standard Library",{"type":22,"value":2028},", to read it.",{"type":16,"tag":1045,"props":2030,"children":2032},{"code":2031,"language":1048,"meta":10,"className":1049,"style":10},"import sqlite3\n",[2033],{"type":16,"tag":1052,"props":2034,"children":2035},{"__ignoreMap":10},[2036],{"type":16,"tag":1056,"props":2037,"children":2038},{"class":1058,"line":1059},[2039],{"type":16,"tag":1056,"props":2040,"children":2041},{},[2042],{"type":22,"value":2031},{"type":16,"tag":1045,"props":2044,"children":2046},{"code":2045,"language":1048,"meta":10,"className":1049,"style":10},"def extract_from_db(path_in, query):\n    conn = sqlite3.connect(path_in)\n    return pd.read_sql_query(query, conn)\n",[2047],{"type":16,"tag":1052,"props":2048,"children":2049},{"__ignoreMap":10},[2050,2058,2066],{"type":16,"tag":1056,"props":2051,"children":2052},{"class":1058,"line":1059},[2053],{"type":16,"tag":1056,"props":2054,"children":2055},{},[2056],{"type":22,"value":2057},"def extract_from_db(path_in, query):\n",{"type":16,"tag":1056,"props":2059,"children":2060},{"class":1058,"line":1068},[2061],{"type":16,"tag":1056,"props":2062,"children":2063},{},[2064],{"type":22,"value":2065},"    conn = sqlite3.connect(path_in)\n",{"type":16,"tag":1056,"props":2067,"children":2068},{"class":1058,"line":1269},[2069],{"type":16,"tag":1056,"props":2070,"children":2071},{},[2072],{"type":22,"value":2073},"    return pd.read_sql_query(query, conn)\n",{"type":16,"tag":1045,"props":2075,"children":2077},{"code":2076,"language":1048,"meta":10,"className":1049,"style":10},"london_df = extract_from_db(\n    path_in=data_path.joinpath(\"london\", \"london_bikes.db\"),\n    query=\"SELECT * FROM uk_bikes\"\n)\nlondon_df.head()\n",[2078],{"type":16,"tag":1052,"props":2079,"children":2080},{"__ignoreMap":10},[2081,2089,2097,2105,2112],{"type":16,"tag":1056,"props":2082,"children":2083},{"class":1058,"line":1059},[2084],{"type":16,"tag":1056,"props":2085,"children":2086},{},[2087],{"type":22,"value":2088},"london_df = extract_from_db(\n",{"type":16,"tag":1056,"props":2090,"children":2091},{"class":1058,"line":1068},[2092],{"type":16,"tag":1056,"props":2093,"children":2094},{},[2095],{"type":22,"value":2096},"    path_in=data_path.joinpath(\"london\", \"london_bikes.db\"),\n",{"type":16,"tag":1056,"props":2098,"children":2099},{"class":1058,"line":1269},[2100],{"type":16,"tag":1056,"props":2101,"children":2102},{},[2103],{"type":22,"value":2104},"    query=\"SELECT * FROM uk_bikes\"\n",{"type":16,"tag":1056,"props":2106,"children":2107},{"class":1058,"line":1278},[2108],{"type":16,"tag":1056,"props":2109,"children":2110},{},[2111],{"type":22,"value":1787},{"type":16,"tag":1056,"props":2113,"children":2114},{"class":1058,"line":1429},[2115],{"type":16,"tag":1056,"props":2116,"children":2117},{},[2118],{"type":22,"value":2119},"london_df.head()\n",{"type":16,"tag":28,"props":2121,"children":2122},{},[2123,2125,2132],{"type":22,"value":2124},"Lastly, JSON files can be tricky to handle so we'll try two quick cases here using a try-except approach, but take note that as your projects evolve, it is highly likely that this function might change. A very good tool to handle large amounts of unstructured JSON that can later be formatted as a dataframe (or many), is ",{"type":16,"tag":49,"props":2126,"children":2129},{"href":2127,"rel":2128},"https://examples.dask.org/bag.html",[53],[2130],{"type":22,"value":2131},"Dask Bags",{"type":22,"value":363},{"type":16,"tag":1045,"props":2134,"children":2136},{"code":2135,"language":1048,"meta":10,"className":1049,"style":10},"def extract_from_json(path_in, **kwargs):\n    try:\n        data =  pd.read_json(path_in, kwargs)\n    except:\n        with open(path_in, 'r') as f:\n            data = json.loads(f.read())\n            data = pd.json_normalize(data, kwargs)\n    return data\n",[2137],{"type":16,"tag":1052,"props":2138,"children":2139},{"__ignoreMap":10},[2140,2148,2156,2164,2172,2180,2188,2196],{"type":16,"tag":1056,"props":2141,"children":2142},{"class":1058,"line":1059},[2143],{"type":16,"tag":1056,"props":2144,"children":2145},{},[2146],{"type":22,"value":2147},"def extract_from_json(path_in, **kwargs):\n",{"type":16,"tag":1056,"props":2149,"children":2150},{"class":1058,"line":1068},[2151],{"type":16,"tag":1056,"props":2152,"children":2153},{},[2154],{"type":22,"value":2155},"    try:\n",{"type":16,"tag":1056,"props":2157,"children":2158},{"class":1058,"line":1269},[2159],{"type":16,"tag":1056,"props":2160,"children":2161},{},[2162],{"type":22,"value":2163},"        data =  pd.read_json(path_in, kwargs)\n",{"type":16,"tag":1056,"props":2165,"children":2166},{"class":1058,"line":1278},[2167],{"type":16,"tag":1056,"props":2168,"children":2169},{},[2170],{"type":22,"value":2171},"    except:\n",{"type":16,"tag":1056,"props":2173,"children":2174},{"class":1058,"line":1429},[2175],{"type":16,"tag":1056,"props":2176,"children":2177},{},[2178],{"type":22,"value":2179},"        with open(path_in, 'r') as f:\n",{"type":16,"tag":1056,"props":2181,"children":2182},{"class":1058,"line":1509},[2183],{"type":16,"tag":1056,"props":2184,"children":2185},{},[2186],{"type":22,"value":2187},"            data = json.loads(f.read())\n",{"type":16,"tag":1056,"props":2189,"children":2190},{"class":1058,"line":1633},[2191],{"type":16,"tag":1056,"props":2192,"children":2193},{},[2194],{"type":22,"value":2195},"            data = pd.json_normalize(data, kwargs)\n",{"type":16,"tag":1056,"props":2197,"children":2198},{"class":1058,"line":1642},[2199],{"type":16,"tag":1056,"props":2200,"children":2201},{},[2202],{"type":22,"value":1284},{"type":16,"tag":1045,"props":2204,"children":2206},{"code":2205,"language":1048,"meta":10,"className":1049,"style":10},"dc_df = extract_from_json(\n    path_in=data_path.joinpath(\"wash_dc\", \"washington.json\")\n)\ndc_df.head()\n",[2207],{"type":16,"tag":1052,"props":2208,"children":2209},{"__ignoreMap":10},[2210,2218,2226,2233],{"type":16,"tag":1056,"props":2211,"children":2212},{"class":1058,"line":1059},[2213],{"type":16,"tag":1056,"props":2214,"children":2215},{},[2216],{"type":22,"value":2217},"dc_df = extract_from_json(\n",{"type":16,"tag":1056,"props":2219,"children":2220},{"class":1058,"line":1068},[2221],{"type":16,"tag":1056,"props":2222,"children":2223},{},[2224],{"type":22,"value":2225},"    path_in=data_path.joinpath(\"wash_dc\", \"washington.json\")\n",{"type":16,"tag":1056,"props":2227,"children":2228},{"class":1058,"line":1269},[2229],{"type":16,"tag":1056,"props":2230,"children":2231},{},[2232],{"type":22,"value":1787},{"type":16,"tag":1056,"props":2234,"children":2235},{"class":1058,"line":1278},[2236],{"type":16,"tag":1056,"props":2237,"children":2238},{},[2239],{"type":22,"value":2240},"dc_df.head()\n",{"type":16,"tag":28,"props":2242,"children":2243},{},[2244,2246,2251,2253,2260],{"type":22,"value":2245},"Now that we have our functions, we want to create a file and attach to it the minimum functionality possible to use it as a command line tool. We will do this with the popular package called ",{"type":16,"tag":1052,"props":2247,"children":2249},{"className":2248},[],[2250],{"type":22,"value":840},{"type":22,"value":2252},". It offers a delightful user experience, it respects (and annoys you at times) by type-checking your code, and it provides you with beautifully-formatted output based on the ",{"type":16,"tag":49,"props":2254,"children":2257},{"href":2255,"rel":2256},"https://rich.readthedocs.io/en/latest/",[53],[2258],{"type":22,"value":2259},"rich",{"type":22,"value":2261}," python library.",{"type":16,"tag":28,"props":2263,"children":2264},{},[2265,2267,2272,2274,2280],{"type":22,"value":2266},"With ",{"type":16,"tag":1052,"props":2268,"children":2270},{"className":2269},[],[2271],{"type":22,"value":840},{"type":22,"value":2273}," we can create CLIs in several ways, and, for our purposes, we will pick the most straightforward one which works by adding ",{"type":16,"tag":1052,"props":2275,"children":2277},{"className":2276},[],[2278],{"type":22,"value":2279},"typer.run()",{"type":22,"value":2281}," around a main function that encapsulates your application logic, in our case, our extract function and the upcoming ones.",{"type":16,"tag":1045,"props":2283,"children":2285},{"code":2284,"language":1048,"meta":10,"className":1049,"style":10},"%%writefile ../src/data_eng/extract.py\n\nimport urllib.request\nfrom pathlib import Path\nimport pandas as pd\nimport json\nimport typer\nfrom typing import Optional\nfrom load import save_data\n\n\ndef get_and_load_file(url, path_out, file_name):\n    path = Path(path_out)\n    if not path.exists():\n        path.mkdir(parents=True)\n    urllib.request.urlretrieve(url, path.joinpath(file_name))\n\ndef extract_from_csv(path_in, encoding=None):\n    return pd.read_csv(path_in, encoding=encoding)\n\ndef extract_from_db(path_in, query):\n    conn = sqlite3.connect(path_in)\n    return pd.read_sql_query(query, conn)\n\ndef extract_from_parquet(path_in, **kwargs):\n    return pd.read_parquet(path_in, **kwargs)\n\ndef extract_from_json(path_in, **kwargs):\n    try:\n        data =  pd.read_json(path_in, **kwargs)\n    except:\n        with open(path_in, 'r') as f:\n            data = json.loads(f.read())\n            data = pd.json_normalize(data, kwargs)\n    return data\n\ndef main(\n    arg: str = typer.Option(...),\n    url: Optional[str] = typer.Option(None),\n    path_in: Optional[str] = typer.Option(None),\n    path_out: Optional[str] = typer.Option(None),\n    encoding: Optional[str] = typer.Option(None),\n    file_name: Optional[str] = typer.Option(None),\n    query: Optional[str] = typer.Option(None),\n):\n    if arg == \"get\":\n        get_and_load_file(url, path_out, file_name)\n    elif arg == \"csv\":\n        data = extract_from_csv(path_in, encoding=encoding)\n        save_data(data, path_out, file_name)\n    elif arg == \"pq\":\n        data = extract_from_parquet(path_in)\n        save_data(data, path_out, file_name)\n    elif arg == \"json\":\n        data = extract_from_json(path_in)\n        save_data(data, path_out, file_name)\n    elif arg == \"db\":\n        data = extract_from_db(path_in, query)\n        save_data(data, path_out, file_name)\n    else:\n        print(f\"Could not understand argument {arg}. Please use 'pq' for parquet files, 'db' for database, json, or csv in lowercase.\")\n\n    print(\"Data Extracted Successfully!\")\n\n\nif __name__ == \"__main__\":\n    typer.run(main)\n",[2286],{"type":16,"tag":1052,"props":2287,"children":2288},{"__ignoreMap":10},[2289,2297,2306,2313,2320,2327,2335,2343,2351,2360,2368,2376,2384,2392,2401,2410,2418,2426,2434,2442,2450,2458,2466,2474,2482,2490,2498,2506,2514,2522,2531,2539,2547,2555,2563,2571,2579,2588,2597,2606,2615,2624,2633,2642,2651,2660,2669,2678,2687,2696,2705,2714,2723,2731,2740,2749,2757,2766,2775,2783,2792,2801,2809,2818,2826,2834,2843],{"type":16,"tag":1056,"props":2290,"children":2291},{"class":1058,"line":1059},[2292],{"type":16,"tag":1056,"props":2293,"children":2294},{},[2295],{"type":22,"value":2296},"%%writefile ../src/data_eng/extract.py\n",{"type":16,"tag":1056,"props":2298,"children":2299},{"class":1058,"line":1068},[2300],{"type":16,"tag":1056,"props":2301,"children":2303},{"emptyLinePlaceholder":2302},true,[2304],{"type":22,"value":2305},"\n",{"type":16,"tag":1056,"props":2307,"children":2308},{"class":1058,"line":1269},[2309],{"type":16,"tag":1056,"props":2310,"children":2311},{},[2312],{"type":22,"value":1690},{"type":16,"tag":1056,"props":2314,"children":2315},{"class":1058,"line":1278},[2316],{"type":16,"tag":1056,"props":2317,"children":2318},{},[2319],{"type":22,"value":1074},{"type":16,"tag":1056,"props":2321,"children":2322},{"class":1058,"line":1429},[2323],{"type":16,"tag":1056,"props":2324,"children":2325},{},[2326],{"type":22,"value":1065},{"type":16,"tag":1056,"props":2328,"children":2329},{"class":1058,"line":1509},[2330],{"type":16,"tag":1056,"props":2331,"children":2332},{},[2333],{"type":22,"value":2334},"import json\n",{"type":16,"tag":1056,"props":2336,"children":2337},{"class":1058,"line":1633},[2338],{"type":16,"tag":1056,"props":2339,"children":2340},{},[2341],{"type":22,"value":2342},"import typer\n",{"type":16,"tag":1056,"props":2344,"children":2345},{"class":1058,"line":1642},[2346],{"type":16,"tag":1056,"props":2347,"children":2348},{},[2349],{"type":22,"value":2350},"from typing import Optional\n",{"type":16,"tag":1056,"props":2352,"children":2354},{"class":1058,"line":2353},9,[2355],{"type":16,"tag":1056,"props":2356,"children":2357},{},[2358],{"type":22,"value":2359},"from load import save_data\n",{"type":16,"tag":1056,"props":2361,"children":2363},{"class":1058,"line":2362},10,[2364],{"type":16,"tag":1056,"props":2365,"children":2366},{"emptyLinePlaceholder":2302},[2367],{"type":22,"value":2305},{"type":16,"tag":1056,"props":2369,"children":2371},{"class":1058,"line":2370},11,[2372],{"type":16,"tag":1056,"props":2373,"children":2374},{"emptyLinePlaceholder":2302},[2375],{"type":22,"value":2305},{"type":16,"tag":1056,"props":2377,"children":2379},{"class":1058,"line":2378},12,[2380],{"type":16,"tag":1056,"props":2381,"children":2382},{},[2383],{"type":22,"value":1716},{"type":16,"tag":1056,"props":2385,"children":2387},{"class":1058,"line":2386},13,[2388],{"type":16,"tag":1056,"props":2389,"children":2390},{},[2391],{"type":22,"value":1724},{"type":16,"tag":1056,"props":2393,"children":2395},{"class":1058,"line":2394},14,[2396],{"type":16,"tag":1056,"props":2397,"children":2398},{},[2399],{"type":22,"value":2400},"    if not path.exists():\n",{"type":16,"tag":1056,"props":2402,"children":2404},{"class":1058,"line":2403},15,[2405],{"type":16,"tag":1056,"props":2406,"children":2407},{},[2408],{"type":22,"value":2409},"        path.mkdir(parents=True)\n",{"type":16,"tag":1056,"props":2411,"children":2413},{"class":1058,"line":2412},16,[2414],{"type":16,"tag":1056,"props":2415,"children":2416},{},[2417],{"type":22,"value":1740},{"type":16,"tag":1056,"props":2419,"children":2421},{"class":1058,"line":2420},17,[2422],{"type":16,"tag":1056,"props":2423,"children":2424},{"emptyLinePlaceholder":2302},[2425],{"type":22,"value":2305},{"type":16,"tag":1056,"props":2427,"children":2429},{"class":1058,"line":2428},18,[2430],{"type":16,"tag":1056,"props":2431,"children":2432},{},[2433],{"type":22,"value":1864},{"type":16,"tag":1056,"props":2435,"children":2437},{"class":1058,"line":2436},19,[2438],{"type":16,"tag":1056,"props":2439,"children":2440},{},[2441],{"type":22,"value":1872},{"type":16,"tag":1056,"props":2443,"children":2445},{"class":1058,"line":2444},20,[2446],{"type":16,"tag":1056,"props":2447,"children":2448},{"emptyLinePlaceholder":2302},[2449],{"type":22,"value":2305},{"type":16,"tag":1056,"props":2451,"children":2453},{"class":1058,"line":2452},21,[2454],{"type":16,"tag":1056,"props":2455,"children":2456},{},[2457],{"type":22,"value":2057},{"type":16,"tag":1056,"props":2459,"children":2461},{"class":1058,"line":2460},22,[2462],{"type":16,"tag":1056,"props":2463,"children":2464},{},[2465],{"type":22,"value":2065},{"type":16,"tag":1056,"props":2467,"children":2469},{"class":1058,"line":2468},23,[2470],{"type":16,"tag":1056,"props":2471,"children":2472},{},[2473],{"type":22,"value":2073},{"type":16,"tag":1056,"props":2475,"children":2477},{"class":1058,"line":2476},24,[2478],{"type":16,"tag":1056,"props":2479,"children":2480},{"emptyLinePlaceholder":2302},[2481],{"type":22,"value":2305},{"type":16,"tag":1056,"props":2483,"children":2485},{"class":1058,"line":2484},25,[2486],{"type":16,"tag":1056,"props":2487,"children":2488},{},[2489],{"type":22,"value":1960},{"type":16,"tag":1056,"props":2491,"children":2493},{"class":1058,"line":2492},26,[2494],{"type":16,"tag":1056,"props":2495,"children":2496},{},[2497],{"type":22,"value":1968},{"type":16,"tag":1056,"props":2499,"children":2501},{"class":1058,"line":2500},27,[2502],{"type":16,"tag":1056,"props":2503,"children":2504},{"emptyLinePlaceholder":2302},[2505],{"type":22,"value":2305},{"type":16,"tag":1056,"props":2507,"children":2509},{"class":1058,"line":2508},28,[2510],{"type":16,"tag":1056,"props":2511,"children":2512},{},[2513],{"type":22,"value":2147},{"type":16,"tag":1056,"props":2515,"children":2517},{"class":1058,"line":2516},29,[2518],{"type":16,"tag":1056,"props":2519,"children":2520},{},[2521],{"type":22,"value":2155},{"type":16,"tag":1056,"props":2523,"children":2525},{"class":1058,"line":2524},30,[2526],{"type":16,"tag":1056,"props":2527,"children":2528},{},[2529],{"type":22,"value":2530},"        data =  pd.read_json(path_in, **kwargs)\n",{"type":16,"tag":1056,"props":2532,"children":2534},{"class":1058,"line":2533},31,[2535],{"type":16,"tag":1056,"props":2536,"children":2537},{},[2538],{"type":22,"value":2171},{"type":16,"tag":1056,"props":2540,"children":2542},{"class":1058,"line":2541},32,[2543],{"type":16,"tag":1056,"props":2544,"children":2545},{},[2546],{"type":22,"value":2179},{"type":16,"tag":1056,"props":2548,"children":2550},{"class":1058,"line":2549},33,[2551],{"type":16,"tag":1056,"props":2552,"children":2553},{},[2554],{"type":22,"value":2187},{"type":16,"tag":1056,"props":2556,"children":2558},{"class":1058,"line":2557},34,[2559],{"type":16,"tag":1056,"props":2560,"children":2561},{},[2562],{"type":22,"value":2195},{"type":16,"tag":1056,"props":2564,"children":2566},{"class":1058,"line":2565},35,[2567],{"type":16,"tag":1056,"props":2568,"children":2569},{},[2570],{"type":22,"value":1284},{"type":16,"tag":1056,"props":2572,"children":2574},{"class":1058,"line":2573},36,[2575],{"type":16,"tag":1056,"props":2576,"children":2577},{"emptyLinePlaceholder":2302},[2578],{"type":22,"value":2305},{"type":16,"tag":1056,"props":2580,"children":2582},{"class":1058,"line":2581},37,[2583],{"type":16,"tag":1056,"props":2584,"children":2585},{},[2586],{"type":22,"value":2587},"def main(\n",{"type":16,"tag":1056,"props":2589,"children":2591},{"class":1058,"line":2590},38,[2592],{"type":16,"tag":1056,"props":2593,"children":2594},{},[2595],{"type":22,"value":2596},"    arg: str = typer.Option(...),\n",{"type":16,"tag":1056,"props":2598,"children":2600},{"class":1058,"line":2599},39,[2601],{"type":16,"tag":1056,"props":2602,"children":2603},{},[2604],{"type":22,"value":2605},"    url: Optional[str] = typer.Option(None),\n",{"type":16,"tag":1056,"props":2607,"children":2609},{"class":1058,"line":2608},40,[2610],{"type":16,"tag":1056,"props":2611,"children":2612},{},[2613],{"type":22,"value":2614},"    path_in: Optional[str] = typer.Option(None),\n",{"type":16,"tag":1056,"props":2616,"children":2618},{"class":1058,"line":2617},41,[2619],{"type":16,"tag":1056,"props":2620,"children":2621},{},[2622],{"type":22,"value":2623},"    path_out: Optional[str] = typer.Option(None),\n",{"type":16,"tag":1056,"props":2625,"children":2627},{"class":1058,"line":2626},42,[2628],{"type":16,"tag":1056,"props":2629,"children":2630},{},[2631],{"type":22,"value":2632},"    encoding: Optional[str] = typer.Option(None),\n",{"type":16,"tag":1056,"props":2634,"children":2636},{"class":1058,"line":2635},43,[2637],{"type":16,"tag":1056,"props":2638,"children":2639},{},[2640],{"type":22,"value":2641},"    file_name: Optional[str] = typer.Option(None),\n",{"type":16,"tag":1056,"props":2643,"children":2645},{"class":1058,"line":2644},44,[2646],{"type":16,"tag":1056,"props":2647,"children":2648},{},[2649],{"type":22,"value":2650},"    query: Optional[str] = typer.Option(None),\n",{"type":16,"tag":1056,"props":2652,"children":2654},{"class":1058,"line":2653},45,[2655],{"type":16,"tag":1056,"props":2656,"children":2657},{},[2658],{"type":22,"value":2659},"):\n",{"type":16,"tag":1056,"props":2661,"children":2663},{"class":1058,"line":2662},46,[2664],{"type":16,"tag":1056,"props":2665,"children":2666},{},[2667],{"type":22,"value":2668},"    if arg == \"get\":\n",{"type":16,"tag":1056,"props":2670,"children":2672},{"class":1058,"line":2671},47,[2673],{"type":16,"tag":1056,"props":2674,"children":2675},{},[2676],{"type":22,"value":2677},"        get_and_load_file(url, path_out, file_name)\n",{"type":16,"tag":1056,"props":2679,"children":2681},{"class":1058,"line":2680},48,[2682],{"type":16,"tag":1056,"props":2683,"children":2684},{},[2685],{"type":22,"value":2686},"    elif arg == \"csv\":\n",{"type":16,"tag":1056,"props":2688,"children":2690},{"class":1058,"line":2689},49,[2691],{"type":16,"tag":1056,"props":2692,"children":2693},{},[2694],{"type":22,"value":2695},"        data = extract_from_csv(path_in, encoding=encoding)\n",{"type":16,"tag":1056,"props":2697,"children":2699},{"class":1058,"line":2698},50,[2700],{"type":16,"tag":1056,"props":2701,"children":2702},{},[2703],{"type":22,"value":2704},"        save_data(data, path_out, file_name)\n",{"type":16,"tag":1056,"props":2706,"children":2708},{"class":1058,"line":2707},51,[2709],{"type":16,"tag":1056,"props":2710,"children":2711},{},[2712],{"type":22,"value":2713},"    elif arg == \"pq\":\n",{"type":16,"tag":1056,"props":2715,"children":2717},{"class":1058,"line":2716},52,[2718],{"type":16,"tag":1056,"props":2719,"children":2720},{},[2721],{"type":22,"value":2722},"        data = extract_from_parquet(path_in)\n",{"type":16,"tag":1056,"props":2724,"children":2726},{"class":1058,"line":2725},53,[2727],{"type":16,"tag":1056,"props":2728,"children":2729},{},[2730],{"type":22,"value":2704},{"type":16,"tag":1056,"props":2732,"children":2734},{"class":1058,"line":2733},54,[2735],{"type":16,"tag":1056,"props":2736,"children":2737},{},[2738],{"type":22,"value":2739},"    elif arg == \"json\":\n",{"type":16,"tag":1056,"props":2741,"children":2743},{"class":1058,"line":2742},55,[2744],{"type":16,"tag":1056,"props":2745,"children":2746},{},[2747],{"type":22,"value":2748},"        data = extract_from_json(path_in)\n",{"type":16,"tag":1056,"props":2750,"children":2752},{"class":1058,"line":2751},56,[2753],{"type":16,"tag":1056,"props":2754,"children":2755},{},[2756],{"type":22,"value":2704},{"type":16,"tag":1056,"props":2758,"children":2760},{"class":1058,"line":2759},57,[2761],{"type":16,"tag":1056,"props":2762,"children":2763},{},[2764],{"type":22,"value":2765},"    elif arg == \"db\":\n",{"type":16,"tag":1056,"props":2767,"children":2769},{"class":1058,"line":2768},58,[2770],{"type":16,"tag":1056,"props":2771,"children":2772},{},[2773],{"type":22,"value":2774},"        data = extract_from_db(path_in, query)\n",{"type":16,"tag":1056,"props":2776,"children":2778},{"class":1058,"line":2777},59,[2779],{"type":16,"tag":1056,"props":2780,"children":2781},{},[2782],{"type":22,"value":2704},{"type":16,"tag":1056,"props":2784,"children":2786},{"class":1058,"line":2785},60,[2787],{"type":16,"tag":1056,"props":2788,"children":2789},{},[2790],{"type":22,"value":2791},"    else:\n",{"type":16,"tag":1056,"props":2793,"children":2795},{"class":1058,"line":2794},61,[2796],{"type":16,"tag":1056,"props":2797,"children":2798},{},[2799],{"type":22,"value":2800},"        print(f\"Could not understand argument {arg}. Please use 'pq' for parquet files, 'db' for database, json, or csv in lowercase.\")\n",{"type":16,"tag":1056,"props":2802,"children":2804},{"class":1058,"line":2803},62,[2805],{"type":16,"tag":1056,"props":2806,"children":2807},{"emptyLinePlaceholder":2302},[2808],{"type":22,"value":2305},{"type":16,"tag":1056,"props":2810,"children":2812},{"class":1058,"line":2811},63,[2813],{"type":16,"tag":1056,"props":2814,"children":2815},{},[2816],{"type":22,"value":2817},"    print(\"Data Extracted Successfully!\")\n",{"type":16,"tag":1056,"props":2819,"children":2821},{"class":1058,"line":2820},64,[2822],{"type":16,"tag":1056,"props":2823,"children":2824},{"emptyLinePlaceholder":2302},[2825],{"type":22,"value":2305},{"type":16,"tag":1056,"props":2827,"children":2829},{"class":1058,"line":2828},65,[2830],{"type":16,"tag":1056,"props":2831,"children":2832},{"emptyLinePlaceholder":2302},[2833],{"type":22,"value":2305},{"type":16,"tag":1056,"props":2835,"children":2837},{"class":1058,"line":2836},66,[2838],{"type":16,"tag":1056,"props":2839,"children":2840},{},[2841],{"type":22,"value":2842},"if __name__ == \"__main__\":\n",{"type":16,"tag":1056,"props":2844,"children":2846},{"class":1058,"line":2845},67,[2847],{"type":16,"tag":1056,"props":2848,"children":2849},{},[2850],{"type":22,"value":2851},"    typer.run(main)\n",{"type":16,"tag":28,"props":2853,"children":2854},{},[2855,2857,2863],{"type":22,"value":2856},"Note that we added different parameters to our ",{"type":16,"tag":1052,"props":2858,"children":2860},{"className":2859},[],[2861],{"type":22,"value":2862},"main",{"type":22,"value":2864}," function to control the behavior of our CLI app.",{"type":16,"tag":124,"props":2866,"children":2867},{},[2868,2879,2890,2901,2912,2923,2934],{"type":16,"tag":69,"props":2869,"children":2870},{},[2871,2877],{"type":16,"tag":1052,"props":2872,"children":2874},{"className":2873},[],[2875],{"type":22,"value":2876},"arg",{"type":22,"value":2878}," - the kind of data we're extracting.",{"type":16,"tag":69,"props":2880,"children":2881},{},[2882,2888],{"type":16,"tag":1052,"props":2883,"children":2885},{"className":2884},[],[2886],{"type":22,"value":2887},"url",{"type":22,"value":2889}," - the url for when we need to download files from somewhere",{"type":16,"tag":69,"props":2891,"children":2892},{},[2893,2899],{"type":16,"tag":1052,"props":2894,"children":2896},{"className":2895},[],[2897],{"type":22,"value":2898},"path_in",{"type":22,"value":2900}," - where is the data at",{"type":16,"tag":69,"props":2902,"children":2903},{},[2904,2910],{"type":16,"tag":1052,"props":2905,"children":2907},{"className":2906},[],[2908],{"type":22,"value":2909},"path_out",{"type":22,"value":2911}," - where is that data going to",{"type":16,"tag":69,"props":2913,"children":2914},{},[2915,2921],{"type":16,"tag":1052,"props":2916,"children":2918},{"className":2917},[],[2919],{"type":22,"value":2920},"encoding",{"type":22,"value":2922}," - what kind of enconding are we reading the file with",{"type":16,"tag":69,"props":2924,"children":2925},{},[2926,2932],{"type":16,"tag":1052,"props":2927,"children":2929},{"className":2928},[],[2930],{"type":22,"value":2931},"file_name",{"type":22,"value":2933}," - what is going to be the new name of the output file",{"type":16,"tag":69,"props":2935,"children":2936},{},[2937,2943],{"type":16,"tag":1052,"props":2938,"children":2940},{"className":2939},[],[2941],{"type":22,"value":2942},"query",{"type":22,"value":2944}," - query for the data we want from the SQL database",{"type":16,"tag":28,"props":2946,"children":2947},{},[2948],{"type":22,"value":2949},"A few important things to note:",{"type":16,"tag":124,"props":2951,"children":2952},{},[2953,2994,3005,3023,3043],{"type":16,"tag":69,"props":2954,"children":2955},{},[2956,2958,2964,2966,2972,2974,2979,2981,2986,2988],{"type":22,"value":2957},"parameters containing underscores ",{"type":16,"tag":1052,"props":2959,"children":2961},{"className":2960},[],[2962],{"type":22,"value":2963},"_",{"type":22,"value":2965}," will be switched into a dash ",{"type":16,"tag":1052,"props":2967,"children":2969},{"className":2968},[],[2970],{"type":22,"value":2971},"-",{"type":22,"value":2973}," by ",{"type":16,"tag":1052,"props":2975,"children":2977},{"className":2976},[],[2978],{"type":22,"value":840},{"type":22,"value":2980},", so ",{"type":16,"tag":1052,"props":2982,"children":2984},{"className":2983},[],[2985],{"type":22,"value":2931},{"type":22,"value":2987}," will be ",{"type":16,"tag":1052,"props":2989,"children":2991},{"className":2990},[],[2992],{"type":22,"value":2993},"file-name",{"type":16,"tag":69,"props":2995,"children":2996},{},[2997,2999],{"type":22,"value":2998},"commands are run with two dashes and with a space in between it and the argument being passes, e.g. ",{"type":16,"tag":1052,"props":3000,"children":3002},{"className":3001},[],[3003],{"type":22,"value":3004},"--name PyCon",{"type":16,"tag":69,"props":3006,"children":3007},{},[3008,3014,3016,3021],{"type":16,"tag":1052,"props":3009,"children":3011},{"className":3010},[],[3012],{"type":22,"value":3013},"typer.Option(None)",{"type":22,"value":3015}," indicates to ",{"type":16,"tag":1052,"props":3017,"children":3019},{"className":3018},[],[3020],{"type":22,"value":840},{"type":22,"value":3022}," that this command can be optional, hence, when we change the kind of file we're extracting we can by pass having to put an option on others.",{"type":16,"tag":69,"props":3024,"children":3025},{},[3026,3028,3034,3036,3042],{"type":22,"value":3027},"by adding ",{"type":16,"tag":1052,"props":3029,"children":3031},{"className":3030},[],[3032],{"type":22,"value":3033},"Optional",{"type":22,"value":3035}," around the type of a function parameter, you are also letting typer that that parameter is optional and that its default argument is ",{"type":16,"tag":1052,"props":3037,"children":3039},{"className":3038},[],[3040],{"type":22,"value":3041},"None",{"type":22,"value":363},{"type":16,"tag":69,"props":3044,"children":3045},{},[3046],{"type":22,"value":3047},"a parameter with only a type is a required parameter.",{"type":16,"tag":1045,"props":3049,"children":3051},{"code":3050,"language":1048,"meta":10,"className":1049,"style":10},"pd.read_parquet(\"../data/seoul/raw/testing_cli_extract2.csv\").head()\n",[3052],{"type":16,"tag":1052,"props":3053,"children":3054},{"__ignoreMap":10},[3055],{"type":16,"tag":1056,"props":3056,"children":3057},{"class":1058,"line":1059},[3058],{"type":16,"tag":1056,"props":3059,"children":3060},{},[3061],{"type":22,"value":3050},{"type":16,"tag":1565,"props":3063,"children":3065},{"id":3064},"_63-transform",[3066],{"type":22,"value":3067},"6.3 Transform",{"type":16,"tag":3069,"props":3070,"children":3074},"iframe",{"src":3071,"width":3072,"height":3073},"https://giphy.com/embed/R9zXHWAHyTjnq",400,300,[],{"type":16,"tag":28,"props":3076,"children":3077},{},[3078],{"type":22,"value":3079},"Depending on tasks that await the final output files or tables of an ETL pipeline (e.g. reporting metrics, building machine learning models, forecasting, etc.), this step can be very convoluted or slightly straightforward. In general, though, this step can include lots of cleaning and normalization functions, and a schema setter, among many others.",{"type":16,"tag":28,"props":3081,"children":3082},{},[3083],{"type":22,"value":3084},"The cleaning steps might include dealing with missing values, cleaning emails, names, addresses, and others, or putting values of similar nature into the same format (e.g. different weather measurements into one).",{"type":16,"tag":28,"props":3086,"children":3087},{},[3088],{"type":22,"value":3089},"Normalization can be anything from changing column names with the same values but different names to have the same one, or height in cm vs feet and inches to be in the same measure, or ..., you get the point. :)",{"type":16,"tag":28,"props":3091,"children":3092},{},[3093,3095,3102,3104,3111],{"type":22,"value":3094},"A schema is the way in which we represent not only the content and type of our new data files/tables, but also the way in which we represent their relationship. A common schema is the ",{"type":16,"tag":49,"props":3096,"children":3099},{"href":3097,"rel":3098},"https://www.databricks.com/glossary/star-schema",[53],[3100],{"type":22,"value":3101},"star schema",{"type":22,"value":3103},". An uncommon (but rising star) schema is the ",{"type":16,"tag":49,"props":3105,"children":3108},{"href":3106,"rel":3107},"https://www.activityschema.com/",[53],[3109],{"type":22,"value":3110},"activity schema",{"type":22,"value":363},{"type":16,"tag":1045,"props":3113,"children":3115},{"code":3114,"language":1048,"meta":10,"className":1049,"style":10},"import re\n",[3116],{"type":16,"tag":1052,"props":3117,"children":3118},{"__ignoreMap":10},[3119],{"type":16,"tag":1056,"props":3120,"children":3121},{"class":1058,"line":1059},[3122],{"type":16,"tag":1056,"props":3123,"children":3124},{},[3125],{"type":22,"value":3114},{"type":16,"tag":1045,"props":3127,"children":3129},{"code":3128,"language":1048,"meta":10,"className":1049,"style":10},"#create some toy data for our Bicycle problem\n\ntoy_data = pd.DataFrame({\"Postal Codes\": [22345, 32442, 20007], \n                         \"Cities'\":       [\"Miami,  FL\", \"Dallas, TX\", \"Washington, DC\"],\n                         \"Dates as mm-dd-yyy\":         pd.date_range(start='9/27/2021', periods=3)})\ntoy_data\n",[3130],{"type":16,"tag":1052,"props":3131,"children":3132},{"__ignoreMap":10},[3133,3141,3148,3156,3164,3172],{"type":16,"tag":1056,"props":3134,"children":3135},{"class":1058,"line":1059},[3136],{"type":16,"tag":1056,"props":3137,"children":3138},{},[3139],{"type":22,"value":3140},"#create some toy data for our Bicycle problem\n",{"type":16,"tag":1056,"props":3142,"children":3143},{"class":1058,"line":1068},[3144],{"type":16,"tag":1056,"props":3145,"children":3146},{"emptyLinePlaceholder":2302},[3147],{"type":22,"value":2305},{"type":16,"tag":1056,"props":3149,"children":3150},{"class":1058,"line":1269},[3151],{"type":16,"tag":1056,"props":3152,"children":3153},{},[3154],{"type":22,"value":3155},"toy_data = pd.DataFrame({\"Postal Codes\": [22345, 32442, 20007], \n",{"type":16,"tag":1056,"props":3157,"children":3158},{"class":1058,"line":1278},[3159],{"type":16,"tag":1056,"props":3160,"children":3161},{},[3162],{"type":22,"value":3163},"                         \"Cities'\":       [\"Miami,  FL\", \"Dallas, TX\", \"Washington, DC\"],\n",{"type":16,"tag":1056,"props":3165,"children":3166},{"class":1058,"line":1429},[3167],{"type":16,"tag":1056,"props":3168,"children":3169},{},[3170],{"type":22,"value":3171},"                         \"Dates as mm-dd-yyy\":         pd.date_range(start='9/27/2021', periods=3)})\n",{"type":16,"tag":1056,"props":3173,"children":3174},{"class":1058,"line":1509},[3175],{"type":16,"tag":1056,"props":3176,"children":3177},{},[3178],{"type":22,"value":3179},"toy_data\n",{"type":16,"tag":1045,"props":3181,"children":3183},{"code":3182,"language":1048,"meta":10,"className":1049,"style":10},"def clean_col_names(index_of_cols: pd.Index):\n    return [re.sub(r'[^a-zA-Z0-9\\s_]', '', col).lower().replace(r\" \", \"_\") for col in index_of_cols]\n",[3184],{"type":16,"tag":1052,"props":3185,"children":3186},{"__ignoreMap":10},[3187,3195],{"type":16,"tag":1056,"props":3188,"children":3189},{"class":1058,"line":1059},[3190],{"type":16,"tag":1056,"props":3191,"children":3192},{},[3193],{"type":22,"value":3194},"def clean_col_names(index_of_cols: pd.Index):\n",{"type":16,"tag":1056,"props":3196,"children":3197},{"class":1058,"line":1068},[3198],{"type":16,"tag":1056,"props":3199,"children":3200},{},[3201],{"type":22,"value":3202},"    return [re.sub(r'[^a-zA-Z0-9\\s_]', '', col).lower().replace(r\" \", \"_\") for col in index_of_cols]\n",{"type":16,"tag":1045,"props":3204,"children":3206},{"code":3205,"language":1048,"meta":10,"className":1049,"style":10},"clean_col_names(toy_data)\n",[3207],{"type":16,"tag":1052,"props":3208,"children":3209},{"__ignoreMap":10},[3210],{"type":16,"tag":1056,"props":3211,"children":3212},{"class":1058,"line":1059},[3213],{"type":16,"tag":1056,"props":3214,"children":3215},{},[3216],{"type":22,"value":3205},{"type":16,"tag":1045,"props":3218,"children":3220},{"code":3219,"language":1048,"meta":10,"className":1049,"style":10},"def extract_dates(data, date_col, hour_col=None):\n\n    data[\"date\"] = pd.to_datetime(data[date_col], infer_datetime_format=True)\n    if not data.columns.isin([\"hour\", \"Hour\", \"hr\", \"HR\"]).any():\n        data[\"hour\"] = data['date'].dt.hour\n        #Time series datasets need to be ordered by time.\n        data.sort_values([\"date\", \"hour\"], inplace=True)\n    elif hour_col:\n        data.sort_values([\"date\", hour_col], inplace=True)\n    else:\n        print(\"You must figure out how the hour works in your file.\")\n\n    data[\"year\"]           = data['date'].dt.year\n    data[\"month\"]          = data['date'].dt.month\n    data[\"week\"]           = data['date'].dt.isocalendar().week\n    data[\"day\"]            = data['date'].dt.day\n    data[\"day_of_week\"]    = data['date'].dt.dayofweek\n    data[\"is_month_start\"] = data['date'].dt.is_month_start    \n\n    data.drop('date', axis=1, inplace=True)\n    return data\n",[3221],{"type":16,"tag":1052,"props":3222,"children":3223},{"__ignoreMap":10},[3224,3232,3239,3247,3255,3263,3271,3279,3287,3295,3302,3310,3317,3325,3333,3341,3349,3357,3365,3372,3380],{"type":16,"tag":1056,"props":3225,"children":3226},{"class":1058,"line":1059},[3227],{"type":16,"tag":1056,"props":3228,"children":3229},{},[3230],{"type":22,"value":3231},"def extract_dates(data, date_col, hour_col=None):\n",{"type":16,"tag":1056,"props":3233,"children":3234},{"class":1058,"line":1068},[3235],{"type":16,"tag":1056,"props":3236,"children":3237},{"emptyLinePlaceholder":2302},[3238],{"type":22,"value":2305},{"type":16,"tag":1056,"props":3240,"children":3241},{"class":1058,"line":1269},[3242],{"type":16,"tag":1056,"props":3243,"children":3244},{},[3245],{"type":22,"value":3246},"    data[\"date\"] = pd.to_datetime(data[date_col], infer_datetime_format=True)\n",{"type":16,"tag":1056,"props":3248,"children":3249},{"class":1058,"line":1278},[3250],{"type":16,"tag":1056,"props":3251,"children":3252},{},[3253],{"type":22,"value":3254},"    if not data.columns.isin([\"hour\", \"Hour\", \"hr\", \"HR\"]).any():\n",{"type":16,"tag":1056,"props":3256,"children":3257},{"class":1058,"line":1429},[3258],{"type":16,"tag":1056,"props":3259,"children":3260},{},[3261],{"type":22,"value":3262},"        data[\"hour\"] = data['date'].dt.hour\n",{"type":16,"tag":1056,"props":3264,"children":3265},{"class":1058,"line":1509},[3266],{"type":16,"tag":1056,"props":3267,"children":3268},{},[3269],{"type":22,"value":3270},"        #Time series datasets need to be ordered by time.\n",{"type":16,"tag":1056,"props":3272,"children":3273},{"class":1058,"line":1633},[3274],{"type":16,"tag":1056,"props":3275,"children":3276},{},[3277],{"type":22,"value":3278},"        data.sort_values([\"date\", \"hour\"], inplace=True)\n",{"type":16,"tag":1056,"props":3280,"children":3281},{"class":1058,"line":1642},[3282],{"type":16,"tag":1056,"props":3283,"children":3284},{},[3285],{"type":22,"value":3286},"    elif hour_col:\n",{"type":16,"tag":1056,"props":3288,"children":3289},{"class":1058,"line":2353},[3290],{"type":16,"tag":1056,"props":3291,"children":3292},{},[3293],{"type":22,"value":3294},"        data.sort_values([\"date\", hour_col], inplace=True)\n",{"type":16,"tag":1056,"props":3296,"children":3297},{"class":1058,"line":2362},[3298],{"type":16,"tag":1056,"props":3299,"children":3300},{},[3301],{"type":22,"value":2791},{"type":16,"tag":1056,"props":3303,"children":3304},{"class":1058,"line":2370},[3305],{"type":16,"tag":1056,"props":3306,"children":3307},{},[3308],{"type":22,"value":3309},"        print(\"You must figure out how the hour works in your file.\")\n",{"type":16,"tag":1056,"props":3311,"children":3312},{"class":1058,"line":2378},[3313],{"type":16,"tag":1056,"props":3314,"children":3315},{"emptyLinePlaceholder":2302},[3316],{"type":22,"value":2305},{"type":16,"tag":1056,"props":3318,"children":3319},{"class":1058,"line":2386},[3320],{"type":16,"tag":1056,"props":3321,"children":3322},{},[3323],{"type":22,"value":3324},"    data[\"year\"]           = data['date'].dt.year\n",{"type":16,"tag":1056,"props":3326,"children":3327},{"class":1058,"line":2394},[3328],{"type":16,"tag":1056,"props":3329,"children":3330},{},[3331],{"type":22,"value":3332},"    data[\"month\"]          = data['date'].dt.month\n",{"type":16,"tag":1056,"props":3334,"children":3335},{"class":1058,"line":2403},[3336],{"type":16,"tag":1056,"props":3337,"children":3338},{},[3339],{"type":22,"value":3340},"    data[\"week\"]           = data['date'].dt.isocalendar().week\n",{"type":16,"tag":1056,"props":3342,"children":3343},{"class":1058,"line":2412},[3344],{"type":16,"tag":1056,"props":3345,"children":3346},{},[3347],{"type":22,"value":3348},"    data[\"day\"]            = data['date'].dt.day\n",{"type":16,"tag":1056,"props":3350,"children":3351},{"class":1058,"line":2420},[3352],{"type":16,"tag":1056,"props":3353,"children":3354},{},[3355],{"type":22,"value":3356},"    data[\"day_of_week\"]    = data['date'].dt.dayofweek\n",{"type":16,"tag":1056,"props":3358,"children":3359},{"class":1058,"line":2428},[3360],{"type":16,"tag":1056,"props":3361,"children":3362},{},[3363],{"type":22,"value":3364},"    data[\"is_month_start\"] = data['date'].dt.is_month_start    \n",{"type":16,"tag":1056,"props":3366,"children":3367},{"class":1058,"line":2436},[3368],{"type":16,"tag":1056,"props":3369,"children":3370},{"emptyLinePlaceholder":2302},[3371],{"type":22,"value":2305},{"type":16,"tag":1056,"props":3373,"children":3374},{"class":1058,"line":2444},[3375],{"type":16,"tag":1056,"props":3376,"children":3377},{},[3378],{"type":22,"value":3379},"    data.drop('date', axis=1, inplace=True)\n",{"type":16,"tag":1056,"props":3381,"children":3382},{"class":1058,"line":2452},[3383],{"type":16,"tag":1056,"props":3384,"children":3385},{},[3386],{"type":22,"value":1284},{"type":16,"tag":1045,"props":3388,"children":3390},{"code":3389,"language":1048,"meta":10,"className":1049,"style":10},"extract_dates(london_df, \"timestamp\").head()\n",[3391],{"type":16,"tag":1052,"props":3392,"children":3393},{"__ignoreMap":10},[3394],{"type":16,"tag":1056,"props":3395,"children":3396},{"class":1058,"line":1059},[3397],{"type":16,"tag":1056,"props":3398,"children":3399},{},[3400],{"type":22,"value":3389},{"type":16,"tag":28,"props":3402,"children":3403},{},[3404],{"type":22,"value":3405},"A common tasks in data science is to create dummy variables, which is ofter referred to as one-hot encoding. These are binary representations of a category, for example, if you have a columns with different kinds of cars, after you one-hot encode it, you will have one column for sedan, coupe, convertible, and so on, and each will be represented with a 0 or a 1 for when it is available and when it isn't, respectively.",{"type":16,"tag":1045,"props":3407,"children":3409},{"code":3408,"language":1048,"meta":10,"className":1049,"style":10},"def one_hot(data, cols_list, **kwargs):\n    return pd.get_dummies(data=data, columns=cols_list, **kwargs)\n",[3410],{"type":16,"tag":1052,"props":3411,"children":3412},{"__ignoreMap":10},[3413,3421],{"type":16,"tag":1056,"props":3414,"children":3415},{"class":1058,"line":1059},[3416],{"type":16,"tag":1056,"props":3417,"children":3418},{},[3419],{"type":22,"value":3420},"def one_hot(data, cols_list, **kwargs):\n",{"type":16,"tag":1056,"props":3422,"children":3423},{"class":1058,"line":1068},[3424],{"type":16,"tag":1056,"props":3425,"children":3426},{},[3427],{"type":22,"value":3428},"    return pd.get_dummies(data=data, columns=cols_list, **kwargs)\n",{"type":16,"tag":1045,"props":3430,"children":3432},{"code":3431,"language":1048,"meta":10,"className":1049,"style":10},"one_hot(seoul_df, [\"Seasons\", \"Holiday\"], drop_first=True).head()\n",[3433],{"type":16,"tag":1052,"props":3434,"children":3435},{"__ignoreMap":10},[3436],{"type":16,"tag":1056,"props":3437,"children":3438},{"class":1058,"line":1059},[3439],{"type":16,"tag":1056,"props":3440,"children":3441},{},[3442],{"type":22,"value":3431},{"type":16,"tag":1045,"props":3444,"children":3446},{"code":3445,"language":1048,"meta":10,"className":1049,"style":10},"def add_location_cols(data, place):\n    data[\"loc_id\"] = place\n    return data\n",[3447],{"type":16,"tag":1052,"props":3448,"children":3449},{"__ignoreMap":10},[3450,3458,3466],{"type":16,"tag":1056,"props":3451,"children":3452},{"class":1058,"line":1059},[3453],{"type":16,"tag":1056,"props":3454,"children":3455},{},[3456],{"type":22,"value":3457},"def add_location_cols(data, place):\n",{"type":16,"tag":1056,"props":3459,"children":3460},{"class":1058,"line":1068},[3461],{"type":16,"tag":1056,"props":3462,"children":3463},{},[3464],{"type":22,"value":3465},"    data[\"loc_id\"] = place\n",{"type":16,"tag":1056,"props":3467,"children":3468},{"class":1058,"line":1269},[3469],{"type":16,"tag":1056,"props":3470,"children":3471},{},[3472],{"type":22,"value":1284},{"type":16,"tag":1045,"props":3474,"children":3476},{"code":3475,"language":1048,"meta":10,"className":1049,"style":10},"add_location_cols(dc_df, \"DC\").head()\n",[3477],{"type":16,"tag":1052,"props":3478,"children":3479},{"__ignoreMap":10},[3480],{"type":16,"tag":1056,"props":3481,"children":3482},{"class":1058,"line":1059},[3483],{"type":16,"tag":1056,"props":3484,"children":3485},{},[3486],{"type":22,"value":3475},{"type":16,"tag":1045,"props":3488,"children":3490},{"code":3489,"language":1048,"meta":10,"className":1049,"style":10},"def fix_and_drop(data, col_to_fix, mapping, cols_to_drop):\n    data[col_to_fix] = data[col_to_fix].map(mapping)\n    return data.drop(cols_to_drop, axis=1)\n",[3491],{"type":16,"tag":1052,"props":3492,"children":3493},{"__ignoreMap":10},[3494,3502,3510],{"type":16,"tag":1056,"props":3495,"children":3496},{"class":1058,"line":1059},[3497],{"type":16,"tag":1056,"props":3498,"children":3499},{},[3500],{"type":22,"value":3501},"def fix_and_drop(data, col_to_fix, mapping, cols_to_drop):\n",{"type":16,"tag":1056,"props":3503,"children":3504},{"class":1058,"line":1068},[3505],{"type":16,"tag":1056,"props":3506,"children":3507},{},[3508],{"type":22,"value":3509},"    data[col_to_fix] = data[col_to_fix].map(mapping)\n",{"type":16,"tag":1056,"props":3511,"children":3512},{"class":1058,"line":1269},[3513],{"type":16,"tag":1056,"props":3514,"children":3515},{},[3516],{"type":22,"value":3517},"    return data.drop(cols_to_drop, axis=1)\n",{"type":16,"tag":1045,"props":3519,"children":3521},{"code":3520,"language":1048,"meta":10,"className":1049,"style":10},"seasons_london = {'Spring': 0, 'Summer': 1, 'Fall': 2, 'Winter': 3}\ncols_drop_london = ['t2', 'weather_code']\n",[3522],{"type":16,"tag":1052,"props":3523,"children":3524},{"__ignoreMap":10},[3525,3533],{"type":16,"tag":1056,"props":3526,"children":3527},{"class":1058,"line":1059},[3528],{"type":16,"tag":1056,"props":3529,"children":3530},{},[3531],{"type":22,"value":3532},"seasons_london = {'Spring': 0, 'Summer': 1, 'Fall': 2, 'Winter': 3}\n",{"type":16,"tag":1056,"props":3534,"children":3535},{"class":1058,"line":1068},[3536],{"type":16,"tag":1056,"props":3537,"children":3538},{},[3539],{"type":22,"value":3540},"cols_drop_london = ['t2', 'weather_code']\n",{"type":16,"tag":1045,"props":3542,"children":3543},{"code":2119,"language":1048,"meta":10,"className":1049,"style":10},[3544],{"type":16,"tag":1052,"props":3545,"children":3546},{"__ignoreMap":10},[3547],{"type":16,"tag":1056,"props":3548,"children":3549},{"class":1058,"line":1059},[3550],{"type":16,"tag":1056,"props":3551,"children":3552},{},[3553],{"type":22,"value":2119},{"type":16,"tag":1045,"props":3555,"children":3557},{"code":3556,"language":1048,"meta":10,"className":1049,"style":10},"london_df[\"seasonreal\"].map(seasons_london).value_counts()\n",[3558],{"type":16,"tag":1052,"props":3559,"children":3560},{"__ignoreMap":10},[3561],{"type":16,"tag":1056,"props":3562,"children":3563},{"class":1058,"line":1059},[3564],{"type":16,"tag":1056,"props":3565,"children":3566},{},[3567],{"type":22,"value":3556},{"type":16,"tag":1045,"props":3569,"children":3571},{"code":3570,"language":1048,"meta":10,"className":1049,"style":10},"fix_and_drop(london_df, \"seasonreal\", seasons_london, cols_drop_london).head()\n",[3572],{"type":16,"tag":1052,"props":3573,"children":3574},{"__ignoreMap":10},[3575],{"type":16,"tag":1056,"props":3576,"children":3577},{"class":1058,"line":1059},[3578],{"type":16,"tag":1056,"props":3579,"children":3580},{},[3581],{"type":22,"value":3570},{"type":16,"tag":1045,"props":3583,"children":3585},{"code":3584,"language":1048,"meta":10,"className":1049,"style":10},"def order_and_merge(data_lists, date=None):\n    pick_order = data_lists[0].columns #takes order of columns of the first dataset\n    #reindexing columns by the order of the first dataset, then sorting by date and hour.\n    if date:\n        new_list = [d.reindex(columns=pick_order).sort_values([date, 'hour']) for d in data_lists]\n    else:\n        new_list = data_lists\n    return pd.concat(new_list) #merge all\n",[3586],{"type":16,"tag":1052,"props":3587,"children":3588},{"__ignoreMap":10},[3589,3597,3605,3613,3621,3629,3636,3644],{"type":16,"tag":1056,"props":3590,"children":3591},{"class":1058,"line":1059},[3592],{"type":16,"tag":1056,"props":3593,"children":3594},{},[3595],{"type":22,"value":3596},"def order_and_merge(data_lists, date=None):\n",{"type":16,"tag":1056,"props":3598,"children":3599},{"class":1058,"line":1068},[3600],{"type":16,"tag":1056,"props":3601,"children":3602},{},[3603],{"type":22,"value":3604},"    pick_order = data_lists[0].columns #takes order of columns of the first dataset\n",{"type":16,"tag":1056,"props":3606,"children":3607},{"class":1058,"line":1269},[3608],{"type":16,"tag":1056,"props":3609,"children":3610},{},[3611],{"type":22,"value":3612},"    #reindexing columns by the order of the first dataset, then sorting by date and hour.\n",{"type":16,"tag":1056,"props":3614,"children":3615},{"class":1058,"line":1278},[3616],{"type":16,"tag":1056,"props":3617,"children":3618},{},[3619],{"type":22,"value":3620},"    if date:\n",{"type":16,"tag":1056,"props":3622,"children":3623},{"class":1058,"line":1429},[3624],{"type":16,"tag":1056,"props":3625,"children":3626},{},[3627],{"type":22,"value":3628},"        new_list = [d.reindex(columns=pick_order).sort_values([date, 'hour']) for d in data_lists]\n",{"type":16,"tag":1056,"props":3630,"children":3631},{"class":1058,"line":1509},[3632],{"type":16,"tag":1056,"props":3633,"children":3634},{},[3635],{"type":22,"value":2791},{"type":16,"tag":1056,"props":3637,"children":3638},{"class":1058,"line":1633},[3639],{"type":16,"tag":1056,"props":3640,"children":3641},{},[3642],{"type":22,"value":3643},"        new_list = data_lists\n",{"type":16,"tag":1056,"props":3645,"children":3646},{"class":1058,"line":1642},[3647],{"type":16,"tag":1056,"props":3648,"children":3649},{},[3650],{"type":22,"value":3651},"    return pd.concat(new_list) #merge all\n",{"type":16,"tag":1565,"props":3653,"children":3655},{"id":3654},"exercise",[3656],{"type":22,"value":3657},"Exercise",{"type":16,"tag":28,"props":3659,"children":3660},{},[3661],{"type":22,"value":3662},"Pick any two datasets and",{"type":16,"tag":124,"props":3664,"children":3665},{},[3666,3671,3676],{"type":16,"tag":69,"props":3667,"children":3668},{},[3669],{"type":22,"value":3670},"select 5 columns from each",{"type":16,"tag":69,"props":3672,"children":3673},{},[3674],{"type":22,"value":3675},"change column names as appropriate",{"type":16,"tag":69,"props":3677,"children":3678},{},[3679],{"type":22,"value":3680},"use the order_and_nerge function to combine both",{"type":16,"tag":1045,"props":3682,"children":3683},{"code":2119,"language":1048,"meta":10,"className":1049,"style":10},[3684],{"type":16,"tag":1052,"props":3685,"children":3686},{"__ignoreMap":10},[3687],{"type":16,"tag":1056,"props":3688,"children":3689},{"class":1058,"line":1059},[3690],{"type":16,"tag":1056,"props":3691,"children":3692},{},[3693],{"type":22,"value":2119},{"type":16,"tag":1045,"props":3695,"children":3697},{"code":3696,"language":1048,"meta":10,"className":1049,"style":10},"london_df_small = london_df[[\"cnt\", \"t1\", \"wind_speed\", \"seasonreal\", \"hour\"]]\nlondon_df_small.tail()\n",[3698],{"type":16,"tag":1052,"props":3699,"children":3700},{"__ignoreMap":10},[3701,3709],{"type":16,"tag":1056,"props":3702,"children":3703},{"class":1058,"line":1059},[3704],{"type":16,"tag":1056,"props":3705,"children":3706},{},[3707],{"type":22,"value":3708},"london_df_small = london_df[[\"cnt\", \"t1\", \"wind_speed\", \"seasonreal\", \"hour\"]]\n",{"type":16,"tag":1056,"props":3710,"children":3711},{"class":1058,"line":1068},[3712],{"type":16,"tag":1056,"props":3713,"children":3714},{},[3715],{"type":22,"value":3716},"london_df_small.tail()\n",{"type":16,"tag":1045,"props":3718,"children":3719},{"code":1910,"language":1048,"meta":10,"className":1049,"style":10},[3720],{"type":16,"tag":1052,"props":3721,"children":3722},{"__ignoreMap":10},[3723],{"type":16,"tag":1056,"props":3724,"children":3725},{"class":1058,"line":1059},[3726],{"type":16,"tag":1056,"props":3727,"children":3728},{},[3729],{"type":22,"value":1910},{"type":16,"tag":1045,"props":3731,"children":3733},{"code":3732,"language":1048,"meta":10,"className":1049,"style":10},"seoul_df_small = seoul_df[[\"Rented Bike Count\", \"Temperature(�C)\", \"Wind speed (m/s)\", \"Seasons\", \"Hour\"]]\nseoul_df_small.head()\n",[3734],{"type":16,"tag":1052,"props":3735,"children":3736},{"__ignoreMap":10},[3737,3745],{"type":16,"tag":1056,"props":3738,"children":3739},{"class":1058,"line":1059},[3740],{"type":16,"tag":1056,"props":3741,"children":3742},{},[3743],{"type":22,"value":3744},"seoul_df_small = seoul_df[[\"Rented Bike Count\", \"Temperature(�C)\", \"Wind speed (m/s)\", \"Seasons\", \"Hour\"]]\n",{"type":16,"tag":1056,"props":3746,"children":3747},{"class":1058,"line":1068},[3748],{"type":16,"tag":1056,"props":3749,"children":3750},{},[3751],{"type":22,"value":3752},"seoul_df_small.head()\n",{"type":16,"tag":1045,"props":3754,"children":3756},{"code":3755,"language":1048,"meta":10,"className":1049,"style":10},"seoul_df_small.columns = london_df_small.columns\nseoul_df_small.columns == london_df_small.columns\n",[3757],{"type":16,"tag":1052,"props":3758,"children":3759},{"__ignoreMap":10},[3760,3768],{"type":16,"tag":1056,"props":3761,"children":3762},{"class":1058,"line":1059},[3763],{"type":16,"tag":1056,"props":3764,"children":3765},{},[3766],{"type":22,"value":3767},"seoul_df_small.columns = london_df_small.columns\n",{"type":16,"tag":1056,"props":3769,"children":3770},{"class":1058,"line":1068},[3771],{"type":16,"tag":1056,"props":3772,"children":3773},{},[3774],{"type":22,"value":3775},"seoul_df_small.columns == london_df_small.columns\n",{"type":16,"tag":1045,"props":3777,"children":3779},{"code":3778,"language":1048,"meta":10,"className":1049,"style":10},"order_and_merge([seoul_df_small, london_df_small]).shape\n",[3780],{"type":16,"tag":1052,"props":3781,"children":3782},{"__ignoreMap":10},[3783],{"type":16,"tag":1056,"props":3784,"children":3785},{"class":1058,"line":1059},[3786],{"type":16,"tag":1056,"props":3787,"children":3788},{},[3789],{"type":22,"value":3778},{"type":16,"tag":28,"props":3791,"children":3792},{},[3793,3795,3800,3802,3807],{"type":22,"value":3794},"Finally, we take the same approach as with the extract set of functions and wrap our transform workflow into a ",{"type":16,"tag":1052,"props":3796,"children":3798},{"className":3797},[],[3799],{"type":22,"value":2862},{"type":22,"value":3801}," function, and then that ",{"type":16,"tag":1052,"props":3803,"children":3805},{"className":3804},[],[3806],{"type":22,"value":2862},{"type":22,"value":3808}," function into a typer CLI.",{"type":16,"tag":1045,"props":3810,"children":3812},{"code":3811,"language":1048,"meta":10,"className":1049,"style":10},"%%writefile ../src/data_eng/transform.py\n\nimport pandas as pd, re\nfrom pathlib import Path\nfrom extract import save_data\nimport typer\nfrom typing import Optional, List\n\ndef clean_col_names(index_of_cols: pd.Index):\n    return [re.sub(r'[^a-zA-Z0-9\\s_]', '', col).lower().replace(r\" \", \"_\") for col in index_of_cols]\n\ndef extract_dates(data, date_col, hour_col=None):\n\n    data[\"date\"] = pd.to_datetime(data[date_col], infer_datetime_format=True)\n    if not data.columns.isin([\"hour\", \"Hour\", \"hr\", \"HR\"]).any():\n        data[\"hour\"] = data['date'].dt.hour\n        #Time series datasets need to be ordered by time.\n        data.sort_values([\"date\", \"hour\"], inplace=True)\n    elif hour_col:\n        data.sort_values([\"date\", hour_col], inplace=True)\n    else:\n        print(\"You must figure out how the hour works in your file.\")\n\n    data[\"year\"]           = data['date'].dt.year\n    data[\"month\"]          = data['date'].dt.month\n    data[\"week\"]           = data['date'].dt.isocalendar().week\n    data[\"day\"]            = data['date'].dt.day\n    data[\"day_of_week\"]    = data['date'].dt.dayofweek\n    data[\"is_month_start\"] = data['date'].dt.is_month_start    \n\n    data.drop('date', axis=1, inplace=True)\n    return data\n\ndef one_hot(data, cols_list):\n    return pd.get_dummies(data=data, columns=cols_list)\n\ndef add_location_cols(data, place):\n    data[\"loc_id\"] = place\n    return data\n\ndef fix_and_drop(data, col_to_fix, mapping, cols_to_drop):\n    data[col_to_fix] = data[col_to_fix].map(mapping)\n    return data.drop(cols_to_drop, axis=1)\n\ndef order_and_merge(data_lists):\n    pick_order = data_lists[0].columns #takes order of columns of the first dataset\n    new_list = [d.reindex(columns=pick_order).sort_values(['date', 'hour']) for d in data_lists] #reindexing columns by the order of the first dataset, then sorting by date and hour.\n    return pd.concat(new_list) #merge all\n\ndef main(\n    path_in:   str           = typer.Option(...),\n    date_col:  Optional[str] = typer.Option(None),\n    hour_col:  Optional[str] = typer.Option(None),\n    cols_list: List[str]     = typer.Option(None),\n    place:     Optional[str] = typer.Option(None),\n    path_out:  Optional[str] = typer.Option(None),\n    file_name: Optional[str] = typer.Option(None)\n):\n    data = pd.read_parquet(path_in)\n    # data.columns = clean_col_names(data.columns)\n    data = extract_dates(data, date_col, hour_col)\n    if cols_list:\n        data = one_hot(data, cols_list)\n    data.columns = clean_col_names(data.columns)\n    data = add_location_cols(data, place)\n    save_data(data, path_out, file_name)\n\n    print(\"Data Extracted and Transformed Successfully!\")\n\nif __name__ == \"__main__\":\n    typer.run(main)\n",[3813],{"type":16,"tag":1052,"props":3814,"children":3815},{"__ignoreMap":10},[3816,3824,3831,3839,3846,3854,3861,3869,3876,3883,3890,3897,3904,3911,3918,3925,3932,3939,3946,3953,3960,3967,3974,3981,3988,3995,4002,4009,4016,4023,4030,4037,4044,4051,4059,4067,4074,4081,4088,4095,4102,4109,4116,4123,4130,4138,4145,4153,4160,4167,4174,4182,4190,4198,4206,4214,4222,4230,4237,4245,4253,4261,4269,4277,4285,4293,4301,4308,4317,4325,4333],{"type":16,"tag":1056,"props":3817,"children":3818},{"class":1058,"line":1059},[3819],{"type":16,"tag":1056,"props":3820,"children":3821},{},[3822],{"type":22,"value":3823},"%%writefile ../src/data_eng/transform.py\n",{"type":16,"tag":1056,"props":3825,"children":3826},{"class":1058,"line":1068},[3827],{"type":16,"tag":1056,"props":3828,"children":3829},{"emptyLinePlaceholder":2302},[3830],{"type":22,"value":2305},{"type":16,"tag":1056,"props":3832,"children":3833},{"class":1058,"line":1269},[3834],{"type":16,"tag":1056,"props":3835,"children":3836},{},[3837],{"type":22,"value":3838},"import pandas as pd, re\n",{"type":16,"tag":1056,"props":3840,"children":3841},{"class":1058,"line":1278},[3842],{"type":16,"tag":1056,"props":3843,"children":3844},{},[3845],{"type":22,"value":1074},{"type":16,"tag":1056,"props":3847,"children":3848},{"class":1058,"line":1429},[3849],{"type":16,"tag":1056,"props":3850,"children":3851},{},[3852],{"type":22,"value":3853},"from extract import save_data\n",{"type":16,"tag":1056,"props":3855,"children":3856},{"class":1058,"line":1509},[3857],{"type":16,"tag":1056,"props":3858,"children":3859},{},[3860],{"type":22,"value":2342},{"type":16,"tag":1056,"props":3862,"children":3863},{"class":1058,"line":1633},[3864],{"type":16,"tag":1056,"props":3865,"children":3866},{},[3867],{"type":22,"value":3868},"from typing import Optional, List\n",{"type":16,"tag":1056,"props":3870,"children":3871},{"class":1058,"line":1642},[3872],{"type":16,"tag":1056,"props":3873,"children":3874},{"emptyLinePlaceholder":2302},[3875],{"type":22,"value":2305},{"type":16,"tag":1056,"props":3877,"children":3878},{"class":1058,"line":2353},[3879],{"type":16,"tag":1056,"props":3880,"children":3881},{},[3882],{"type":22,"value":3194},{"type":16,"tag":1056,"props":3884,"children":3885},{"class":1058,"line":2362},[3886],{"type":16,"tag":1056,"props":3887,"children":3888},{},[3889],{"type":22,"value":3202},{"type":16,"tag":1056,"props":3891,"children":3892},{"class":1058,"line":2370},[3893],{"type":16,"tag":1056,"props":3894,"children":3895},{"emptyLinePlaceholder":2302},[3896],{"type":22,"value":2305},{"type":16,"tag":1056,"props":3898,"children":3899},{"class":1058,"line":2378},[3900],{"type":16,"tag":1056,"props":3901,"children":3902},{},[3903],{"type":22,"value":3231},{"type":16,"tag":1056,"props":3905,"children":3906},{"class":1058,"line":2386},[3907],{"type":16,"tag":1056,"props":3908,"children":3909},{"emptyLinePlaceholder":2302},[3910],{"type":22,"value":2305},{"type":16,"tag":1056,"props":3912,"children":3913},{"class":1058,"line":2394},[3914],{"type":16,"tag":1056,"props":3915,"children":3916},{},[3917],{"type":22,"value":3246},{"type":16,"tag":1056,"props":3919,"children":3920},{"class":1058,"line":2403},[3921],{"type":16,"tag":1056,"props":3922,"children":3923},{},[3924],{"type":22,"value":3254},{"type":16,"tag":1056,"props":3926,"children":3927},{"class":1058,"line":2412},[3928],{"type":16,"tag":1056,"props":3929,"children":3930},{},[3931],{"type":22,"value":3262},{"type":16,"tag":1056,"props":3933,"children":3934},{"class":1058,"line":2420},[3935],{"type":16,"tag":1056,"props":3936,"children":3937},{},[3938],{"type":22,"value":3270},{"type":16,"tag":1056,"props":3940,"children":3941},{"class":1058,"line":2428},[3942],{"type":16,"tag":1056,"props":3943,"children":3944},{},[3945],{"type":22,"value":3278},{"type":16,"tag":1056,"props":3947,"children":3948},{"class":1058,"line":2436},[3949],{"type":16,"tag":1056,"props":3950,"children":3951},{},[3952],{"type":22,"value":3286},{"type":16,"tag":1056,"props":3954,"children":3955},{"class":1058,"line":2444},[3956],{"type":16,"tag":1056,"props":3957,"children":3958},{},[3959],{"type":22,"value":3294},{"type":16,"tag":1056,"props":3961,"children":3962},{"class":1058,"line":2452},[3963],{"type":16,"tag":1056,"props":3964,"children":3965},{},[3966],{"type":22,"value":2791},{"type":16,"tag":1056,"props":3968,"children":3969},{"class":1058,"line":2460},[3970],{"type":16,"tag":1056,"props":3971,"children":3972},{},[3973],{"type":22,"value":3309},{"type":16,"tag":1056,"props":3975,"children":3976},{"class":1058,"line":2468},[3977],{"type":16,"tag":1056,"props":3978,"children":3979},{"emptyLinePlaceholder":2302},[3980],{"type":22,"value":2305},{"type":16,"tag":1056,"props":3982,"children":3983},{"class":1058,"line":2476},[3984],{"type":16,"tag":1056,"props":3985,"children":3986},{},[3987],{"type":22,"value":3324},{"type":16,"tag":1056,"props":3989,"children":3990},{"class":1058,"line":2484},[3991],{"type":16,"tag":1056,"props":3992,"children":3993},{},[3994],{"type":22,"value":3332},{"type":16,"tag":1056,"props":3996,"children":3997},{"class":1058,"line":2492},[3998],{"type":16,"tag":1056,"props":3999,"children":4000},{},[4001],{"type":22,"value":3340},{"type":16,"tag":1056,"props":4003,"children":4004},{"class":1058,"line":2500},[4005],{"type":16,"tag":1056,"props":4006,"children":4007},{},[4008],{"type":22,"value":3348},{"type":16,"tag":1056,"props":4010,"children":4011},{"class":1058,"line":2508},[4012],{"type":16,"tag":1056,"props":4013,"children":4014},{},[4015],{"type":22,"value":3356},{"type":16,"tag":1056,"props":4017,"children":4018},{"class":1058,"line":2516},[4019],{"type":16,"tag":1056,"props":4020,"children":4021},{},[4022],{"type":22,"value":3364},{"type":16,"tag":1056,"props":4024,"children":4025},{"class":1058,"line":2524},[4026],{"type":16,"tag":1056,"props":4027,"children":4028},{"emptyLinePlaceholder":2302},[4029],{"type":22,"value":2305},{"type":16,"tag":1056,"props":4031,"children":4032},{"class":1058,"line":2533},[4033],{"type":16,"tag":1056,"props":4034,"children":4035},{},[4036],{"type":22,"value":3379},{"type":16,"tag":1056,"props":4038,"children":4039},{"class":1058,"line":2541},[4040],{"type":16,"tag":1056,"props":4041,"children":4042},{},[4043],{"type":22,"value":1284},{"type":16,"tag":1056,"props":4045,"children":4046},{"class":1058,"line":2549},[4047],{"type":16,"tag":1056,"props":4048,"children":4049},{"emptyLinePlaceholder":2302},[4050],{"type":22,"value":2305},{"type":16,"tag":1056,"props":4052,"children":4053},{"class":1058,"line":2557},[4054],{"type":16,"tag":1056,"props":4055,"children":4056},{},[4057],{"type":22,"value":4058},"def one_hot(data, cols_list):\n",{"type":16,"tag":1056,"props":4060,"children":4061},{"class":1058,"line":2565},[4062],{"type":16,"tag":1056,"props":4063,"children":4064},{},[4065],{"type":22,"value":4066},"    return pd.get_dummies(data=data, columns=cols_list)\n",{"type":16,"tag":1056,"props":4068,"children":4069},{"class":1058,"line":2573},[4070],{"type":16,"tag":1056,"props":4071,"children":4072},{"emptyLinePlaceholder":2302},[4073],{"type":22,"value":2305},{"type":16,"tag":1056,"props":4075,"children":4076},{"class":1058,"line":2581},[4077],{"type":16,"tag":1056,"props":4078,"children":4079},{},[4080],{"type":22,"value":3457},{"type":16,"tag":1056,"props":4082,"children":4083},{"class":1058,"line":2590},[4084],{"type":16,"tag":1056,"props":4085,"children":4086},{},[4087],{"type":22,"value":3465},{"type":16,"tag":1056,"props":4089,"children":4090},{"class":1058,"line":2599},[4091],{"type":16,"tag":1056,"props":4092,"children":4093},{},[4094],{"type":22,"value":1284},{"type":16,"tag":1056,"props":4096,"children":4097},{"class":1058,"line":2608},[4098],{"type":16,"tag":1056,"props":4099,"children":4100},{"emptyLinePlaceholder":2302},[4101],{"type":22,"value":2305},{"type":16,"tag":1056,"props":4103,"children":4104},{"class":1058,"line":2617},[4105],{"type":16,"tag":1056,"props":4106,"children":4107},{},[4108],{"type":22,"value":3501},{"type":16,"tag":1056,"props":4110,"children":4111},{"class":1058,"line":2626},[4112],{"type":16,"tag":1056,"props":4113,"children":4114},{},[4115],{"type":22,"value":3509},{"type":16,"tag":1056,"props":4117,"children":4118},{"class":1058,"line":2635},[4119],{"type":16,"tag":1056,"props":4120,"children":4121},{},[4122],{"type":22,"value":3517},{"type":16,"tag":1056,"props":4124,"children":4125},{"class":1058,"line":2644},[4126],{"type":16,"tag":1056,"props":4127,"children":4128},{"emptyLinePlaceholder":2302},[4129],{"type":22,"value":2305},{"type":16,"tag":1056,"props":4131,"children":4132},{"class":1058,"line":2653},[4133],{"type":16,"tag":1056,"props":4134,"children":4135},{},[4136],{"type":22,"value":4137},"def order_and_merge(data_lists):\n",{"type":16,"tag":1056,"props":4139,"children":4140},{"class":1058,"line":2662},[4141],{"type":16,"tag":1056,"props":4142,"children":4143},{},[4144],{"type":22,"value":3604},{"type":16,"tag":1056,"props":4146,"children":4147},{"class":1058,"line":2671},[4148],{"type":16,"tag":1056,"props":4149,"children":4150},{},[4151],{"type":22,"value":4152},"    new_list = [d.reindex(columns=pick_order).sort_values(['date', 'hour']) for d in data_lists] #reindexing columns by the order of the first dataset, then sorting by date and hour.\n",{"type":16,"tag":1056,"props":4154,"children":4155},{"class":1058,"line":2680},[4156],{"type":16,"tag":1056,"props":4157,"children":4158},{},[4159],{"type":22,"value":3651},{"type":16,"tag":1056,"props":4161,"children":4162},{"class":1058,"line":2689},[4163],{"type":16,"tag":1056,"props":4164,"children":4165},{"emptyLinePlaceholder":2302},[4166],{"type":22,"value":2305},{"type":16,"tag":1056,"props":4168,"children":4169},{"class":1058,"line":2698},[4170],{"type":16,"tag":1056,"props":4171,"children":4172},{},[4173],{"type":22,"value":2587},{"type":16,"tag":1056,"props":4175,"children":4176},{"class":1058,"line":2707},[4177],{"type":16,"tag":1056,"props":4178,"children":4179},{},[4180],{"type":22,"value":4181},"    path_in:   str           = typer.Option(...),\n",{"type":16,"tag":1056,"props":4183,"children":4184},{"class":1058,"line":2716},[4185],{"type":16,"tag":1056,"props":4186,"children":4187},{},[4188],{"type":22,"value":4189},"    date_col:  Optional[str] = typer.Option(None),\n",{"type":16,"tag":1056,"props":4191,"children":4192},{"class":1058,"line":2725},[4193],{"type":16,"tag":1056,"props":4194,"children":4195},{},[4196],{"type":22,"value":4197},"    hour_col:  Optional[str] = typer.Option(None),\n",{"type":16,"tag":1056,"props":4199,"children":4200},{"class":1058,"line":2733},[4201],{"type":16,"tag":1056,"props":4202,"children":4203},{},[4204],{"type":22,"value":4205},"    cols_list: List[str]     = typer.Option(None),\n",{"type":16,"tag":1056,"props":4207,"children":4208},{"class":1058,"line":2742},[4209],{"type":16,"tag":1056,"props":4210,"children":4211},{},[4212],{"type":22,"value":4213},"    place:     Optional[str] = typer.Option(None),\n",{"type":16,"tag":1056,"props":4215,"children":4216},{"class":1058,"line":2751},[4217],{"type":16,"tag":1056,"props":4218,"children":4219},{},[4220],{"type":22,"value":4221},"    path_out:  Optional[str] = typer.Option(None),\n",{"type":16,"tag":1056,"props":4223,"children":4224},{"class":1058,"line":2759},[4225],{"type":16,"tag":1056,"props":4226,"children":4227},{},[4228],{"type":22,"value":4229},"    file_name: Optional[str] = typer.Option(None)\n",{"type":16,"tag":1056,"props":4231,"children":4232},{"class":1058,"line":2768},[4233],{"type":16,"tag":1056,"props":4234,"children":4235},{},[4236],{"type":22,"value":2659},{"type":16,"tag":1056,"props":4238,"children":4239},{"class":1058,"line":2777},[4240],{"type":16,"tag":1056,"props":4241,"children":4242},{},[4243],{"type":22,"value":4244},"    data = pd.read_parquet(path_in)\n",{"type":16,"tag":1056,"props":4246,"children":4247},{"class":1058,"line":2785},[4248],{"type":16,"tag":1056,"props":4249,"children":4250},{},[4251],{"type":22,"value":4252},"    # data.columns = clean_col_names(data.columns)\n",{"type":16,"tag":1056,"props":4254,"children":4255},{"class":1058,"line":2794},[4256],{"type":16,"tag":1056,"props":4257,"children":4258},{},[4259],{"type":22,"value":4260},"    data = extract_dates(data, date_col, hour_col)\n",{"type":16,"tag":1056,"props":4262,"children":4263},{"class":1058,"line":2803},[4264],{"type":16,"tag":1056,"props":4265,"children":4266},{},[4267],{"type":22,"value":4268},"    if cols_list:\n",{"type":16,"tag":1056,"props":4270,"children":4271},{"class":1058,"line":2811},[4272],{"type":16,"tag":1056,"props":4273,"children":4274},{},[4275],{"type":22,"value":4276},"        data = one_hot(data, cols_list)\n",{"type":16,"tag":1056,"props":4278,"children":4279},{"class":1058,"line":2820},[4280],{"type":16,"tag":1056,"props":4281,"children":4282},{},[4283],{"type":22,"value":4284},"    data.columns = clean_col_names(data.columns)\n",{"type":16,"tag":1056,"props":4286,"children":4287},{"class":1058,"line":2828},[4288],{"type":16,"tag":1056,"props":4289,"children":4290},{},[4291],{"type":22,"value":4292},"    data = add_location_cols(data, place)\n",{"type":16,"tag":1056,"props":4294,"children":4295},{"class":1058,"line":2836},[4296],{"type":16,"tag":1056,"props":4297,"children":4298},{},[4299],{"type":22,"value":4300},"    save_data(data, path_out, file_name)\n",{"type":16,"tag":1056,"props":4302,"children":4303},{"class":1058,"line":2845},[4304],{"type":16,"tag":1056,"props":4305,"children":4306},{"emptyLinePlaceholder":2302},[4307],{"type":22,"value":2305},{"type":16,"tag":1056,"props":4309,"children":4311},{"class":1058,"line":4310},68,[4312],{"type":16,"tag":1056,"props":4313,"children":4314},{},[4315],{"type":22,"value":4316},"    print(\"Data Extracted and Transformed Successfully!\")\n",{"type":16,"tag":1056,"props":4318,"children":4320},{"class":1058,"line":4319},69,[4321],{"type":16,"tag":1056,"props":4322,"children":4323},{"emptyLinePlaceholder":2302},[4324],{"type":22,"value":2305},{"type":16,"tag":1056,"props":4326,"children":4328},{"class":1058,"line":4327},70,[4329],{"type":16,"tag":1056,"props":4330,"children":4331},{},[4332],{"type":22,"value":2842},{"type":16,"tag":1056,"props":4334,"children":4336},{"class":1058,"line":4335},71,[4337],{"type":16,"tag":1056,"props":4338,"children":4339},{},[4340],{"type":22,"value":2851},{"type":16,"tag":1045,"props":4342,"children":4344},{"code":4343,"language":1048,"meta":10,"className":1049,"style":10},"pd.read_parquet(\"../data/seoul/interim/cli_test_clean.parquet\").head()\n",[4345],{"type":16,"tag":1052,"props":4346,"children":4347},{"__ignoreMap":10},[4348],{"type":16,"tag":1056,"props":4349,"children":4350},{"class":1058,"line":1059},[4351],{"type":16,"tag":1056,"props":4352,"children":4353},{},[4354],{"type":22,"value":4343},{"type":16,"tag":1565,"props":4356,"children":4358},{"id":4357},"_62-load",[4359],{"type":22,"value":4360},"6.2 Load",{"type":16,"tag":28,"props":4362,"children":4363},{},[4364],{"type":22,"value":4365},"The loading stage, at least for analytical purposes, tends to be a data warehouse like BigQuery, Redshift, etc., but it can also be a directory in a data lake where files are saved in the highly optimized parquet format.",{"type":16,"tag":28,"props":4367,"children":4368},{},[4369,4371,4376],{"type":22,"value":4370},"In order for us to simulate a data warehouse locally, we will create a duckdb database using the python library ",{"type":16,"tag":1052,"props":4372,"children":4374},{"className":4373},[],[4375],{"type":22,"value":828},{"type":22,"value":4377},". The reason we will do it this ways is that ibis can translate the schema of our files into the duckdb SQL in one line of code. Effectively saving us boilerplate code that may or may not end up accounting for every feature in our dataframes.",{"type":16,"tag":28,"props":4379,"children":4380},{},[4381],{"type":22,"value":4382},"Ibis is a very cool project, especially if your SQL skills as basic as mine, so I highly encourage you to check it out. :)",{"type":16,"tag":1045,"props":4384,"children":4387},{"code":4385,"meta":4386},"import ibis\nfrom pathlib import Path\n","{python",[4388],{"type":16,"tag":1052,"props":4389,"children":4390},{"__ignoreMap":10},[4391],{"type":22,"value":4385},{"type":16,"tag":1045,"props":4393,"children":4395},{"code":4394,"meta":10},"data_path = Path().cwd().parent/\"data/\"\n",[4396],{"type":16,"tag":1052,"props":4397,"children":4398},{"__ignoreMap":10},[4399],{"type":22,"value":4394},{"type":16,"tag":1045,"props":4401,"children":4403},{"code":4402,"meta":10},"def create_db(path_in, path_out, file_name, table_name):\n    path = Path(path_out)\n    conn = ibis.duckdb.connect(path.joinpath(file_name))\n    conn.register(path_in, table_name=table_name)\n    print(f\"Successfully loaded the {table_name} table!\")\n",[4404],{"type":16,"tag":1052,"props":4405,"children":4406},{"__ignoreMap":10},[4407],{"type":22,"value":4402},{"type":16,"tag":1045,"props":4409,"children":4411},{"code":4410,"meta":10},"create_db(\n    path_in=data_path.joinpath(\"porto\", \"bike_sharing_hourly.parquet\"),\n    path_out=\"../data/dwarehouse\",\n    file_name=\"mytest_dw.ddb\",\n    table_name=\"one_day\"\n)\n",[4412],{"type":16,"tag":1052,"props":4413,"children":4414},{"__ignoreMap":10},[4415],{"type":22,"value":4410},{"type":16,"tag":28,"props":4417,"children":4418},{},[4419],{"type":22,"value":4420},"Let's read in our data to check that it was loaded successfully.",{"type":16,"tag":1045,"props":4422,"children":4424},{"code":4423,"meta":10},"import duckdb\n",[4425],{"type":16,"tag":1052,"props":4426,"children":4427},{"__ignoreMap":10},[4428],{"type":22,"value":4423},{"type":16,"tag":1045,"props":4430,"children":4432},{"code":4431,"meta":10},"duck = duckdb.connect(\"../data/dwarehouse/mytest_dw.ddb\")\nduck.query(\"SELECT * FROM one_day\").df().head()\n",[4433],{"type":16,"tag":1052,"props":4434,"children":4435},{"__ignoreMap":10},[4436],{"type":22,"value":4431},{"type":16,"tag":1045,"props":4438,"children":4440},{"code":4439,"meta":10},"def create_parquet(path_in, path_out, file_name):\n    path = Path(path_out)\n    pd.read_parquet(path_in).to_parquet(path.joinpath(file_name))\n    print(f\"Successfully loaded the {file_name} table!\")\n",[4441],{"type":16,"tag":1052,"props":4442,"children":4443},{"__ignoreMap":10},[4444],{"type":22,"value":4439},{"type":16,"tag":1045,"props":4446,"children":4448},{"code":4447,"meta":10},"def save_data(data, path_out, file_name):\n    path_out = Path(path_out)\n    if not path_out.exists(): path_out.mkdir(parents=True)\n    data.to_parquet(path_out.joinpath(file_name))\n    print(f\"Successfully loaded the {file_name} table!\")\n",[4449],{"type":16,"tag":1052,"props":4450,"children":4451},{"__ignoreMap":10},[4452],{"type":22,"value":4447},{"type":16,"tag":28,"props":4454,"children":4455},{},[4456,4458,4463],{"type":22,"value":4457},"We take the same steps as before and wrap our main function with ",{"type":16,"tag":1052,"props":4459,"children":4461},{"className":4460},[],[4462],{"type":22,"value":2279},{"type":22,"value":4464}," to make it a CLI, we test that it works well, and then go on to the next stage.",{"type":16,"tag":1045,"props":4466,"children":4468},{"code":4467,"meta":10},"%%writefile ../src/data_eng/load.py\n\nfrom pathlib import Path\nimport ibis\nimport typer\nfrom typing import Optional\nimport pandas as pd\n\n\ndef create_db(path_in, path_out, file_name, table_name):\n    path = Path(path_out)\n    conn = ibis.duckdb.connect(path.joinpath(file_name))\n    conn.register(path_in, table_name=table_name)\n    print(f\"Successfully loaded the {table_name} table!\")\n\ndef create_parquet(path_in, path_out, file_name):\n    path = Path(path_out)\n    pd.read_parquet(path_in).to_parquet(path.joinpath(file_name))\n    print(f\"Successfully loaded the {file_name} table!\")\n\ndef save_data(data, path_out, file_name):\n    path_out = Path(path_out)\n    if not path_out.exists(): path_out.mkdir(parents=True)\n    data.to_parquet(path_out.joinpath(file_name))\n    print(f\"Successfully loaded the {file_name} table!\")\n\n\ndef main(\n    kind: str = typer.Option(...),\n    path_in: Optional[str] = typer.Option(None), \n    path_out: Optional[str] = typer.Option(None),\n    file_name: Optional[str] = typer.Option(None),\n    table_name: Optional[str] = typer.Option(None)\n):\n    if kind == \"db\":\n        create_db(path_in, path_out, file_name, table_name)\n    elif kind == \"pq\":\n        create_parquet(path_in, path_out, file_name)\n    else:\n        print(f\"Could not understand argument {kind}. Please use 'pq' for parquet files or 'db' for database.\")\n\n    print(\"Data Extracted Successfully!\")\n\nif __name__ == \"__main__\":\n    typer.run(main)\n",[4469],{"type":16,"tag":1052,"props":4470,"children":4471},{"__ignoreMap":10},[4472],{"type":22,"value":4467},{"type":16,"tag":58,"props":4474,"children":4476},{"id":4475},"_7-reproducible-pipelines",[4477],{"type":22,"value":4478},"7. Reproducible Pipelines",{"type":16,"tag":28,"props":4480,"children":4481},{},[4482,4484,4489],{"type":22,"value":4483},"Data Version Control or ",{"type":16,"tag":1052,"props":4485,"children":4487},{"className":4486},[],[4488],{"type":22,"value":816},{"type":22,"value":4490}," is a tool for version almost any kind of file you can think of. From images, text, videos, and excel spreadsheets, to machine learning models and other artifacts. In addition, it is also an excellent tool for tracking machine learning experiments and for creating language agnostic pipelines where you can automatically version control the inputs and outputs of your workflows.",{"type":16,"tag":28,"props":4492,"children":4493},{},[4494],{"type":22,"value":4495},"If you have ever used git then the following commands will feel like home",{"type":16,"tag":124,"props":4497,"children":4498},{},[4499,4510,4521,4532,4543,4554,4573,4584],{"type":16,"tag":69,"props":4500,"children":4501},{},[4502,4508],{"type":16,"tag":1052,"props":4503,"children":4505},{"className":4504},[],[4506],{"type":22,"value":4507},"dvc init",{"type":22,"value":4509}," --> this the first step to get started using dvc (after installing it of course)",{"type":16,"tag":69,"props":4511,"children":4512},{},[4513,4519],{"type":16,"tag":1052,"props":4514,"children":4516},{"className":4515},[],[4517],{"type":22,"value":4518},"dvc remote add -d storage gdrive://your_hash",{"type":22,"value":4520}," --> since we will be tracking files somewhere, this command will help set up a remote repository for these.",{"type":16,"tag":69,"props":4522,"children":4523},{},[4524,4530],{"type":16,"tag":1052,"props":4525,"children":4527},{"className":4526},[],[4528],{"type":22,"value":4529},"dvc add",{"type":22,"value":4531}," --> add a file to track.",{"type":16,"tag":69,"props":4533,"children":4534},{},[4535,4541],{"type":16,"tag":1052,"props":4536,"children":4538},{"className":4537},[],[4539],{"type":22,"value":4540},"dvc push",{"type":22,"value":4542}," --> push the file to your remote repository.",{"type":16,"tag":69,"props":4544,"children":4545},{},[4546,4552],{"type":16,"tag":1052,"props":4547,"children":4549},{"className":4548},[],[4550],{"type":22,"value":4551},"dvc pull",{"type":22,"value":4553}," --> pull the file from your remote repository and into your local machine.",{"type":16,"tag":69,"props":4555,"children":4556},{},[4557,4563,4565,4571],{"type":16,"tag":1052,"props":4558,"children":4560},{"className":4559},[],[4561],{"type":22,"value":4562},"dvc stage",{"type":22,"value":4564}," --> allows you to start adding steps to a pipeline. It will create a ",{"type":16,"tag":1052,"props":4566,"children":4568},{"className":4567},[],[4569],{"type":22,"value":4570},"dvc.yml",{"type":22,"value":4572}," file containing the steps of the pipeline. This can be modified manually as well.",{"type":16,"tag":69,"props":4574,"children":4575},{},[4576,4582],{"type":16,"tag":1052,"props":4577,"children":4579},{"className":4578},[],[4580],{"type":22,"value":4581},"dvc repro",{"type":22,"value":4583}," --> Once we finish our stage, or as we add steps to it, we can run our pipeline with this command. The best part is that the steps will get cashed, so if nothing changes, nothing will get rerun.",{"type":16,"tag":69,"props":4585,"children":4586},{},[4587,4593],{"type":16,"tag":1052,"props":4588,"children":4590},{"className":4589},[],[4591],{"type":22,"value":4592},"dvc dag",{"type":22,"value":4594}," --> allows you to visualize your pipelines as a graph in the terminal.",{"type":16,"tag":28,"props":4596,"children":4597},{},[4598,4600,4606],{"type":22,"value":4599},"Finally, some of the settings for our repo will be available at ",{"type":16,"tag":1052,"props":4601,"children":4603},{"className":4602},[],[4604],{"type":22,"value":4605},".dvc/config",{"type":22,"value":4607}," and these can be changed manually at any time.",{"type":16,"tag":28,"props":4609,"children":4610},{},[4611],{"type":22,"value":4612},"Open a terminal in the main directory for this workshop and follow along.",{"type":16,"tag":28,"props":4614,"children":4615},{},[4616],{"type":22,"value":4617},"To create our pipeline, we'll add the stages step by step.",{"type":16,"tag":1045,"props":4619,"children":4623},{"code":4620,"language":4621,"meta":10,"className":4622,"style":10},"dvc stage add --name seoul_extract \\\n    --deps data/seoul/SeoulBikeData.csv \\\n    --outs data/seoul/raw/seoul_raw.parquet \\\n    python src/data_eng/extract.py --arg csv \\\n        --path-in data/seoul/SeoulBikeData.csv \\\n        --path-out data/seoul/raw \\\n        --file-name seoul_raw.parquet --encoding iso-8859-1\n","sh","language-sh shiki shiki-themes github-dark github-light",[4624],{"type":16,"tag":1052,"props":4625,"children":4626},{"__ignoreMap":10},[4627,4662,4679,4696,4723,4739,4756],{"type":16,"tag":1056,"props":4628,"children":4629},{"class":1058,"line":1059},[4630,4635,4641,4646,4652,4657],{"type":16,"tag":1056,"props":4631,"children":4633},{"style":4632},"--shiki-dark:#B392F0;--shiki-default:#6F42C1",[4634],{"type":22,"value":816},{"type":16,"tag":1056,"props":4636,"children":4638},{"style":4637},"--shiki-dark:#9ECBFF;--shiki-default:#032F62",[4639],{"type":22,"value":4640}," stage",{"type":16,"tag":1056,"props":4642,"children":4643},{"style":4637},[4644],{"type":22,"value":4645}," add",{"type":16,"tag":1056,"props":4647,"children":4649},{"style":4648},"--shiki-dark:#79B8FF;--shiki-default:#005CC5",[4650],{"type":22,"value":4651}," --name",{"type":16,"tag":1056,"props":4653,"children":4654},{"style":4637},[4655],{"type":22,"value":4656}," seoul_extract",{"type":16,"tag":1056,"props":4658,"children":4659},{"style":4648},[4660],{"type":22,"value":4661}," \\\n",{"type":16,"tag":1056,"props":4663,"children":4664},{"class":1058,"line":1068},[4665,4670,4675],{"type":16,"tag":1056,"props":4666,"children":4667},{"style":4648},[4668],{"type":22,"value":4669},"    --deps",{"type":16,"tag":1056,"props":4671,"children":4672},{"style":4637},[4673],{"type":22,"value":4674}," data/seoul/SeoulBikeData.csv",{"type":16,"tag":1056,"props":4676,"children":4677},{"style":4648},[4678],{"type":22,"value":4661},{"type":16,"tag":1056,"props":4680,"children":4681},{"class":1058,"line":1269},[4682,4687,4692],{"type":16,"tag":1056,"props":4683,"children":4684},{"style":4648},[4685],{"type":22,"value":4686},"    --outs",{"type":16,"tag":1056,"props":4688,"children":4689},{"style":4637},[4690],{"type":22,"value":4691}," data/seoul/raw/seoul_raw.parquet",{"type":16,"tag":1056,"props":4693,"children":4694},{"style":4648},[4695],{"type":22,"value":4661},{"type":16,"tag":1056,"props":4697,"children":4698},{"class":1058,"line":1278},[4699,4704,4709,4714,4719],{"type":16,"tag":1056,"props":4700,"children":4701},{"style":4637},[4702],{"type":22,"value":4703},"    python",{"type":16,"tag":1056,"props":4705,"children":4706},{"style":4637},[4707],{"type":22,"value":4708}," src/data_eng/extract.py",{"type":16,"tag":1056,"props":4710,"children":4711},{"style":4648},[4712],{"type":22,"value":4713}," --arg",{"type":16,"tag":1056,"props":4715,"children":4716},{"style":4637},[4717],{"type":22,"value":4718}," csv",{"type":16,"tag":1056,"props":4720,"children":4721},{"style":4648},[4722],{"type":22,"value":4661},{"type":16,"tag":1056,"props":4724,"children":4725},{"class":1058,"line":1429},[4726,4731,4735],{"type":16,"tag":1056,"props":4727,"children":4728},{"style":4648},[4729],{"type":22,"value":4730},"        --path-in",{"type":16,"tag":1056,"props":4732,"children":4733},{"style":4637},[4734],{"type":22,"value":4674},{"type":16,"tag":1056,"props":4736,"children":4737},{"style":4648},[4738],{"type":22,"value":4661},{"type":16,"tag":1056,"props":4740,"children":4741},{"class":1058,"line":1509},[4742,4747,4752],{"type":16,"tag":1056,"props":4743,"children":4744},{"style":4648},[4745],{"type":22,"value":4746},"        --path-out",{"type":16,"tag":1056,"props":4748,"children":4749},{"style":4637},[4750],{"type":22,"value":4751}," data/seoul/raw",{"type":16,"tag":1056,"props":4753,"children":4754},{"style":4648},[4755],{"type":22,"value":4661},{"type":16,"tag":1056,"props":4757,"children":4758},{"class":1058,"line":1633},[4759,4764,4769,4774],{"type":16,"tag":1056,"props":4760,"children":4761},{"style":4648},[4762],{"type":22,"value":4763},"        --file-name",{"type":16,"tag":1056,"props":4765,"children":4766},{"style":4637},[4767],{"type":22,"value":4768}," seoul_raw.parquet",{"type":16,"tag":1056,"props":4770,"children":4771},{"style":4648},[4772],{"type":22,"value":4773}," --encoding",{"type":16,"tag":1056,"props":4775,"children":4776},{"style":4637},[4777],{"type":22,"value":4778}," iso-8859-1\n",{"type":16,"tag":1045,"props":4780,"children":4784},{"code":4781,"language":4782,"meta":10,"className":4783,"style":10},"dvc stage add --name seoul_transform \\\n    --deps data/seoul/raw/seoul_raw.parquet \\\n    --outs data/seoul/interim/seoul_clean.parquet \\\n    python src/data_eng/transform.py \\\n        --path-in data/seoul/seoul_raw.parquet \\\n        --date-col Date --hour-col Hour --place Seoul \\\n        --path-out data/seoul/interim --file-name seoul_clean.parquet\n","bash","language-bash shiki shiki-themes github-dark github-light",[4785],{"type":16,"tag":1052,"props":4786,"children":4787},{"__ignoreMap":10},[4788,4816,4831,4847,4863,4879,4916],{"type":16,"tag":1056,"props":4789,"children":4790},{"class":1058,"line":1059},[4791,4795,4799,4803,4807,4812],{"type":16,"tag":1056,"props":4792,"children":4793},{"style":4632},[4794],{"type":22,"value":816},{"type":16,"tag":1056,"props":4796,"children":4797},{"style":4637},[4798],{"type":22,"value":4640},{"type":16,"tag":1056,"props":4800,"children":4801},{"style":4637},[4802],{"type":22,"value":4645},{"type":16,"tag":1056,"props":4804,"children":4805},{"style":4648},[4806],{"type":22,"value":4651},{"type":16,"tag":1056,"props":4808,"children":4809},{"style":4637},[4810],{"type":22,"value":4811}," seoul_transform",{"type":16,"tag":1056,"props":4813,"children":4814},{"style":4648},[4815],{"type":22,"value":4661},{"type":16,"tag":1056,"props":4817,"children":4818},{"class":1058,"line":1068},[4819,4823,4827],{"type":16,"tag":1056,"props":4820,"children":4821},{"style":4648},[4822],{"type":22,"value":4669},{"type":16,"tag":1056,"props":4824,"children":4825},{"style":4637},[4826],{"type":22,"value":4691},{"type":16,"tag":1056,"props":4828,"children":4829},{"style":4648},[4830],{"type":22,"value":4661},{"type":16,"tag":1056,"props":4832,"children":4833},{"class":1058,"line":1269},[4834,4838,4843],{"type":16,"tag":1056,"props":4835,"children":4836},{"style":4648},[4837],{"type":22,"value":4686},{"type":16,"tag":1056,"props":4839,"children":4840},{"style":4637},[4841],{"type":22,"value":4842}," data/seoul/interim/seoul_clean.parquet",{"type":16,"tag":1056,"props":4844,"children":4845},{"style":4648},[4846],{"type":22,"value":4661},{"type":16,"tag":1056,"props":4848,"children":4849},{"class":1058,"line":1278},[4850,4854,4859],{"type":16,"tag":1056,"props":4851,"children":4852},{"style":4637},[4853],{"type":22,"value":4703},{"type":16,"tag":1056,"props":4855,"children":4856},{"style":4637},[4857],{"type":22,"value":4858}," src/data_eng/transform.py",{"type":16,"tag":1056,"props":4860,"children":4861},{"style":4648},[4862],{"type":22,"value":4661},{"type":16,"tag":1056,"props":4864,"children":4865},{"class":1058,"line":1429},[4866,4870,4875],{"type":16,"tag":1056,"props":4867,"children":4868},{"style":4648},[4869],{"type":22,"value":4730},{"type":16,"tag":1056,"props":4871,"children":4872},{"style":4637},[4873],{"type":22,"value":4874}," data/seoul/seoul_raw.parquet",{"type":16,"tag":1056,"props":4876,"children":4877},{"style":4648},[4878],{"type":22,"value":4661},{"type":16,"tag":1056,"props":4880,"children":4881},{"class":1058,"line":1509},[4882,4887,4892,4897,4902,4907,4912],{"type":16,"tag":1056,"props":4883,"children":4884},{"style":4648},[4885],{"type":22,"value":4886},"        --date-col",{"type":16,"tag":1056,"props":4888,"children":4889},{"style":4637},[4890],{"type":22,"value":4891}," Date",{"type":16,"tag":1056,"props":4893,"children":4894},{"style":4648},[4895],{"type":22,"value":4896}," --hour-col",{"type":16,"tag":1056,"props":4898,"children":4899},{"style":4637},[4900],{"type":22,"value":4901}," Hour",{"type":16,"tag":1056,"props":4903,"children":4904},{"style":4648},[4905],{"type":22,"value":4906}," --place",{"type":16,"tag":1056,"props":4908,"children":4909},{"style":4637},[4910],{"type":22,"value":4911}," Seoul",{"type":16,"tag":1056,"props":4913,"children":4914},{"style":4648},[4915],{"type":22,"value":4661},{"type":16,"tag":1056,"props":4917,"children":4918},{"class":1058,"line":1633},[4919,4923,4928,4933],{"type":16,"tag":1056,"props":4920,"children":4921},{"style":4648},[4922],{"type":22,"value":4746},{"type":16,"tag":1056,"props":4924,"children":4925},{"style":4637},[4926],{"type":22,"value":4927}," data/seoul/interim",{"type":16,"tag":1056,"props":4929,"children":4930},{"style":4648},[4931],{"type":22,"value":4932}," --file-name",{"type":16,"tag":1056,"props":4934,"children":4935},{"style":4637},[4936],{"type":22,"value":4937}," seoul_clean.parquet\n",{"type":16,"tag":1565,"props":4939,"children":4941},{"id":4940},"exercise-1",[4942],{"type":22,"value":3657},{"type":16,"tag":28,"props":4944,"children":4945},{},[4946],{"type":22,"value":4947},"Add the load stage into our pipeline following the examples above.",{"type":16,"tag":1045,"props":4949,"children":4951},{"code":4950,"language":4782,"meta":10,"className":4783,"style":10},"dvc stage add --name seoul_load \\\n    --deps data/seoul/interim/seoul_clean.parquet \\\n    --outs data/dwarehouse/analytics.db \\\n    python src/data_eng/load.py --kind db \\\n        --path-in data/seoul/interim/seoul_clean.parquet \\\n        --path-out data/dwarehouse --name analytics.db \\\n        --table-name seoul_main\n",[4952],{"type":16,"tag":1052,"props":4953,"children":4954},{"__ignoreMap":10},[4955,4983,4998,5014,5040,5055,5080],{"type":16,"tag":1056,"props":4956,"children":4957},{"class":1058,"line":1059},[4958,4962,4966,4970,4974,4979],{"type":16,"tag":1056,"props":4959,"children":4960},{"style":4632},[4961],{"type":22,"value":816},{"type":16,"tag":1056,"props":4963,"children":4964},{"style":4637},[4965],{"type":22,"value":4640},{"type":16,"tag":1056,"props":4967,"children":4968},{"style":4637},[4969],{"type":22,"value":4645},{"type":16,"tag":1056,"props":4971,"children":4972},{"style":4648},[4973],{"type":22,"value":4651},{"type":16,"tag":1056,"props":4975,"children":4976},{"style":4637},[4977],{"type":22,"value":4978}," seoul_load",{"type":16,"tag":1056,"props":4980,"children":4981},{"style":4648},[4982],{"type":22,"value":4661},{"type":16,"tag":1056,"props":4984,"children":4985},{"class":1058,"line":1068},[4986,4990,4994],{"type":16,"tag":1056,"props":4987,"children":4988},{"style":4648},[4989],{"type":22,"value":4669},{"type":16,"tag":1056,"props":4991,"children":4992},{"style":4637},[4993],{"type":22,"value":4842},{"type":16,"tag":1056,"props":4995,"children":4996},{"style":4648},[4997],{"type":22,"value":4661},{"type":16,"tag":1056,"props":4999,"children":5000},{"class":1058,"line":1269},[5001,5005,5010],{"type":16,"tag":1056,"props":5002,"children":5003},{"style":4648},[5004],{"type":22,"value":4686},{"type":16,"tag":1056,"props":5006,"children":5007},{"style":4637},[5008],{"type":22,"value":5009}," data/dwarehouse/analytics.db",{"type":16,"tag":1056,"props":5011,"children":5012},{"style":4648},[5013],{"type":22,"value":4661},{"type":16,"tag":1056,"props":5015,"children":5016},{"class":1058,"line":1278},[5017,5021,5026,5031,5036],{"type":16,"tag":1056,"props":5018,"children":5019},{"style":4637},[5020],{"type":22,"value":4703},{"type":16,"tag":1056,"props":5022,"children":5023},{"style":4637},[5024],{"type":22,"value":5025}," src/data_eng/load.py",{"type":16,"tag":1056,"props":5027,"children":5028},{"style":4648},[5029],{"type":22,"value":5030}," --kind",{"type":16,"tag":1056,"props":5032,"children":5033},{"style":4637},[5034],{"type":22,"value":5035}," db",{"type":16,"tag":1056,"props":5037,"children":5038},{"style":4648},[5039],{"type":22,"value":4661},{"type":16,"tag":1056,"props":5041,"children":5042},{"class":1058,"line":1429},[5043,5047,5051],{"type":16,"tag":1056,"props":5044,"children":5045},{"style":4648},[5046],{"type":22,"value":4730},{"type":16,"tag":1056,"props":5048,"children":5049},{"style":4637},[5050],{"type":22,"value":4842},{"type":16,"tag":1056,"props":5052,"children":5053},{"style":4648},[5054],{"type":22,"value":4661},{"type":16,"tag":1056,"props":5056,"children":5057},{"class":1058,"line":1509},[5058,5062,5067,5071,5076],{"type":16,"tag":1056,"props":5059,"children":5060},{"style":4648},[5061],{"type":22,"value":4746},{"type":16,"tag":1056,"props":5063,"children":5064},{"style":4637},[5065],{"type":22,"value":5066}," data/dwarehouse",{"type":16,"tag":1056,"props":5068,"children":5069},{"style":4648},[5070],{"type":22,"value":4651},{"type":16,"tag":1056,"props":5072,"children":5073},{"style":4637},[5074],{"type":22,"value":5075}," analytics.db",{"type":16,"tag":1056,"props":5077,"children":5078},{"style":4648},[5079],{"type":22,"value":4661},{"type":16,"tag":1056,"props":5081,"children":5082},{"class":1058,"line":1633},[5083,5088],{"type":16,"tag":1056,"props":5084,"children":5085},{"style":4648},[5086],{"type":22,"value":5087},"        --table-name",{"type":16,"tag":1056,"props":5089,"children":5090},{"style":4637},[5091],{"type":22,"value":5092}," seoul_main\n",{"type":16,"tag":28,"props":5094,"children":5095},{},[5096],{"type":22,"value":5097},"Finally we can run our pipeline, evaluate it, and push our files into our remote storage.",{"type":16,"tag":1045,"props":5099,"children":5101},{"code":5100,"language":4621,"meta":10,"className":4622,"style":10},"# 1\ndvc repro\n\n# 2\ndvc dag\n\n# 3\ndvc push\n",[5102],{"type":16,"tag":1052,"props":5103,"children":5104},{"__ignoreMap":10},[5105,5114,5126,5133,5141,5153,5160,5168],{"type":16,"tag":1056,"props":5106,"children":5107},{"class":1058,"line":1059},[5108],{"type":16,"tag":1056,"props":5109,"children":5111},{"style":5110},"--shiki-dark:#6A737D;--shiki-default:#6A737D",[5112],{"type":22,"value":5113},"# 1\n",{"type":16,"tag":1056,"props":5115,"children":5116},{"class":1058,"line":1068},[5117,5121],{"type":16,"tag":1056,"props":5118,"children":5119},{"style":4632},[5120],{"type":22,"value":816},{"type":16,"tag":1056,"props":5122,"children":5123},{"style":4637},[5124],{"type":22,"value":5125}," repro\n",{"type":16,"tag":1056,"props":5127,"children":5128},{"class":1058,"line":1269},[5129],{"type":16,"tag":1056,"props":5130,"children":5131},{"emptyLinePlaceholder":2302},[5132],{"type":22,"value":2305},{"type":16,"tag":1056,"props":5134,"children":5135},{"class":1058,"line":1278},[5136],{"type":16,"tag":1056,"props":5137,"children":5138},{"style":5110},[5139],{"type":22,"value":5140},"# 2\n",{"type":16,"tag":1056,"props":5142,"children":5143},{"class":1058,"line":1429},[5144,5148],{"type":16,"tag":1056,"props":5145,"children":5146},{"style":4632},[5147],{"type":22,"value":816},{"type":16,"tag":1056,"props":5149,"children":5150},{"style":4637},[5151],{"type":22,"value":5152}," dag\n",{"type":16,"tag":1056,"props":5154,"children":5155},{"class":1058,"line":1509},[5156],{"type":16,"tag":1056,"props":5157,"children":5158},{"emptyLinePlaceholder":2302},[5159],{"type":22,"value":2305},{"type":16,"tag":1056,"props":5161,"children":5162},{"class":1058,"line":1633},[5163],{"type":16,"tag":1056,"props":5164,"children":5165},{"style":5110},[5166],{"type":22,"value":5167},"# 3\n",{"type":16,"tag":1056,"props":5169,"children":5170},{"class":1058,"line":1642},[5171,5175],{"type":16,"tag":1056,"props":5172,"children":5173},{"style":4632},[5174],{"type":22,"value":816},{"type":16,"tag":1056,"props":5176,"children":5177},{"style":4637},[5178],{"type":22,"value":5179}," push\n",{"type":16,"tag":28,"props":5181,"children":5182},{},[5183],{"type":22,"value":5184},"Afterwards, dvc will provide us with git files to track for our project.",{"type":16,"tag":58,"props":5186,"children":5188},{"id":5187},"_8-scheduling",[5189],{"type":22,"value":5190},"8. Scheduling",{"type":16,"tag":28,"props":5192,"children":5193},{},[5194],{"type":22,"value":5195},"Scheduling our workflows can be super convenient and time-savior when we know we need to run tasks repeatedly. A very common tool for the task is cron, and here is an excellent tutorial to get started with it.",{"type":16,"tag":28,"props":5197,"children":5198},{},[5199],{"type":22,"value":5200},"Note: Windows users would need to use Windows Subsystem for Linux to use cron or some other tool, potentially in PowerShell.",{"type":16,"tag":1045,"props":5202,"children":5204},{"code":5203,"meta":10},"from IPython.display import HTML\nHTML(\"\"\"\n\u003Cdiv align=\"center\">\n    \u003Ciframe width=\"700\" height=\"450\"\n    src=\"https://www.youtube.com/embed/QZJ1drMQz1A\"\n    title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; \n    clipboard-write; encrypted-media; gyroscope; picture-in-picture; \n    web-share\" allowfullscreen>\n    \u003C/iframe>\n\u003C/div>\n\"\"\")\n",[5205],{"type":16,"tag":1052,"props":5206,"children":5207},{"__ignoreMap":10},[5208],{"type":22,"value":5203},{"type":16,"tag":58,"props":5210,"children":5212},{"id":5211},"_9-exercises",[5213],{"type":22,"value":5214},"9. Exercises",{"type":16,"tag":1565,"props":5216,"children":5218},{"id":5217},"exercise-1-1",[5219],{"type":22,"value":5220},"Exercise 1",{"type":16,"tag":65,"props":5222,"children":5223},{},[5224,5237,5242],{"type":16,"tag":69,"props":5225,"children":5226},{},[5227,5229,5235],{"type":22,"value":5228},"Open the terminal, create a new directory named ",{"type":16,"tag":1052,"props":5230,"children":5232},{"className":5231},[],[5233],{"type":22,"value":5234},"dc_bikes",{"type":22,"value":5236},", and cd into it.",{"type":16,"tag":69,"props":5238,"children":5239},{},[5240],{"type":22,"value":5241},"Create two subdirectories, data and src.",{"type":16,"tag":69,"props":5243,"children":5244},{},[5245],{"type":22,"value":5246},"Create an ETL pipeline with two functions in the transform step.",{"type":16,"tag":1565,"props":5248,"children":5250},{"id":5249},"exercise-2",[5251],{"type":22,"value":5252},"Exercise 2",{"type":16,"tag":65,"props":5254,"children":5255},{},[5256,5261,5266,5271],{"type":16,"tag":69,"props":5257,"children":5258},{},[5259],{"type":22,"value":5260},"Initialize a git and a dvc repository for the project in Exercise 1.",{"type":16,"tag":69,"props":5262,"children":5263},{},[5264],{"type":22,"value":5265},"Create a new repo in GitHub and commit your initial changes.",{"type":16,"tag":69,"props":5267,"children":5268},{},[5269],{"type":22,"value":5270},"Create a dvc pipeline with your three stages.",{"type":16,"tag":69,"props":5272,"children":5273},{},[5274],{"type":22,"value":5275},"Commit your changes.",{"type":16,"tag":58,"props":5277,"children":5279},{"id":5278},"_10-resources",[5280],{"type":22,"value":5281},"10. Resources",{"type":16,"tag":28,"props":5283,"children":5284},{},[5285],{"type":22,"value":5286},"If you'd like to expand your knowledge around the tools and concepts that we covered in this lesson, you might find the following list of resources helpful.",{"type":16,"tag":124,"props":5288,"children":5289},{},[5290,5302,5314,5326,5338,5350],{"type":16,"tag":69,"props":5291,"children":5292},{},[5293,5295],{"type":22,"value":5294},"To learn more about pandas --> ",{"type":16,"tag":49,"props":5296,"children":5299},{"href":5297,"rel":5298},"https://wesmckinney.com/book/",[53],[5300],{"type":22,"value":5301},"Python for Data Analysis, 3E by Wes McKinney",{"type":16,"tag":69,"props":5303,"children":5304},{},[5305,5307],{"type":22,"value":5306},"To learn more about ibis --> ",{"type":16,"tag":49,"props":5308,"children":5311},{"href":5309,"rel":5310},"https://ibis-project.org/blog/ibis_substrait_to_duckdb/",[53],[5312],{"type":22,"value":5313},"Ibis + Substrait + DuckDB by Gil Forsyth",{"type":16,"tag":69,"props":5315,"children":5316},{},[5317,5319],{"type":22,"value":5318},"To learn more about duckdb --> ",{"type":16,"tag":49,"props":5320,"children":5323},{"href":5321,"rel":5322},"https://www.youtube.com/watch?v=AjsB6lM2-zw&ab_channel=DatawithMarc",[53],[5324],{"type":22,"value":5325},"DuckDB Tutorial by Data with Marc",{"type":16,"tag":69,"props":5327,"children":5328},{},[5329,5331],{"type":22,"value":5330},"To learn more about dvc --> ",{"type":16,"tag":49,"props":5332,"children":5335},{"href":5333,"rel":5334},"https://towardsdev.com/ml-pipeline-decoupled-i-managed-to-write-a-framework-agnostic-ml-pipeline-with-dvc-rust-python-287de68104c9",[53],[5336],{"type":22,"value":5337},"ML Pipeline Decoupled: I managed to Write a Framework Agnostic ML Pipeline with DVC, Rust & Python",{"type":16,"tag":69,"props":5339,"children":5340},{},[5341,5343],{"type":22,"value":5342},"To learn more about typer --> ",{"type":16,"tag":49,"props":5344,"children":5347},{"href":5345,"rel":5346},"https://towardsdatascience.com/data-and-machine-learning-model-versioning-with-dvc-34fdadd06b15",[53],[5348],{"type":22,"value":5349},"Data and Machine Learning Model Versioning with DVC by Ruben Winastwan",{"type":16,"tag":69,"props":5351,"children":5352},{},[5353,5355],{"type":22,"value":5354},"To learn more about cron --> ",{"type":16,"tag":49,"props":5356,"children":5359},{"href":5357,"rel":5358},"https://www.hostinger.com/tutorials/cron-job",[53],[5360],{"type":22,"value":5361},"Cron Job: A Comprehensive Guide for Beginners 2023 by Linas L.",{"type":16,"tag":5363,"props":5364,"children":5365},"style",{},[5366],{"type":22,"value":5367},"html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}",{"title":10,"searchDepth":1068,"depth":1068,"links":5369},[5370,5371,5372,5373,5374,5375,5376,5383,5386,5387,5391],{"id":60,"depth":1068,"text":63},{"id":185,"depth":1068,"text":188},{"id":249,"depth":1068,"text":252},{"id":288,"depth":1068,"text":291},{"id":783,"depth":1068,"text":786},{"id":862,"depth":1068,"text":865},{"id":1518,"depth":1068,"text":1521,"children":5377},[5378,5379,5380,5381,5382],{"id":1567,"depth":1269,"text":1570},{"id":1651,"depth":1269,"text":1654},{"id":3064,"depth":1269,"text":3067},{"id":3654,"depth":1269,"text":3657},{"id":4357,"depth":1269,"text":4360},{"id":4475,"depth":1068,"text":4478,"children":5384},[5385],{"id":4940,"depth":1269,"text":3657},{"id":5187,"depth":1068,"text":5190},{"id":5211,"depth":1068,"text":5214,"children":5388},[5389,5390],{"id":5217,"depth":1269,"text":5220},{"id":5249,"depth":1269,"text":5252},{"id":5278,"depth":1068,"text":5281},"markdown","content:3.data-engineering:1.data_pipelines_getting_started.md","content","3.data-engineering/1.data_pipelines_getting_started.md","md","default",["ShallowRef",5399],["ShallowReactive",5400],{"/data-engineering/data_pipelines_getting_started":5401},[5402,5408],{"_path":5403,"_dir":5404,"_draft":9,"_partial":9,"_locale":10,"title":5405,"description":10,"_type":5392,"_id":5406,"_source":5394,"_file":5407,"_extension":5396},"/analytics/eda","analytics","Exploratory Data Analysis","content:2.analytics:6.eda.md","2.analytics/6.eda.md",{"_path":5409,"_dir":8,"_draft":9,"_partial":9,"_locale":10,"title":5410,"description":10,"_type":5392,"_id":5411,"_source":5394,"_file":5412,"_extension":5396},"/data-engineering/getting_data","Getting Data as DataFrames","content:3.data-engineering:1.getting_data.md","3.data-engineering/1.getting_data.md",["ShallowRef",5414],{},{"preference":5416,"value":5416,"unknown":2302,"forced":9},"system",[5418,5434,5448,5468,5482,5489],{"title":5419,"_path":5420,"children":5421,"icon":5433},"Set Up","/introduction",[5422,5424,5427,5430],{"title":5423,"_path":5420},"Introduction",{"title":5425,"_path":5426},"Python Installation","/introduction/python_installation",{"title":5428,"_path":5429},"Git Installation","/introduction/git_installation",{"title":5431,"_path":5432},"Jupyter Lab & Notebooks Intro","/introduction/jupyter_intro","ph:star-duotone",{"title":5435,"_path":5436,"children":5437,"icon":5447},"Programming","/programming",[5438,5440],{"title":5439,"_path":5436},"Programming Tutorials",{"title":5441,"_path":5442,"children":5443},"Terminal","/programming/terminal",[5444],{"title":5445,"_path":5446},"Intro to the Terminal","/programming/terminal/shell_intro","heroicons-outline:bookmark-alt",{"title":5449,"_path":5450,"children":5451,"icon":5467},"Analytics","/analytics",[5452,5454,5457,5460,5463,5466],{"title":5453,"_path":5450},"Data Analytics",{"title":5455,"_path":5456},"Numerical Computing","/analytics/numerical_computing",{"title":5458,"_path":5459},"Intro to pandas","/analytics/structured_data",{"title":5461,"_path":5462},"Intro to Statistics","/analytics/stats_intro",{"title":5464,"_path":5465},"Describing Data","/analytics/describing_data",{"title":5405,"_path":5403},"ri:line-chart-line",{"title":5469,"_path":5470,"children":5471,"icon":5481},"Data Engineering","/data-engineering",[5472,5473,5474,5477,5480],{"title":11,"_path":7},{"title":5410,"_path":5409},{"title":5475,"_path":5476},"Data Cleaning","/data-engineering/data_cleaning",{"title":5478,"_path":5479},"01 ETL Pipelines","/data-engineering/etl_pipes",{"title":11,"_path":7},"ri:settings-2-line",{"title":5483,"_path":5484,"children":5485,"icon":5488},"Data Science","/data-science",[5486],{"title":5487,"_path":5484},"Intro to DS","ri:magic-line",{"title":5490,"_path":5491,"children":5492,"icon":5495},"Machine Learning Engineering","/ml-engineering",[5493],{"title":5494,"_path":5491},"Intro to MLE","ri:robot-2-line",{"heroicons-outline:menu":5497,"fa-brands:github":5500,"simple-icons:nuxtdotjs":5504,"ri:arrow-right-double-fill":5506,"ph:star-duotone":5508,"lucide:chevrons-down-up":5511,"heroicons-outline:bookmark-alt":5513,"lucide:chevrons-up-down":5515,"ri:line-chart-line":5517,"ri:settings-2-line":5519,"ri:magic-line":5521,"ri:robot-2-line":5523,"uil:edit":5525,"heroicons-outline:arrow-sm-right":5527,"heroicons-outline:search":5529,"ri:arrow-right-s-line":5531,"ri:arrow-right-double-line":5533,"heroicons-outline:arrow-sm-left":5534,"heroicons-outline:chevron-right":5536,"ph:copy":5538,"ri:arrow-right-s-fill":5540},{"left":5498,"top":5498,"width":2476,"height":2476,"rotate":5498,"vFlip":9,"hFlip":9,"body":5499},0,"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 6h16M4 12h16M4 18h16\"/>",{"left":5498,"top":5498,"width":5501,"height":5502,"rotate":5498,"vFlip":9,"hFlip":9,"body":5503},496,512,"\u003Cpath fill=\"currentColor\" d=\"M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2\"/>",{"left":5498,"top":5498,"width":2476,"height":2476,"rotate":5498,"vFlip":9,"hFlip":9,"body":5505},"\u003Cpath fill=\"currentColor\" d=\"M13.464 19.83h8.922c.283 0 .562-.073.807-.21a1.6 1.6 0 0 0 .591-.574a1.53 1.53 0 0 0 .216-.783a1.53 1.53 0 0 0-.217-.782L17.792 7.414a1.6 1.6 0 0 0-.591-.573a1.65 1.65 0 0 0-.807-.21c-.283 0-.562.073-.807.21a1.6 1.6 0 0 0-.59.573L13.463 9.99L10.47 4.953a1.6 1.6 0 0 0-.591-.573a1.65 1.65 0 0 0-.807-.21c-.284 0-.562.073-.807.21a1.6 1.6 0 0 0-.591.573L.216 17.481a1.53 1.53 0 0 0-.217.782c0 .275.074.545.216.783a1.6 1.6 0 0 0 .59.574c.246.137.525.21.808.21h5.6c2.22 0 3.856-.946 4.982-2.79l2.733-4.593l1.464-2.457l4.395 7.382h-5.859Zm-6.341-2.46l-3.908-.002l5.858-9.842l2.923 4.921l-1.957 3.29c-.748 1.196-1.597 1.632-2.916 1.632\"/>",{"left":5498,"top":5498,"width":2476,"height":2476,"rotate":5498,"vFlip":9,"hFlip":9,"body":5507},"\u003Cpath fill=\"currentColor\" d=\"m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z\"/>",{"left":5498,"top":5498,"width":5509,"height":5509,"rotate":5498,"vFlip":9,"hFlip":9,"body":5510},256,"\u003Cg fill=\"currentColor\">\u003Cpath d=\"m229.06 108.79l-48.7 42l14.88 62.79a8.4 8.4 0 0 1-12.52 9.17L128 189.09l-54.72 33.65a8.4 8.4 0 0 1-12.52-9.17l14.88-62.79l-48.7-42A8.46 8.46 0 0 1 31.73 94l63.91-5.2l24.62-59.6a8.36 8.36 0 0 1 15.48 0l24.62 59.6l63.91 5.2a8.46 8.46 0 0 1 4.79 14.79\" opacity=\".2\"/>\u003Cpath d=\"M239.18 97.26A16.38 16.38 0 0 0 224.92 86l-59-4.76l-22.78-55.09a16.36 16.36 0 0 0-30.27 0L90.11 81.23L31.08 86a16.46 16.46 0 0 0-9.37 28.86l45 38.83L53 211.75a16.38 16.38 0 0 0 24.5 17.82l50.5-31.08l50.53 31.08A16.4 16.4 0 0 0 203 211.75l-13.76-58.07l45-38.83a16.43 16.43 0 0 0 4.94-17.59m-15.34 5.47l-48.7 42a8 8 0 0 0-2.56 7.91l14.88 62.8a.37.37 0 0 1-.17.48c-.18.14-.23.11-.38 0l-54.72-33.65a8 8 0 0 0-8.38 0l-54.72 33.67c-.15.09-.19.12-.38 0a.37.37 0 0 1-.17-.48l14.88-62.8a8 8 0 0 0-2.56-7.91l-48.7-42c-.12-.1-.23-.19-.13-.5s.18-.27.33-.29l63.92-5.16a8 8 0 0 0 6.72-4.94l24.62-59.61c.08-.17.11-.25.35-.25s.27.08.35.25L153 91.86a8 8 0 0 0 6.75 4.92l63.92 5.16c.15 0 .24 0 .33.29s0 .4-.16.5\"/>\u003C/g>",{"left":5498,"top":5498,"width":2476,"height":2476,"rotate":5498,"vFlip":9,"hFlip":9,"body":5512},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m7 20l5-5l5 5M7 4l5 5l5-5\"/>",{"left":5498,"top":5498,"width":2476,"height":2476,"rotate":5498,"vFlip":9,"hFlip":9,"body":5514},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M16 4v12l-4-2l-4 2V4M6 20h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2\"/>",{"left":5498,"top":5498,"width":2476,"height":2476,"rotate":5498,"vFlip":9,"hFlip":9,"body":5516},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m7 15l5 5l5-5M7 9l5-5l5 5\"/>",{"left":5498,"top":5498,"width":2476,"height":2476,"rotate":5498,"vFlip":9,"hFlip":9,"body":5518},"\u003Cpath fill=\"currentColor\" d=\"M5 3v16h16v2H3V3zm15.293 3.293l1.414 1.414L16 13.414l-3-2.999l-4.293 4.292l-1.414-1.414L13 7.586l3 2.999z\"/>",{"left":5498,"top":5498,"width":2476,"height":2476,"rotate":5498,"vFlip":9,"hFlip":9,"body":5520},"\u003Cpath fill=\"currentColor\" d=\"m8.686 4l2.607-2.607a1 1 0 0 1 1.414 0L15.314 4H19a1 1 0 0 1 1 1v3.686l2.607 2.607a1 1 0 0 1 0 1.414L20 15.314V19a1 1 0 0 1-1 1h-3.686l-2.607 2.607a1 1 0 0 1-1.414 0L8.686 20H5a1 1 0 0 1-1-1v-3.686l-2.607-2.607a1 1 0 0 1 0-1.414L4 8.686V5a1 1 0 0 1 1-1zM6 6v3.515L3.515 12L6 14.485V18h3.515L12 20.485L14.485 18H18v-3.515L20.485 12L18 9.515V6h-3.515L12 3.515L9.515 6zm6 10a4 4 0 1 1 0-8a4 4 0 0 1 0 8m0-2a2 2 0 1 0 0-4a2 2 0 0 0 0 4\"/>",{"left":5498,"top":5498,"width":2476,"height":2476,"rotate":5498,"vFlip":9,"hFlip":9,"body":5522},"\u003Cpath fill=\"currentColor\" d=\"M15.199 9.944a2.6 2.6 0 0 1-.79-1.55l-.403-3.083l-2.731 1.486a2.6 2.6 0 0 1-1.719.272L6.5 6.5l.57 3.056a2.6 2.6 0 0 1-.273 1.72l-1.486 2.73l3.083.403a2.6 2.6 0 0 1 1.55.79l2.138 2.257l1.336-2.807a2.6 2.6 0 0 1 1.23-1.231l2.808-1.336zm.025 5.564l-2.213 4.65a.6.6 0 0 1-.977.155l-3.542-3.739a.6.6 0 0 0-.358-.182l-5.106-.668a.6.6 0 0 1-.45-.881l2.462-4.524a.6.6 0 0 0 .063-.396L4.16 4.86a.6.6 0 0 1 .7-.7l5.062.943a.6.6 0 0 0 .397-.063l4.523-2.46a.6.6 0 0 1 .882.448l.668 5.107a.6.6 0 0 0 .182.357l3.739 3.542a.6.6 0 0 1-.155.977l-4.65 2.213a.6.6 0 0 0-.284.284m.797 1.927l1.414-1.414l4.243 4.242l-1.415 1.415z\"/>",{"left":5498,"top":5498,"width":2476,"height":2476,"rotate":5498,"vFlip":9,"hFlip":9,"body":5524},"\u003Cpath fill=\"currentColor\" d=\"M13.5 2c0 .444-.193.843-.5 1.118V5h5a3 3 0 0 1 3 3v10a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3V8a3 3 0 0 1 3-3h5V3.118A1.5 1.5 0 1 1 13.5 2M6 7a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V8a1 1 0 0 0-1-1zm-4 3H0v6h2zm20 0h2v6h-2zM9 14.5a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m6 0a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3\"/>",{"left":5498,"top":5498,"width":2476,"height":2476,"rotate":5498,"vFlip":9,"hFlip":9,"body":5526},"\u003Cpath fill=\"currentColor\" d=\"M21 12a1 1 0 0 0-1 1v6a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h6a1 1 0 0 0 0-2H5a3 3 0 0 0-3 3v14a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-6a1 1 0 0 0-1-1m-15 .76V17a1 1 0 0 0 1 1h4.24a1 1 0 0 0 .71-.29l6.92-6.93L21.71 8a1 1 0 0 0 0-1.42l-4.24-4.29a1 1 0 0 0-1.42 0l-2.82 2.83l-6.94 6.93a1 1 0 0 0-.29.71m10.76-8.35l2.83 2.83l-1.42 1.42l-2.83-2.83ZM8 13.17l5.93-5.93l2.83 2.83L10.83 16H8Z\"/>",{"left":5498,"top":5498,"width":2476,"height":2476,"rotate":5498,"vFlip":9,"hFlip":9,"body":5528},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m13 7l5 5m0 0l-5 5m5-5H6\"/>",{"left":5498,"top":5498,"width":2476,"height":2476,"rotate":5498,"vFlip":9,"hFlip":9,"body":5530},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m21 21l-6-6m2-5a7 7 0 1 1-14 0a7 7 0 0 1 14 0\"/>",{"left":5498,"top":5498,"width":2476,"height":2476,"rotate":5498,"vFlip":9,"hFlip":9,"body":5532},"\u003Cpath fill=\"currentColor\" d=\"m13.172 12l-4.95-4.95l1.414-1.413L16 12l-6.364 6.364l-1.414-1.415z\"/>",{"left":5498,"top":5498,"width":2476,"height":2476,"rotate":5498,"vFlip":9,"hFlip":9,"body":5507},{"left":5498,"top":5498,"width":2476,"height":2476,"rotate":5498,"vFlip":9,"hFlip":9,"body":5535},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m11 17l-5-5m0 0l5-5m-5 5h12\"/>",{"left":5498,"top":5498,"width":2476,"height":2476,"rotate":5498,"vFlip":9,"hFlip":9,"body":5537},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m9 5l7 7l-7 7\"/>",{"left":5498,"top":5498,"width":5509,"height":5509,"rotate":5498,"vFlip":9,"hFlip":9,"body":5539},"\u003Cpath fill=\"currentColor\" d=\"M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z\"/>",{"left":5498,"top":5498,"width":2476,"height":2476,"rotate":5498,"vFlip":9,"hFlip":9,"body":5541},"\u003Cpath fill=\"currentColor\" d=\"m16 12l-6 6V6z\"/>",{"parentPath":5470,"scrollTop":5498},{},{},{"/programming/terminal":2302},{},{},{},{},{},["Reactive",5552],["Set"],["Reactive",5554],{"search-api":5555},null,1733708749118]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{plausible:{hashMode:false,trackLocalhost:false,domain:"",apiHost:"https://plausible.io",autoPageviews:true,autoOutboundTracking:false},studio:{apiURL:"https://api.nuxt.studio",iframeMessagingAllowedOrigins:""},mdc:{components:{prose:true,map:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"}},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}}},content:{locales:[],defaultLocale:"",integrity:1733708717391,experimental:{stripQueryParameters:false,advanceQuery:false,clientDB:false},respectPathCase:false,api:{baseURL:"/api/_content"},navigation:{fields:["icon","titleTemplate","header","main","aside","footer","layout"]},tags:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},highlight:{theme:{dark:"github-dark",default:"github-light"},preload:["json","js","ts","html","css","vue","diff","shell","markdown","yaml","bash","ini"],highlighter:"shiki",langs:["js","jsx","json","ts","tsx","vue","css","html","vue","bash","md","mdc","yaml","json","js","ts","html","css","vue","diff","shell","markdown","yaml","bash","ini"]},wsUrl:"",documentDriven:{page:true,navigation:true,surround:true,globals:{},layoutFallbacks:["theme"],injectPage:true},host:"",trailingSlash:false,search:"",contentHead:true,anchorLinks:{depth:4,exclude:[1]}}},app:{baseURL:"/",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>