<!DOCTYPE html><html  lang="en"><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Architecting Intelligence</title>
<meta name="twitter:card" content="summary_large_image">
<meta name="description" content="Learn and create with all things tech-related.">
<meta property="og:description" content="Learn and create with all things tech-related.">
<meta property="og:image" content="https://user-images.githubusercontent.com/904724/185365452-87b7ca7b-6030-4813-a2db-5e65c785bf88.png">
<meta property="og:title" content="01 ETL Pipelines">
<link rel="preload" as="fetch" crossorigin="anonymous" href="/data-engineering/etl_pipes/_payload.json">
<link rel="stylesheet" href="/_nuxt/entry.B8aBeJvy.css">
<link rel="stylesheet" href="/_nuxt/DocumentDrivenNotFound.BRDfakKL.css">
<link rel="stylesheet" href="/_nuxt/ButtonLink.BcPyV5Fo.css">
<link rel="stylesheet" href="/_nuxt/DocsPageLayout.BXbIABds.css">
<link rel="stylesheet" href="/_nuxt/DocsAside.yGvrP2YV.css">
<link rel="stylesheet" href="/_nuxt/ProseCodeInline.Bril_6kD.css">
<link rel="stylesheet" href="/_nuxt/Alert.ks8StbO8.css">
<link rel="stylesheet" href="/_nuxt/DocsPageBottom.aIuXrYmW.css">
<link rel="stylesheet" href="/_nuxt/ProseA.B_9jSfDy.css">
<link rel="stylesheet" href="/_nuxt/DocsPrevNext.ByMsnGQP.css">
<link rel="stylesheet" href="/_nuxt/DocsToc.BhhHodRA.css">
<link rel="stylesheet" href="/_nuxt/DocsTocLinks.Cr8aui7G.css">
<link rel="stylesheet" href="/_nuxt/ProseH1.C1QHku3J.css">
<link rel="stylesheet" href="/_nuxt/ProseBlockquote.BVZLnJ97.css">
<link rel="stylesheet" href="/_nuxt/ProseP.JZ9aYQx9.css">
<link rel="stylesheet" href="/_nuxt/ProseImg.nadtDK_b.css">
<link rel="stylesheet" href="/_nuxt/ProseH2.DFqHnP3U.css">
<link rel="stylesheet" href="/_nuxt/ProseOl.Zw1jGp1x.css">
<link rel="stylesheet" href="/_nuxt/ProseLi.oUMq_Oay.css">
<link rel="stylesheet" href="/_nuxt/ProseStrong.kEZmG1pc.css">
<link rel="stylesheet" href="/_nuxt/ProseUl.ZPu7LyJp.css">
<link rel="stylesheet" href="/_nuxt/ProseTable.CCUS_BJ6.css">
<link rel="stylesheet" href="/_nuxt/ProseThead.CS-mbO6b.css">
<link rel="stylesheet" href="/_nuxt/ProseTr.BXIVz-Q6.css">
<link rel="stylesheet" href="/_nuxt/ProseTh.CpiIsLya.css">
<link rel="stylesheet" href="/_nuxt/ProseTd.zv8spFSr.css">
<link rel="stylesheet" href="/_nuxt/ProsePre.CchFRBtv.css">
<link rel="stylesheet" href="/_nuxt/ProseCode.hGqjIeRz.css">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CXJ2fdAB.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DnM6ckxY.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DiDlarbj.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CWMOCUTq.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/prfrliGK.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/ClqCtrfb.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/WTkegDBA.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BPr0oGOJ.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/2ETV-d1z.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DfwIlzWN.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BHloeWX3.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/RlfkODSA.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CBvHC7lm.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Cnxcs8Ow.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Bqg2AslK.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/oL9jraFH.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C4N5kdK3.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DCnPNjGU.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BpWXDgNL.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DDXj8gg1.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/HzHAgKX4.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DCOvvQA7.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BivTU8sc.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CFbYFV0i.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CgJas5qb.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BEj21w-d.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/PVy2bvTw.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BL0lifHx.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/1Io2kNHA.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Bdwhfqcg.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Bu-hPAU3.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CtkWahKB.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BhsmBU3L.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CCd6Wylz.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BRWi4D1T.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BHUhDG2m.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/RjOL6dZi.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/O82UycJE.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Wl01_9ot.js">
<link rel="prefetch" as="style" href="/_nuxt/page.Dmtwb7Hr.css">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/CWiUpT3k.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/D8gO8QcV.js">
<link rel="prefetch" as="style" href="/_nuxt/useStudio.KYzQV3Di.css">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/C6RYnNE5.js">
<link rel="prefetch" as="style" href="/_nuxt/error-404.D8uONj7L.css">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/Cjt5NVL5.js">
<link rel="prefetch" as="style" href="/_nuxt/error-500.p7T9h8Pv.css">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/D3cn8lx4.js">
<script type="module" src="/_nuxt/CXJ2fdAB.js" crossorigin></script><style id="pinceau-runtime-hydratable">@media{.phy[--]{--puid:-KoAZf-v;}.pv-Mz5Z0z{padding-left:var(--elements-container-padding-mobile);padding-right:var(--elements-container-padding-mobile);}@media (min-width: 475px){.pv-Mz5Z0z{padding-left:var(--elements-container-padding-xs);padding-right:var(--elements-container-padding-xs);}}@media (min-width: 640px){.pv-Mz5Z0z{padding-left:var(--elements-container-padding-sm);padding-right:var(--elements-container-padding-sm);}}@media (min-width: 768px){.pv-Mz5Z0z{padding-left:var(--elements-container-padding-md);padding-right:var(--elements-container-padding-md);}}} </style><style id="pinceau-theme">@media { :root {--pinceau-mq: initial; --docus-search-results-highlight-color: white;--docus-search-results-window-maxHeight: 100%;--docus-search-results-window-maxWidth: 640px;--docus-search-results-window-marginTop: 0;--docus-search-input-borderStyle: solid;--docus-search-input-borderWidth: 1px;--docus-search-backdropFilter: blur(24px);--docus-loadingBar-gradientColorStop3: #0047e1;--docus-loadingBar-gradientColorStop2: #34cdfe;--docus-loadingBar-gradientColorStop1: #00dc82;--docus-loadingBar-height: 3px;--docus-readableLine: 78ch;--docus-footer-height: 145px;--docus-header-height: 64px;--prose-code-inline-padding: 0.2rem 0.375rem 0.2rem 0.375rem;--prose-code-block-backdropFilter: contrast(1);--prose-code-block-border-style: solid;--prose-code-block-border-width: 1px;--prose-tbody-tr-borderBottom-style: dashed;--prose-tbody-tr-borderBottom-width: 1px;--prose-th-textAlign: inherit;--prose-thead-borderBottom-style: solid;--prose-thead-borderBottom-width: 1px;--prose-thead-border-style: solid;--prose-thead-border-width: 0px;--prose-table-textAlign: start;--prose-hr-width: 1px;--prose-hr-style: solid;--prose-li-listStylePosition: outside;--prose-ol-li-markerColor: currentColor;--prose-ol-paddingInlineStart: 21px;--prose-ol-listStyleType: decimal;--prose-ul-li-markerColor: currentColor;--prose-ul-paddingInlineStart: 21px;--prose-ul-listStyleType: disc;--prose-blockquote-border-style: solid;--prose-blockquote-border-width: 4px;--prose-blockquote-quotes: '201C' '201D' '2018' '2019';--prose-blockquote-paddingInlineStart: 24px;--prose-a-code-color-hover: currentColor;--prose-a-code-color-static: currentColor;--prose-a-hasCode-borderBottom: none;--prose-a-border-distance: 2px;--prose-a-border-color-hover: currentColor;--prose-a-border-color-static: currentColor;--prose-a-border-style-hover: solid;--prose-a-border-style-static: dashed;--prose-a-border-width: 1px;--prose-a-color-static: inherit;--prose-a-textDecoration: none;--prose-h6-margin: 3rem 0 2rem;--prose-h5-margin: 3rem 0 2rem;--prose-h4-margin: 3rem 0 2rem;--prose-h3-margin: 3rem 0 2rem;--prose-h2-margin: 3rem 0 2rem;--prose-h1-margin: 0 0 2rem;--typography-lead-loose: 2;--typography-lead-relaxed: 1.625;--typography-lead-normal: 1.5;--typography-lead-snug: 1.375;--typography-lead-tight: 1.25;--typography-lead-none: 1;--typography-lead-10: 2.5rem;--typography-lead-9: 2.25rem;--typography-lead-8: 2rem;--typography-lead-7: 1.75rem;--typography-lead-6: 1.5rem;--typography-lead-5: 1.25rem;--typography-lead-4: 1rem;--typography-lead-3: .75rem;--typography-lead-2: .5rem;--typography-lead-1: .025rem;--typography-fontWeight-black: 900;--typography-fontWeight-extrabold: 800;--typography-fontWeight-bold: 700;--typography-fontWeight-semibold: 600;--typography-fontWeight-medium: 500;--typography-fontWeight-normal: 400;--typography-fontWeight-light: 300;--typography-fontWeight-extralight: 200;--typography-fontWeight-thin: 100;--typography-fontSize-9xl: 128px;--typography-fontSize-8xl: 96px;--typography-fontSize-7xl: 72px;--typography-fontSize-6xl: 60px;--typography-fontSize-5xl: 48px;--typography-fontSize-4xl: 36px;--typography-fontSize-3xl: 30px;--typography-fontSize-2xl: 24px;--typography-fontSize-xl: 20px;--typography-fontSize-lg: 18px;--typography-fontSize-base: 16px;--typography-fontSize-sm: 14px;--typography-fontSize-xs: 12px;--typography-letterSpacing-wide: 0.025em;--typography-letterSpacing-tight: -0.025em;--typography-verticalMargin-base: 24px;--typography-verticalMargin-sm: 16px;--elements-border-secondary-hover: [object Object];--elements-backdrop-background: #fffc;--elements-backdrop-filter: saturate(200%) blur(20px);--elements-container-maxWidth: 80rem;--lead-loose: 2;--lead-relaxed: 1.625;--lead-normal: 1.5;--lead-snug: 1.375;--lead-tight: 1.25;--lead-none: 1;--lead-10: 2.5rem;--lead-9: 2.25rem;--lead-8: 2rem;--lead-7: 1.75rem;--lead-6: 1.5rem;--lead-5: 1.25rem;--lead-4: 1rem;--lead-3: .75rem;--lead-2: .5rem;--lead-1: .025rem;--letterSpacing-widest: 0.1em;--letterSpacing-wider: 0.05em;--letterSpacing-wide: 0.025em;--letterSpacing-normal: 0em;--letterSpacing-tight: -0.025em;--letterSpacing-tighter: -0.05em;--fontSize-9xl: 8rem;--fontSize-8xl: 6rem;--fontSize-7xl: 4.5rem;--fontSize-6xl: 3.75rem;--fontSize-5xl: 3rem;--fontSize-4xl: 2.25rem;--fontSize-3xl: 1.875rem;--fontSize-2xl: 1.5rem;--fontSize-xl: 1.25rem;--fontSize-lg: 1.125rem;--fontSize-base: 1rem;--fontSize-sm: 0.875rem;--fontSize-xs: 0.75rem;--fontWeight-black: 900;--fontWeight-extrabold: 800;--fontWeight-bold: 700;--fontWeight-semibold: 600;--fontWeight-medium: 500;--fontWeight-normal: 400;--fontWeight-light: 300;--fontWeight-extralight: 200;--fontWeight-thin: 100;--font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace;--font-serif: ui-serif, Georgia, Cambria, Times New Roman, Times, serif;--font-sans: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica Neue, Arial, Noto Sans, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji;--opacity-total: 1;--opacity-high: 0.8;--opacity-medium: 0.5;--opacity-soft: 0.3;--opacity-light: 0.15;--opacity-bright: 0.1;--opacity-noOpacity: 0;--borderWidth-lg: 3px;--borderWidth-md: 2px;--borderWidth-sm: 1px;--borderWidth-noBorder: 0;--space-rem-875: 0.875rem;--space-rem-625: 0.625rem;--space-rem-375: 0.375rem;--space-rem-125: 0.125rem;--space-px: 1px;--space-128: 32rem;--space-96: 24rem;--space-80: 20rem;--space-72: 18rem;--space-64: 16rem;--space-60: 15rem;--space-56: 14rem;--space-52: 13rem;--space-48: 12rem;--space-44: 11rem;--space-40: 10rem;--space-36: 9rem;--space-32: 8rem;--space-28: 7rem;--space-24: 6rem;--space-20: 5rem;--space-16: 4rem;--space-14: 3.5rem;--space-12: 3rem;--space-11: 2.75rem;--space-10: 2.5rem;--space-9: 2.25rem;--space-8: 2rem;--space-7: 1.75rem;--space-6: 1.5rem;--space-5: 1.25rem;--space-4: 1rem;--space-3: 0.75rem;--space-2: 0.5rem;--space-1: 0.25rem;--space-0: 0px;--size-full: 100%;--size-7xl: 80rem;--size-6xl: 72rem;--size-5xl: 64rem;--size-4xl: 56rem;--size-3xl: 48rem;--size-2xl: 42rem;--size-xl: 36rem;--size-lg: 32rem;--size-md: 28rem;--size-sm: 24rem;--size-xs: 20rem;--size-200: 200px;--size-104: 104px;--size-80: 80px;--size-64: 64px;--size-56: 56px;--size-48: 48px;--size-40: 40px;--size-32: 32px;--size-24: 24px;--size-20: 20px;--size-16: 16px;--size-12: 12px;--size-8: 8px;--size-6: 6px;--size-4: 4px;--size-2: 2px;--size-0: 0px;--radii-full: 9999px;--radii-3xl: 1.75rem;--radii-2xl: 1.5rem;--radii-xl: 1rem;--radii-lg: 0.75rem;--radii-md: 0.5rem;--radii-sm: 0.375rem;--radii-xs: 0.25rem;--radii-2xs: 0.125rem;--radii-none: 0px;--shadow-none: 0px 0px 0px 0px transparent;--height-screen: 100vh;--width-screen: 100vw;--color-primary-900: #001A1F;--color-primary-800: #00232B;--color-primary-700: #024757;--color-primary-600: #09A0C1;--color-primary-500: #1AD6FF;--color-primary-400: #55E1FF;--color-primary-300: #82E3FF;--color-primary-200: #C5F2FF;--color-primary-100: #DCF7FF;--color-primary-50: #F1FCFF;--color-ruby-900: #380011;--color-ruby-800: #700021;--color-ruby-700: #a90032;--color-ruby-600: #e10043;--color-ruby-500: #ff1a5e;--color-ruby-400: #ff4079;--color-ruby-300: #ff6694;--color-ruby-200: #ff8dae;--color-ruby-100: #ffb3c9;--color-ruby-50: #ffd9e4;--color-pink-900: #380025;--color-pink-800: #70004b;--color-pink-700: #a90070;--color-pink-600: #e10095;--color-pink-500: #ff1ab2;--color-pink-400: #ff40bf;--color-pink-300: #ff66cc;--color-pink-200: #ff8dd8;--color-pink-100: #ffb3e5;--color-pink-50: #ffd9f2;--color-purple-900: #190038;--color-purple-800: #330070;--color-purple-700: #4c00a9;--color-purple-600: #6500e1;--color-purple-500: #811aff;--color-purple-400: #9640ff;--color-purple-300: #ab66ff;--color-purple-200: #c08dff;--color-purple-100: #d5b3ff;--color-purple-50: #ead9ff;--color-royalblue-900: #0b0531;--color-royalblue-800: #160a62;--color-royalblue-700: #211093;--color-royalblue-600: #2c15c4;--color-royalblue-500: #4127e8;--color-royalblue-400: #614bec;--color-royalblue-300: #806ff0;--color-royalblue-200: #a093f3;--color-royalblue-100: #c0b7f7;--color-royalblue-50: #dfdbfb;--color-indigoblue-900: #001238;--color-indigoblue-800: #002370;--color-indigoblue-700: #0035a9;--color-indigoblue-600: #0047e1;--color-indigoblue-500: #1a62ff;--color-indigoblue-400: #407cff;--color-indigoblue-300: #6696ff;--color-indigoblue-200: #8db0ff;--color-indigoblue-100: #b3cbff;--color-indigoblue-50: #d9e5ff;--color-blue-900: #00131D;--color-blue-800: #002235;--color-blue-700: #014267;--color-blue-600: #0069A6;--color-blue-500: #1AADFF;--color-blue-400: #64C7FF;--color-blue-300: #A1DDFF;--color-blue-200: #C6EAFF;--color-blue-100: #DFF3FF;--color-blue-50: #F2FAFF;--color-lightblue-900: #002e38;--color-lightblue-800: #005c70;--color-lightblue-700: #008aa9;--color-lightblue-600: #00b9e1;--color-lightblue-500: #1ad6ff;--color-lightblue-400: #40ddff;--color-lightblue-300: #66e4ff;--color-lightblue-200: #8deaff;--color-lightblue-100: #b3f1ff;--color-lightblue-50: #d9f8ff;--color-teal-900: #062a28;--color-teal-800: #0b544f;--color-teal-700: #117d77;--color-teal-600: #16a79e;--color-teal-500: #1cd1c6;--color-teal-400: #36e4da;--color-teal-300: #5fe9e1;--color-teal-200: #87efe9;--color-teal-100: #aff4f0;--color-teal-50: #d7faf8;--color-pear-900: #2a2b09;--color-pear-800: #545512;--color-pear-700: #7e801b;--color-pear-600: #a8aa24;--color-pear-500: #d0d32f;--color-pear-400: #d8da52;--color-pear-300: #e0e274;--color-pear-200: #e8e997;--color-pear-100: #eff0ba;--color-pear-50: #f7f8dc;--color-red-900: #1C0301;--color-red-800: #340A01;--color-red-700: #701704;--color-red-600: #BB2402;--color-red-500: #FF3B10;--color-red-400: #FF7353;--color-red-300: #FFA692;--color-red-200: #FFDED7;--color-red-100: #FFF3F0;--color-red-50: #FFF9F8;--color-orange-900: #381800;--color-orange-800: #702f00;--color-orange-700: #a94700;--color-orange-600: #e15e00;--color-orange-500: #ff7a1a;--color-orange-400: #ff9040;--color-orange-300: #ffa666;--color-orange-200: #ffbd8d;--color-orange-100: #ffd3b3;--color-orange-50: #ffe9d9;--color-yellow-900: #1B1500;--color-yellow-800: #292100;--color-yellow-700: #614E02;--color-yellow-600: #CBA408;--color-yellow-500: #FBCA05;--color-yellow-400: #FFDC4E;--color-yellow-300: #FFE372;--color-yellow-200: #FFF0B1;--color-yellow-100: #FFF6D3;--color-yellow-50: #FFFCEE;--color-green-900: #00190F;--color-green-800: #002817;--color-green-700: #006037;--color-green-600: #00B467;--color-green-500: #0DD885;--color-green-400: #3CEEA5;--color-green-300: #86FBCB;--color-green-200: #C3FFE6;--color-green-100: #DEFFF1;--color-green-50: #ECFFF7;--color-gray-900: #121110;--color-gray-800: #201E1B;--color-gray-700: #36332E;--color-gray-600: #67635D;--color-gray-500: #97948F;--color-gray-400: #ADA9A4;--color-gray-300: #DBD9D3;--color-gray-200: #ECEBE8;--color-gray-100: #F6F5F4;--color-gray-50: #FBFBFB;--color-black: #0B0A0A;--color-white: #ffffff;--media-portrait: only screen and (orientation: portrait);--media-landscape: only screen and (orientation: landscape);--media-rm: (prefers-reduced-motion: reduce);--media-2xl: (min-width: 1536px);--media-xl: (min-width: 1280px);--media-lg: (min-width: 1024px);--media-md: (min-width: 768px);--media-sm: (min-width: 640px);--media-xs: (min-width: 475px);--docus-search-results-highlight-backgroundColor: var(--color-primary-500);--docus-search-results-selected-backgroundColor: var(--color-gray-300);--docus-search-results-window-borderRadius: none;--docus-search-results-window-marginX: 0;--docus-search-input-backgroundColor: var(--color-gray-200);--docus-search-input-padding: var(--space-2) var(--space-4);--docus-search-input-gap: var(--space-2);--docus-search-input-fontSize: var(--fontSize-sm);--docus-search-input-borderColor: var(--color-gray-200);--docus-search-input-borderRadius: var(--radii-2xs);--docus-footer-padding: var(--space-4) 0;--docus-header-title-color-hover: var(--color-primary-500);--docus-header-title-color-static: var(--color-gray-900);--docus-header-title-fontWeight: var(--fontWeight-bold);--docus-header-title-fontSize: var(--fontSize-2xl);--docus-header-logo-height: var(--space-6);--docus-body-fontFamily: var(--font-sans);--docus-body-color: var(--color-gray-800);--docus-body-backgroundColor: var(--color-white);--prose-code-inline-fontWeight: var(--typography-fontWeight-normal);--prose-code-inline-fontSize: var(--typography-fontSize-sm);--prose-code-inline-borderRadius: var(--radii-xs);--prose-code-block-pre-padding: var(--typography-verticalMargin-sm);--prose-code-block-margin: var(--typography-verticalMargin-base) 0;--prose-code-block-fontSize: var(--typography-fontSize-sm);--prose-tbody-code-inline-fontSize: var(--typography-fontSize-sm);--prose-tbody-td-padding: var(--typography-verticalMargin-sm);--prose-th-fontWeight: var(--typography-fontWeight-semibold);--prose-th-padding: 0 var(--typography-verticalMargin-sm) var(--typography-verticalMargin-sm) var(--typography-verticalMargin-sm);--prose-table-lineHeight: var(--typography-lead-6);--prose-table-fontSize: var(--typography-fontSize-sm);--prose-table-margin: var(--typography-verticalMargin-base) 0;--prose-hr-margin: var(--typography-verticalMargin-base) 0;--prose-li-margin: var(--typography-verticalMargin-sm) 0;--prose-ol-margin: var(--typography-verticalMargin-base) 0;--prose-ul-margin: var(--typography-verticalMargin-base) 0;--prose-blockquote-margin: var(--typography-verticalMargin-base) 0;--prose-a-code-border-style: var(--prose-a-border-style-static);--prose-a-code-border-width: var(--prose-a-border-width);--prose-a-fontWeight: var(--typography-fontWeight-medium);--prose-img-margin: var(--typography-verticalMargin-base) 0;--prose-strong-fontWeight: var(--typography-fontWeight-semibold);--prose-h6-iconSize: var(--typography-fontSize-base);--prose-h6-fontWeight: var(--typography-fontWeight-semibold);--prose-h6-lineHeight: var(--typography-lead-normal);--prose-h6-fontSize: var(--typography-fontSize-lg);--prose-h5-iconSize: var(--typography-fontSize-lg);--prose-h5-fontWeight: var(--typography-fontWeight-semibold);--prose-h5-lineHeight: var(--typography-lead-snug);--prose-h5-fontSize: var(--typography-fontSize-xl);--prose-h4-iconSize: var(--typography-fontSize-lg);--prose-h4-letterSpacing: var(--typography-letterSpacing-tight);--prose-h4-fontWeight: var(--typography-fontWeight-semibold);--prose-h4-lineHeight: var(--typography-lead-snug);--prose-h4-fontSize: var(--typography-fontSize-2xl);--prose-h3-iconSize: var(--typography-fontSize-xl);--prose-h3-letterSpacing: var(--typography-letterSpacing-tight);--prose-h3-fontWeight: var(--typography-fontWeight-semibold);--prose-h3-lineHeight: var(--typography-lead-snug);--prose-h3-fontSize: var(--typography-fontSize-3xl);--prose-h2-iconSize: var(--typography-fontSize-2xl);--prose-h2-letterSpacing: var(--typography-letterSpacing-tight);--prose-h2-fontWeight: var(--typography-fontWeight-semibold);--prose-h2-lineHeight: var(--typography-lead-tight);--prose-h2-fontSize: var(--typography-fontSize-4xl);--prose-h1-iconSize: var(--typography-fontSize-3xl);--prose-h1-letterSpacing: var(--typography-letterSpacing-tight);--prose-h1-fontWeight: var(--typography-fontWeight-bold);--prose-h1-lineHeight: var(--typography-lead-tight);--prose-h1-fontSize: var(--typography-fontSize-5xl);--prose-p-br-margin: var(--typography-verticalMargin-base) 0 0 0;--prose-p-margin: var(--typography-verticalMargin-base) 0;--prose-p-lineHeight: var(--typography-lead-normal);--prose-p-fontSize: var(--typography-fontSize-base);--typography-color-secondary-900: var(--color-gray-900);--typography-color-secondary-800: var(--color-gray-800);--typography-color-secondary-700: var(--color-gray-700);--typography-color-secondary-600: var(--color-gray-600);--typography-color-secondary-500: var(--color-gray-500);--typography-color-secondary-400: var(--color-gray-400);--typography-color-secondary-300: var(--color-gray-300);--typography-color-secondary-200: var(--color-gray-200);--typography-color-secondary-100: var(--color-gray-100);--typography-color-secondary-50: var(--color-gray-50);--typography-color-primary-900: var(--color-primary-900);--typography-color-primary-800: var(--color-primary-800);--typography-color-primary-700: var(--color-primary-700);--typography-color-primary-600: var(--color-primary-600);--typography-color-primary-500: var(--color-primary-500);--typography-color-primary-400: var(--color-primary-400);--typography-color-primary-300: var(--color-primary-300);--typography-color-primary-200: var(--color-primary-200);--typography-color-primary-100: var(--color-primary-100);--typography-color-primary-50: var(--color-primary-50);--typography-font-code: var(--font-mono);--typography-font-body: var(--font-sans);--typography-font-display: var(--font-sans);--typography-body-backgroundColor: var(--color-white);--typography-body-color: var(--color-black);--elements-state-danger-borderColor-secondary: var(--color-red-200);--elements-state-danger-borderColor-primary: var(--color-red-100);--elements-state-danger-backgroundColor-secondary: var(--color-red-100);--elements-state-danger-backgroundColor-primary: var(--color-red-50);--elements-state-danger-color-secondary: var(--color-red-600);--elements-state-danger-color-primary: var(--color-red-500);--elements-state-warning-borderColor-secondary: var(--color-yellow-200);--elements-state-warning-borderColor-primary: var(--color-yellow-100);--elements-state-warning-backgroundColor-secondary: var(--color-yellow-100);--elements-state-warning-backgroundColor-primary: var(--color-yellow-50);--elements-state-warning-color-secondary: var(--color-yellow-700);--elements-state-warning-color-primary: var(--color-yellow-600);--elements-state-success-borderColor-secondary: var(--color-green-200);--elements-state-success-borderColor-primary: var(--color-green-100);--elements-state-success-backgroundColor-secondary: var(--color-green-100);--elements-state-success-backgroundColor-primary: var(--color-green-50);--elements-state-success-color-secondary: var(--color-green-600);--elements-state-success-color-primary: var(--color-green-500);--elements-state-info-borderColor-secondary: var(--color-blue-200);--elements-state-info-borderColor-primary: var(--color-blue-100);--elements-state-info-backgroundColor-secondary: var(--color-blue-100);--elements-state-info-backgroundColor-primary: var(--color-blue-50);--elements-state-info-color-secondary: var(--color-blue-600);--elements-state-info-color-primary: var(--color-blue-500);--elements-state-primary-borderColor-secondary: var(--color-primary-200);--elements-state-primary-borderColor-primary: var(--color-primary-100);--elements-state-primary-backgroundColor-secondary: var(--color-primary-100);--elements-state-primary-backgroundColor-primary: var(--color-primary-50);--elements-state-primary-color-secondary: var(--color-primary-700);--elements-state-primary-color-primary: var(--color-primary-600);--elements-surface-secondary-backgroundColor: var(--color-gray-200);--elements-surface-primary-backgroundColor: var(--color-gray-100);--elements-surface-background-base: var(--color-gray-100);--elements-border-secondary-static: var(--color-gray-200);--elements-border-primary-hover: var(--color-gray-200);--elements-border-primary-static: var(--color-gray-100);--elements-container-padding-md: var(--space-6);--elements-container-padding-sm: var(--space-6);--elements-container-padding-xs: var(--space-4);--elements-container-padding-mobile: var(--space-4);--elements-text-secondary-color-hover: var(--color-gray-700);--elements-text-secondary-color-static: var(--color-gray-500);--elements-text-primary-color-static: var(--color-gray-900);--text-6xl-lineHeight: var(--lead-none);--text-6xl-fontSize: var(--fontSize-6xl);--text-5xl-lineHeight: var(--lead-none);--text-5xl-fontSize: var(--fontSize-5xl);--text-4xl-lineHeight: var(--lead-10);--text-4xl-fontSize: var(--fontSize-4xl);--text-3xl-lineHeight: var(--lead-9);--text-3xl-fontSize: var(--fontSize-3xl);--text-2xl-lineHeight: var(--lead-8);--text-2xl-fontSize: var(--fontSize-2xl);--text-xl-lineHeight: var(--lead-7);--text-xl-fontSize: var(--fontSize-xl);--text-lg-lineHeight: var(--lead-7);--text-lg-fontSize: var(--fontSize-lg);--text-base-lineHeight: var(--lead-6);--text-base-fontSize: var(--fontSize-base);--text-sm-lineHeight: var(--lead-5);--text-sm-fontSize: var(--fontSize-sm);--text-xs-lineHeight: var(--lead-4);--text-xs-fontSize: var(--fontSize-xs);--color-shadow: var(--color-gray-400);--color-secondary-900: var(--color-gray-900);--color-secondary-800: var(--color-gray-800);--color-secondary-700: var(--color-gray-700);--color-secondary-600: var(--color-gray-600);--color-secondary-500: var(--color-gray-500);--color-secondary-400: var(--color-gray-400);--color-secondary-300: var(--color-gray-300);--color-secondary-200: var(--color-gray-200);--color-secondary-100: var(--color-gray-100);--color-secondary-50: var(--color-gray-50);--prose-code-inline-backgroundColor: var(--typography-color-secondary-100);--prose-code-inline-color: var(--typography-color-secondary-700);--prose-code-block-backgroundColor: var(--typography-color-secondary-100);--prose-code-block-color: var(--typography-color-secondary-700);--prose-code-block-border-color: var(--typography-color-secondary-200);--prose-tbody-tr-borderBottom-color: var(--typography-color-secondary-200);--prose-th-color: var(--typography-color-secondary-600);--prose-thead-borderBottom-color: var(--typography-color-secondary-200);--prose-thead-border-color: var(--typography-color-secondary-300);--prose-hr-color: var(--typography-color-secondary-200);--prose-blockquote-border-color: var(--typography-color-secondary-200);--prose-blockquote-color: var(--typography-color-secondary-500);--prose-a-code-background-hover: var(--typography-color-primary-50);--prose-a-code-border-color-hover: var(--typography-color-primary-500);--prose-a-code-border-color-static: var(--typography-color-secondary-400);--prose-a-color-hover: var(--typography-color-primary-500);--shadow-2xl: 0px 25px 50px -12px var(--color-shadow);--shadow-xl: 0px 20px 25px -5px var(--color-shadow), 0px 8px 10px -6px var(--color-shadow);--shadow-lg: 0px 10px 15px -3px var(--color-shadow), 0px 4px 6px -4px var(--color-shadow);--shadow-md: 0px 4px 6px -1px var(--color-shadow), 0px 2px 4px -2px var(--color-shadow);--shadow-sm: 0px 1px 3px 0px var(--color-shadow), 0px 1px 2px -1px var(--color-shadow);--shadow-xs: 0px 1px 2px 0px var(--color-shadow); } }@media { :root.dark {--pinceau-mq: dark; --prose-code-block-backdropFilter: contrast(1);--prose-ol-li-markerColor: currentColor;--prose-ul-li-markerColor: currentColor;--prose-a-code-color-hover: currentColor;--prose-a-code-color-static: currentColor;--prose-a-border-color-hover: currentColor;--prose-a-border-color-static: currentColor;--prose-a-color-static: inherit;--elements-backdrop-background: #0c0d0ccc;--docus-search-results-selected-backgroundColor: var(--color-gray-700);--docus-search-input-backgroundColor: var(--color-gray-800);--docus-search-input-borderColor: transparent;--docus-header-title-color-static: var(--color-gray-100);--docus-body-color: var(--color-gray-200);--docus-body-backgroundColor: var(--color-black);--typography-body-backgroundColor: var(--color-black);--typography-body-color: var(--color-white);--elements-state-danger-borderColor-secondary: var(--color-red-700);--elements-state-danger-borderColor-primary: var(--color-red-800);--elements-state-danger-backgroundColor-secondary: var(--color-red-800);--elements-state-danger-backgroundColor-primary: var(--color-red-900);--elements-state-danger-color-secondary: var(--color-red-200);--elements-state-danger-color-primary: var(--color-red-300);--elements-state-warning-borderColor-secondary: var(--color-yellow-700);--elements-state-warning-borderColor-primary: var(--color-yellow-800);--elements-state-warning-backgroundColor-secondary: var(--color-yellow-800);--elements-state-warning-backgroundColor-primary: var(--color-yellow-900);--elements-state-warning-color-secondary: var(--color-yellow-200);--elements-state-warning-color-primary: var(--color-yellow-400);--elements-state-success-borderColor-secondary: var(--color-green-700);--elements-state-success-borderColor-primary: var(--color-green-800);--elements-state-success-backgroundColor-secondary: var(--color-green-800);--elements-state-success-backgroundColor-primary: var(--color-green-900);--elements-state-success-color-secondary: var(--color-green-200);--elements-state-success-color-primary: var(--color-green-400);--elements-state-info-borderColor-secondary: var(--color-blue-700);--elements-state-info-borderColor-primary: var(--color-blue-800);--elements-state-info-backgroundColor-secondary: var(--color-blue-800);--elements-state-info-backgroundColor-primary: var(--color-blue-900);--elements-state-info-color-secondary: var(--color-blue-200);--elements-state-info-color-primary: var(--color-blue-400);--elements-state-primary-borderColor-secondary: var(--color-primary-700);--elements-state-primary-borderColor-primary: var(--color-primary-800);--elements-state-primary-backgroundColor-secondary: var(--color-primary-800);--elements-state-primary-backgroundColor-primary: var(--color-primary-900);--elements-state-primary-color-secondary: var(--color-primary-200);--elements-state-primary-color-primary: var(--color-primary-400);--elements-surface-secondary-backgroundColor: var(--color-gray-800);--elements-surface-primary-backgroundColor: var(--color-gray-900);--elements-surface-background-base: var(--color-gray-900);--elements-border-secondary-static: var(--color-gray-800);--elements-border-primary-hover: var(--color-gray-800);--elements-border-primary-static: var(--color-gray-900);--elements-text-secondary-color-hover: var(--color-gray-200);--elements-text-secondary-color-static: var(--color-gray-400);--elements-text-primary-color-static: var(--color-gray-50);--color-shadow: var(--color-gray-800);--prose-code-inline-backgroundColor: var(--typography-color-secondary-800);--prose-code-inline-color: var(--typography-color-secondary-200);--prose-code-block-backgroundColor: var(--typography-color-secondary-900);--prose-code-block-color: var(--typography-color-secondary-200);--prose-code-block-border-color: var(--typography-color-secondary-800);--prose-tbody-tr-borderBottom-color: var(--typography-color-secondary-800);--prose-th-color: var(--typography-color-secondary-400);--prose-thead-borderBottom-color: var(--typography-color-secondary-800);--prose-thead-border-color: var(--typography-color-secondary-600);--prose-hr-color: var(--typography-color-secondary-800);--prose-blockquote-border-color: var(--typography-color-secondary-700);--prose-blockquote-color: var(--typography-color-secondary-400);--prose-a-code-background-hover: var(--typography-color-primary-900);--prose-a-code-border-color-hover: var(--typography-color-primary-600);--prose-a-code-border-color-static: var(--typography-color-secondary-600);--prose-a-color-hover: var(--typography-color-primary-400); } }@media (min-width: 640px) { :root {--pinceau-mq: sm; --docus-search-results-window-maxHeight: 320px;--docus-search-results-window-marginTop: 20vh;--docus-footer-height: 100px;--docus-search-results-window-borderRadius: var(--radii-xs);--docus-search-results-window-marginX: var(--space-4);--docus-header-logo-height: var(--space-7); } }</style><script>"use strict";(()=>{const a=window,e=document.documentElement,c=window.localStorage,d=["dark","light"],n=c&&c.getItem&&c.getItem("nuxt-color-mode")||"system";let l=n==="system"?f():n;const i=e.getAttribute("data-color-mode-forced");i&&(l=i),r(l),a["__NUXT_COLOR_MODE__"]={preference:n,value:l,getColorScheme:f,addColorScheme:r,removeColorScheme:u};function r(o){const t=""+o+"",s="theme";e.classList?e.classList.add(t):e.className+=" "+t,s&&e.setAttribute("data-"+s,o)}function u(o){const t=""+o+"",s="theme";e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp(t,"g"),""),s&&e.removeAttribute("data-"+s)}function m(o){return a.matchMedia("(prefers-color-scheme"+o+")")}function f(){if(a.matchMedia&&m("").media!=="not all"){for(const o of d)if(m(":"+o).matches)return o}return"light"}})();
</script></head><body><!----><!--teleport anchor--><!----><!--teleport anchor--><div id="__nuxt"><div class="app-layout" data-v-5518b344><div class="nuxt-progress" style="width:0%;opacity:0;background-size:Infinity% auto;" data-v-5518b344></div><header class="has-dialog" data-v-5518b344 data-v-1fce2464><div class="container pv-Mz5Z0z pc--KoAZf" data-v-1fce2464 data-v-f95e3fe1><!--[--><div class="section left" data-v-1fce2464><!--[--><button aria-label="Menu" data-v-d3d82abf><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" role="img" class="icon" data-v-d3d82abf style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg></button><!--teleport start--><!--teleport end--><!--]--><a href="/" class="navbar-logo" aria-label="Up4 Tech" data-v-1fce2464 data-v-2c39ff13><span class="title" data-v-2c39ff13>Up4 Tech</span></a></div><div class="section center" data-v-1fce2464><a href="/" class="navbar-logo" aria-label="Up4 Tech" data-v-1fce2464 data-v-2c39ff13><span class="title" data-v-2c39ff13>Up4 Tech</span></a><!----></div><div class="section right" data-v-1fce2464><!--[--><button type="button" aria-label="Search" data-v-639005c9><span class="content" data-v-639005c9><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-639005c9 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21l-6-6m2-5a7 7 0 1 1-14 0a7 7 0 0 1 14 0"/></svg><span data-v-639005c9>Search</span><span data-v-639005c9><kbd data-v-639005c9>âŒ˜</kbd><kbd data-v-639005c9>K</kbd></span></span></button><!--teleport start--><!--teleport end--><!--]--><button aria-label="Color Mode" data-v-1fce2464 data-v-58532cb3><span data-v-58532cb3>...</span></button><div class="social-icons" data-v-1fce2464><!--[--><a href="https://github.com/ramonpzg/edu_content" rel="noopener noreferrer" target="_blank" title="ramonpzg/edu_content" aria-label="ramonpzg/edu_content" data-v-ab03fb65><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-ab03fb65 style="" width="1em" height="1em" viewBox="0 0 496 512" data-v-a6937c2d><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2"/></svg></a><a href="https://nuxt.com" rel="noopener noreferrer" target="_blank" title="Nuxt" aria-label="Nuxt" data-v-ab03fb65><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-ab03fb65 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="M13.464 19.83h8.922c.283 0 .562-.073.807-.21a1.6 1.6 0 0 0 .591-.574a1.53 1.53 0 0 0 .216-.783a1.53 1.53 0 0 0-.217-.782L17.792 7.414a1.6 1.6 0 0 0-.591-.573a1.65 1.65 0 0 0-.807-.21c-.283 0-.562.073-.807.21a1.6 1.6 0 0 0-.59.573L13.463 9.99L10.47 4.953a1.6 1.6 0 0 0-.591-.573a1.65 1.65 0 0 0-.807-.21c-.284 0-.562.073-.807.21a1.6 1.6 0 0 0-.591.573L.216 17.481a1.53 1.53 0 0 0-.217.782c0 .275.074.545.216.783a1.6 1.6 0 0 0 .59.574c.246.137.525.21.808.21h5.6c2.22 0 3.856-.946 4.982-2.79l2.733-4.593l1.464-2.457l4.395 7.382h-5.859Zm-6.341-2.46l-3.908-.002l5.858-9.842l2.923 4.921l-1.957 3.29c-.748 1.196-1.597 1.632-2.916 1.632"/></svg></a><!--]--></div></div><!--]--></div></header><main data-v-5518b344><!--[--><div class="document-driven-page"><div class="container pv-Mz5Z0z pc-Qayd0G docs-page-content fluid has-toc has-aside" data-v-ba22cf1e data-v-f95e3fe1><!--[--><aside class="aside-nav" data-v-ba22cf1e><nav class="app-aside" data-v-ba22cf1e data-v-47381d57><ul class="docs-aside-tree" data-v-47381d57 data-v-246a485b><!--[--><li class="" data-v-246a485b><button class="title-collapsible-button" data-v-246a485b><span class="content" data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 256 256" data-v-a6937c2d><g fill="currentColor"><path d="m229.06 108.79l-48.7 42l14.88 62.79a8.4 8.4 0 0 1-12.52 9.17L128 189.09l-54.72 33.65a8.4 8.4 0 0 1-12.52-9.17l14.88-62.79l-48.7-42A8.46 8.46 0 0 1 31.73 94l63.91-5.2l24.62-59.6a8.36 8.36 0 0 1 15.48 0l24.62 59.6l63.91 5.2a8.46 8.46 0 0 1 4.79 14.79" opacity=".2"/><path d="M239.18 97.26A16.38 16.38 0 0 0 224.92 86l-59-4.76l-22.78-55.09a16.36 16.36 0 0 0-30.27 0L90.11 81.23L31.08 86a16.46 16.46 0 0 0-9.37 28.86l45 38.83L53 211.75a16.38 16.38 0 0 0 24.5 17.82l50.5-31.08l50.53 31.08A16.4 16.4 0 0 0 203 211.75l-13.76-58.07l45-38.83a16.43 16.43 0 0 0 4.94-17.59m-15.34 5.47l-48.7 42a8 8 0 0 0-2.56 7.91l14.88 62.8a.37.37 0 0 1-.17.48c-.18.14-.23.11-.38 0l-54.72-33.65a8 8 0 0 0-8.38 0l-54.72 33.67c-.15.09-.19.12-.38 0a.37.37 0 0 1-.17-.48l14.88-62.8a8 8 0 0 0-2.56-7.91l-48.7-42c-.12-.1-.23-.19-.13-.5s.18-.27.33-.29l63.92-5.16a8 8 0 0 0 6.72-4.94l24.62-59.61c.08-.17.11-.25.35-.25s.27.08.35.25L153 91.86a8 8 0 0 0 6.75 4.92l63.92 5.16c.15 0 .24 0 .33.29s0 .4-.16.5"/></g></svg><span data-v-246a485b>Set Up</span></span><span data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-246a485b data-v-246a485b><!--[--><li class="has-parent-icon bordered" data-v-246a485b><a href="/introduction" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Introduction</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-246a485b><a href="/introduction/python_installation" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Python Installation</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-246a485b><a href="/introduction/git_installation" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Git Installation</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-246a485b><a href="/introduction/jupyter_intro" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Jupyter Lab &amp; Notebooks Intro</span></span></a><!----></li><!--]--></ul></li><li class="" data-v-246a485b><button class="title-collapsible-button" data-v-246a485b><span class="content" data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 4v12l-4-2l-4 2V4M6 20h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2"/></svg><span data-v-246a485b>Programming</span></span><span data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-246a485b data-v-246a485b><!--[--><li class="has-parent-icon bordered" data-v-246a485b><a href="/programming" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Programming Tutorials</span></span></a><!----></li><li class="has-parent-icon has-children bordered" data-v-246a485b><button class="title-collapsible-button" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Terminal</span></span><span data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 15l5 5l5-5M7 9l5-5l5 5"/></svg></span></button><ul class="docs-aside-tree recursive" style="display:none;" data-v-246a485b data-v-246a485b><!--[--><li class="bordered" data-v-246a485b><a href="/programming/terminal/shell_intro" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Intro to the Terminal</span></span></a><!----></li><!--]--></ul></li><!--]--></ul></li><li class="" data-v-246a485b><button class="title-collapsible-button" data-v-246a485b><span class="content" data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="M5 3v16h16v2H3V3zm15.293 3.293l1.414 1.414L16 13.414l-3-2.999l-4.293 4.292l-1.414-1.414L13 7.586l3 2.999z"/></svg><span data-v-246a485b>Analytics</span></span><span data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-246a485b data-v-246a485b><!--[--><li class="has-parent-icon bordered" data-v-246a485b><a href="/analytics" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Data Analytics</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-246a485b><a href="/analytics/numerical_computing" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Numerical Computing</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-246a485b><a href="/analytics/structured_data" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Intro to pandas</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-246a485b><a href="/analytics/stats_intro" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Intro to Statistics</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-246a485b><a href="/analytics/describing_data" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Describing Data</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-246a485b><a href="/analytics/eda" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Exploratory Data Analysis</span></span></a><!----></li><!--]--></ul></li><li class="" data-v-246a485b><button class="title-collapsible-button" data-v-246a485b><span class="content" data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m8.686 4l2.607-2.607a1 1 0 0 1 1.414 0L15.314 4H19a1 1 0 0 1 1 1v3.686l2.607 2.607a1 1 0 0 1 0 1.414L20 15.314V19a1 1 0 0 1-1 1h-3.686l-2.607 2.607a1 1 0 0 1-1.414 0L8.686 20H5a1 1 0 0 1-1-1v-3.686l-2.607-2.607a1 1 0 0 1 0-1.414L4 8.686V5a1 1 0 0 1 1-1zM6 6v3.515L3.515 12L6 14.485V18h3.515L12 20.485L14.485 18H18v-3.515L20.485 12L18 9.515V6h-3.515L12 3.515L9.515 6zm6 10a4 4 0 1 1 0-8a4 4 0 0 1 0 8m0-2a2 2 0 1 0 0-4a2 2 0 0 0 0 4"/></svg><span data-v-246a485b>Data Engineering</span></span><span data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-246a485b data-v-246a485b><!--[--><li class="has-parent-icon bordered" data-v-246a485b><a href="/data-engineering/data_pipelines_getting_started" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Data Pipelines From Scratch</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-246a485b><a href="/data-engineering/getting_data" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Getting Data as DataFrames</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-246a485b><a href="/data-engineering/data_cleaning" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Data Cleaning</span></span></a><!----></li><li class="has-parent-icon bordered active" data-v-246a485b><a aria-current="page" href="/data-engineering/etl_pipes" class="router-link-active router-link-exact-active link padded active" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>01 ETL Pipelines</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-246a485b><a href="/data-engineering/data_pipelines_getting_started" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Data Pipelines From Scratch</span></span></a><!----></li><!--]--></ul></li><li class="" data-v-246a485b><button class="title-collapsible-button" data-v-246a485b><span class="content" data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="M15.199 9.944a2.6 2.6 0 0 1-.79-1.55l-.403-3.083l-2.731 1.486a2.6 2.6 0 0 1-1.719.272L6.5 6.5l.57 3.056a2.6 2.6 0 0 1-.273 1.72l-1.486 2.73l3.083.403a2.6 2.6 0 0 1 1.55.79l2.138 2.257l1.336-2.807a2.6 2.6 0 0 1 1.23-1.231l2.808-1.336zm.025 5.564l-2.213 4.65a.6.6 0 0 1-.977.155l-3.542-3.739a.6.6 0 0 0-.358-.182l-5.106-.668a.6.6 0 0 1-.45-.881l2.462-4.524a.6.6 0 0 0 .063-.396L4.16 4.86a.6.6 0 0 1 .7-.7l5.062.943a.6.6 0 0 0 .397-.063l4.523-2.46a.6.6 0 0 1 .882.448l.668 5.107a.6.6 0 0 0 .182.357l3.739 3.542a.6.6 0 0 1-.155.977l-4.65 2.213a.6.6 0 0 0-.284.284m.797 1.927l1.414-1.414l4.243 4.242l-1.415 1.415z"/></svg><span data-v-246a485b>Data Science</span></span><span data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-246a485b data-v-246a485b><!--[--><li class="has-parent-icon bordered" data-v-246a485b><a href="/data-science" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Intro to DS</span></span></a><!----></li><!--]--></ul></li><li class="" data-v-246a485b><button class="title-collapsible-button" data-v-246a485b><span class="content" data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="M13.5 2c0 .444-.193.843-.5 1.118V5h5a3 3 0 0 1 3 3v10a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3V8a3 3 0 0 1 3-3h5V3.118A1.5 1.5 0 1 1 13.5 2M6 7a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V8a1 1 0 0 0-1-1zm-4 3H0v6h2zm20 0h2v6h-2zM9 14.5a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m6 0a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3"/></svg><span data-v-246a485b>Machine Learning Engineering</span></span><span data-v-246a485b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-246a485b style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-246a485b data-v-246a485b><!--[--><li class="has-parent-icon bordered" data-v-246a485b><a href="/ml-engineering" class="link padded" data-v-246a485b><span class="content" data-v-246a485b><!----><span data-v-246a485b>Intro to MLE</span></span></a><!----></li><!--]--></ul></li><!--]--></ul></nav></aside><article class="page-body" data-v-ba22cf1e><!--[--><!--[--><div><h1 id="_01-etl-pipelines" data-v-b293a8e3><a aria-current="page" href="/data-engineering/etl_pipes#_01-etl-pipelines" class="router-link-active router-link-exact-active" data-v-b293a8e3><!--[-->01 ETL Pipelines<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-b293a8e3 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m13.172 12l-4.95-4.95l1.414-1.413L16 12l-6.364 6.364l-1.414-1.415z"/></svg></a></h1><blockquote data-v-7aaedb56><!--[--><p data-v-3dd08768><!--[-->â€œWithout a systematic way to start and keep data clean, bad data will happen.â€ â€” Donato Diorio<!--]--></p><!--]--></blockquote><p data-v-3dd08768><!--[--><img src="https://cdn.dribbble.com/users/1752792/screenshots/5652276/media/12db9ebc672c30dcb4d0fd125f70fb41.png" alt="data_flow" data-v-2da0c6e8><!--]--></p><p data-v-3dd08768><!--[-->Source: <a href="https://dribbble.com/shots/5652276-User-flow/attachments/10982649?mode=media" rel="nofollow" data-v-d1c581be><!--[-->Mindaugas SadÅ«nas<!--]--></a><!--]--></p><h2 id="table-of-contents" data-v-3a00cd39><a aria-current="page" href="/data-engineering/etl_pipes#table-of-contents" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->Table of Contents<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><ol data-v-18730953><!--[--><li data-v-f93bd10c><!--[--><a aria-current="page" href="/data-engineering/etl_pipes#1.-Overview" class="router-link-active router-link-exact-active" data-v-d1c581be><!--[-->Overview<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[--><a aria-current="page" href="/data-engineering/etl_pipes#2.-Learning-Outcomes" class="router-link-active router-link-exact-active" data-v-d1c581be><!--[-->Learning Outcomes<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[--><a aria-current="page" href="/data-engineering/etl_pipes#3.-Data" class="router-link-active router-link-exact-active" data-v-d1c581be><!--[-->Data<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[--><a aria-current="page" href="/data-engineering/etl_pipes#4.-Tools" class="router-link-active router-link-exact-active" data-v-d1c581be><!--[-->Tools<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[--><a aria-current="page" href="/data-engineering/etl_pipes#5.-Data-Pipelines" class="router-link-active router-link-exact-active" data-v-d1c581be><!--[-->Data Pipelines<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[--><a aria-current="page" href="/data-engineering/etl_pipes#6.-%F0%9F%90%BC-%60pipe%60lines" class="router-link-active router-link-exact-active" data-v-d1c581be><!--[-->ðŸ¼ <code class="" data-v-d83432f1><!--[-->pipe<!--]--></code>lines<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[--><a aria-current="page" href="/data-engineering/etl_pipes#7.-Extract" class="router-link-active router-link-exact-active" data-v-d1c581be><!--[-->Extract<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[--><a aria-current="page" href="/data-engineering/etl_pipes#8.-Transform" class="router-link-active router-link-exact-active" data-v-d1c581be><!--[-->Transform<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[--><a aria-current="page" href="/data-engineering/etl_pipes#9.-Load" class="router-link-active router-link-exact-active" data-v-d1c581be><!--[-->Load<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[--><a aria-current="page" href="/data-engineering/etl_pipes#10.-Launch-a-Pipeline" class="router-link-active router-link-exact-active" data-v-d1c581be><!--[-->Launch a Pipeline<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[--><a aria-current="page" href="/data-engineering/etl_pipes#11.-Summary" class="router-link-active router-link-exact-active" data-v-d1c581be><!--[-->Summary<!--]--></a><!--]--></li><!--]--></ol><h2 id="_1-overview" data-v-3a00cd39><a aria-current="page" href="/data-engineering/etl_pipes#_1-overview" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->1. Overview<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><p data-v-3dd08768><!--[-->You are a data analyst working at Beautiful Analytics, and you have been given a project in which you will work using data generated from shared bikes systems in the cities of London (England, UK), Seoul (South Korea), and Washington (DC, USA). Your customer&#39;s are the governments of each city and what they want to solve is the same,<!--]--></p><p data-v-3dd08768><!--[--><strong data-v-b1d4d84a><!--[-->Challenge #1<!--]--></strong><!--]--></p><blockquote data-v-7aaedb56><!--[--><p data-v-3dd08768><!--[-->To predict/forecast how many bikes they will to need to have available in the city at every hour of the dat for the next few years?<!--]--></p><!--]--></blockquote><p data-v-3dd08768><!--[-->Each government captures similar data but, as you can imagine, they all use different words and measure similar variables in different ways. This means that our first job before we can answer the question above is to fix the data and put it in amore user-friendly way. While we are at it, we should also try and automate our pipeline so that the next time we need to read, transform, and load new versions of all the data sources for this project, we could do so with the click of a button rather than having to write everything again from scratch. So our first real problem is,<!--]--></p><p data-v-3dd08768><!--[--><strong data-v-b1d4d84a><!--[-->Challenge #0<!--]--></strong><!--]--></p><blockquote data-v-7aaedb56><!--[--><p data-v-3dd08768><!--[-->Create a data pipeline that extracts, transforms and loads the necessary data for the task at hand.<!--]--></p><!--]--></blockquote><h2 id="_2-learning-outcomes" data-v-3a00cd39><a aria-current="page" href="/data-engineering/etl_pipes#_2-learning-outcomes" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->2. Learning Outcomes<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><p data-v-3dd08768><!--[-->Before we get started, let&#39;s go over the learning outcomes for this section of the workshop.<!--]--></p><p data-v-3dd08768><!--[-->By the end of this lesson you will be able to,<!--]--></p><ol data-v-18730953><!--[--><li data-v-f93bd10c><!--[-->Discuss what ETL and ELT Pipelines are.<!--]--></li><li data-v-f93bd10c><!--[-->Understand how to read and combine data that comes from different sources.<!--]--></li><li data-v-f93bd10c><!--[-->Create data pipelines using pandas and prefect.<!--]--></li><li data-v-f93bd10c><!--[-->Understand how to visualize the pipelines you create to help you with their development.<!--]--></li><!--]--></ol><h2 id="_3-data" data-v-3a00cd39><a aria-current="page" href="/data-engineering/etl_pipes#_3-data" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->3. Data<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><p data-v-3dd08768><!--[--><img src="https://images.pexels.com/photos/11803508/pexels-photo-11803508.jpeg?cs=srgb&amp;dl=pexels-%D1%80%D0%BE%D0%BC%D0%B0%D0%BD-%D0%BA%D0%B0%D0%B4%D1%8C%D0%BA%D0%B0%D0%BB%D0%BE%D0%B2-11803508.jpg&amp;fm=jpg" alt="bikes" data-v-2da0c6e8><!--]--></p><p data-v-3dd08768><!--[-->All three data files contain similar information about how many bicycles have been rented each hour, day, week and months for several years and for each city government we are working with.<!--]--></p><p data-v-3dd08768><!--[-->You can get more information about the data of each city using the following links.<!--]--></p><ul data-v-b0218224><!--[--><li data-v-f93bd10c><!--[--><a href="https://archive.ics.uci.edu/ml/datasets/Seoul+Bike+Sharing+Demand#" rel="nofollow" data-v-d1c581be><!--[-->Seoul, Korea del Sur<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[--><a href="https://www.kaggle.com/hmavrodiev/london-bike-sharing-dataset" rel="nofollow" data-v-d1c581be><!--[-->London, England, UK<!--]--></a><!--]--></li><li data-v-f93bd10c><!--[--><a href="https://www.kaggle.com/marklvl/bike-sharing-dataset?select=hour.csv" rel="nofollow" data-v-d1c581be><!--[-->Washington, DC, USA<!--]--></a><!--]--></li><!--]--></ul><p data-v-3dd08768><!--[-->Here are the variables that appear in the three data files.<!--]--></p>


























































































<div class="table-wrapper" data-v-a011f4e7><table data-v-a011f4e7><!--[--><thead data-v-ecc07e8d><!--[--><tr data-v-b801bbf1><!--[--><th align="center" data-v-b2c09405><!--[-->London<!--]--></th><th align="center" data-v-b2c09405><!--[-->Seoul<!--]--></th><th align="center" data-v-b2c09405><!--[-->Washington<!--]--></th><!--]--></tr><!--]--></thead><tbody><!--[--><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[-->date<!--]--></td><td align="center" data-v-cdda4551><!--[-->date<!--]--></td><td align="center" data-v-cdda4551><!--[-->instant<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[-->count<!--]--></td><td align="center" data-v-cdda4551><!--[-->count<!--]--></td><td align="center" data-v-cdda4551><!--[-->date<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[-->temperature<!--]--></td><td align="center" data-v-cdda4551><!--[-->hour<!--]--></td><td align="center" data-v-cdda4551><!--[-->seasons<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[-->t2<!--]--></td><td align="center" data-v-cdda4551><!--[-->temperature<!--]--></td><td align="center" data-v-cdda4551><!--[-->year<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[-->humidity<!--]--></td><td align="center" data-v-cdda4551><!--[-->humidity<!--]--></td><td align="center" data-v-cdda4551><!--[-->month<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[-->wind_speed<!--]--></td><td align="center" data-v-cdda4551><!--[-->wind_speed<!--]--></td><td align="center" data-v-cdda4551><!--[-->hour<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[-->weather_code<!--]--></td><td align="center" data-v-cdda4551><!--[-->visibility<!--]--></td><td align="center" data-v-cdda4551><!--[-->is_holiday<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[-->is_holiday<!--]--></td><td align="center" data-v-cdda4551><!--[-->dew_point_temp<!--]--></td><td align="center" data-v-cdda4551><!--[-->weekday<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[-->is_weekend<!--]--></td><td align="center" data-v-cdda4551><!--[-->solar_radiation<!--]--></td><td align="center" data-v-cdda4551><!--[-->workingday<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[-->seasons<!--]--></td><td align="center" data-v-cdda4551><!--[-->rainfall<!--]--></td><td align="center" data-v-cdda4551><!--[-->weathersit<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[--><!--]--></td><td align="center" data-v-cdda4551><!--[-->snowfall<!--]--></td><td align="center" data-v-cdda4551><!--[-->temperature<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[--><!--]--></td><td align="center" data-v-cdda4551><!--[-->seasons<!--]--></td><td align="center" data-v-cdda4551><!--[-->count<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[--><!--]--></td><td align="center" data-v-cdda4551><!--[-->is_holiday<!--]--></td><td align="center" data-v-cdda4551><!--[-->humidity<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[--><!--]--></td><td align="center" data-v-cdda4551><!--[-->functioning_day<!--]--></td><td align="center" data-v-cdda4551><!--[-->wind_speed<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[--><!--]--></td><td align="center" data-v-cdda4551><!--[--><!--]--></td><td align="center" data-v-cdda4551><!--[-->casual<!--]--></td><!--]--></tr><tr data-v-b801bbf1><!--[--><td align="center" data-v-cdda4551><!--[--><!--]--></td><td align="center" data-v-cdda4551><!--[--><!--]--></td><td align="center" data-v-cdda4551><!--[-->registered<!--]--></td><!--]--></tr><!--]--></tbody><!--]--></table></div><p data-v-3dd08768><!--[-->Since all of these datasets where generated with different business logic and, most likely, by completely different systems, we can certainly expect more inconsistencies than just unmatching column names, numerical formats, and data collected. We will walk through a few cleaning steps after we discuss the tools we will be using today.<!--]--></p><h2 id="_4-tools" data-v-3a00cd39><a aria-current="page" href="/data-engineering/etl_pipes#_4-tools" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->4. Tools<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><p data-v-3dd08768><!--[-->The tools that we will use in the workshop are the following.<!--]--></p><ul data-v-b0218224><!--[--><li data-v-f93bd10c><!--[--><a href="https://pandas.pydata.org/" rel="nofollow" data-v-d1c581be><!--[-->pandas<!--]--></a> - &quot;is a fast, powerful, flexible and easy to use open source data analysis and manipulation tool, built on top of the Python programming language.&quot;<!--]--></li><li data-v-f93bd10c><!--[--><a href="https://docs.prefect.io/" rel="nofollow" data-v-d1c581be><!--[-->Prefect<!--]--></a> - &quot;is a new workflow management system, designed for a modern infrastructure and powered by the open source workflow engine, Prefect Core. Users organize tasks into <code class="" data-v-d83432f1><!--[-->task<!--]--></code>&#39;s and<code class="" data-v-d83432f1><!--[--> flow<!--]--></code>&#39;s, and Prefect takes care of the rest.&quot;<!--]--></li><li data-v-f93bd10c><!--[--><a href="https://docs.python.org/3/library/sqlite3.html" rel="nofollow" data-v-d1c581be><!--[-->sqlite3<!--]--></a> - &quot;SQLite is a library written in C that provides a lightweight disk-based database that does not require a separate server process and allows the database to be accessed using a non-standard variant of the SQL query language.&quot;<!--]--></li><li data-v-f93bd10c><!--[--><a href="https://docs.python.org/3/library/pathlib.html" rel="nofollow" data-v-d1c581be><!--[-->pathlib<!--]--></a> - allows us to manipulate paths as if they were python objects.<!--]--></li><!--]--></ul><p data-v-3dd08768><!--[-->Before we continue, let&#39;s load the modules we&#39;ll need and examine our datasets.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>import pandas as pd
</span></span><span class="line" line="2"><span>from prefect import flow, task
</span></span><span class="line" line="3"><span>import sqlite3
</span></span><span class="line" line="4"><span>from contextlib import closing
</span></span><span class="line" line="5"><span>from pathlib import Path
</span></span><span class="line" line="6"><span emptylineplaceholder="true">
</span></span><span class="line" line="7"><span emptylineplaceholder="true">
</span></span><span class="line" line="8"><span>pd.options.display.max_rows = None
</span></span><span class="line" line="9"><span>pd.options.display.max_columns = None
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>path = Path().cwd().parent.joinpath(&quot;data&quot;, &quot;01_part&quot;)
</span></span><span class="line" line="2"><span>path
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->We will need paths to all of our datasets.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>london_path = path.joinpath(&#39;raw&#39;, &#39;london&#39;, &#39;london_bikes.db&#39;)
</span></span><span class="line" line="2"><span>seoul_path = path.joinpath(&#39;raw&#39;, &#39;seoul&#39;, &#39;SeoulBikeData.csv&#39;)
</span></span><span class="line" line="3"><span>wash_dc_path = path.joinpath(&#39;raw&#39;, &#39;wash_dc&#39;, &#39;washington.json&#39;)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->The data we have about the bikes in London is in a SQLite database and to read it, we first need to create a connection to its database using the <code class="" data-v-d83432f1><!--[-->sqlite3<!--]--></code> package.<!--]--></p><p data-v-3dd08768><!--[-->The next step is to use the pandas <code class="" data-v-d83432f1><!--[-->read_sql_query<!--]--></code> function to read the data. This function takes two arguments, the connection to our databaset and the query to get the data we want.<!--]--></p><p data-v-3dd08768><!--[-->Note that we can make quite elaborate queries to get a subset of the data we&#39;ll be working with, but for our purposes this is not necessary.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>conn = sqlite3.connect(london_path)
</span></span><span class="line" line="2"><span>query = &quot;SELECT * FROM uk_bikes&quot;
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>london = pd.read_sql_query(query, conn)
</span></span><span class="line" line="2"><span>london.head()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->Seoul data is in text form and separated by commas, and the data for DC is in JSON format. For these two we can use <code class="" data-v-d83432f1><!--[-->pd.read_csv<!--]--></code> and<code class="" data-v-d83432f1><!--[--> pd.read_json<!--]--></code>, respectively.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>seoul = pd.read_csv(seoul_path)
</span></span><span class="line" line="2"><span>seoul.head()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>washington = pd.read_json(wash_dc_path)
</span></span><span class="line" line="2"><span>washington.head()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><h2 id="_5-data-pipelines" data-v-3a00cd39><a aria-current="page" href="/data-engineering/etl_pipes#_5-data-pipelines" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->5. Data Pipelines<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><p data-v-3dd08768><!--[--><img src="https://databricks.com/wp-content/uploads/2021/05/ETL-Process.jpg" alt="etl_pipe" data-v-2da0c6e8><!--]--></p><p data-v-3dd08768><!--[--><strong data-v-b1d4d84a><!--[-->What are ETL Pipelines?<!--]--></strong><!--]--></p><p data-v-3dd08768><!--[-->The acronym ETL stands for Extract, Transform, and Load, and it is the process by which organizations&#39; data passes through before it reaches the hands of data consumers. Which can be analysts, marketers, sales people, customers, and so on...<!--]--></p><p data-v-3dd08768><!--[--><strong data-v-b1d4d84a><!--[-->Why should you learn how to create them?<!--]--></strong><!--]--></p><p data-v-3dd08768><!--[-->As data professionals, our task is to create value for our organizations, our clients and our collaborators using some of, if not all, the data that we have at our disposal. However, to get the most out of our organization&#39;s data, we often need<!--]--></p><ol data-v-18730953><!--[--><li data-v-f93bd10c><!--[-->Information about the process by which it was generated, For example,
<ul data-v-b0218224><!--[--><li data-v-f93bd10c><!--[-->Point of sale<!--]--></li><li data-v-f93bd10c><!--[-->Clicks on an online marketplace like Amazon, Etzy, Ebay, ect.<!--]--></li><li data-v-f93bd10c><!--[-->Epidemiological studies<!--]--></li><li data-v-f93bd10c><!--[-->A/B Test Results<!--]--></li><li data-v-f93bd10c><!--[-->...<!--]--></li><!--]--></ul><!--]--></li><li data-v-f93bd10c><!--[-->Information about the transformations that occurred during the cleaning and merging process. For instance,
<ul data-v-b0218224><!--[--><li data-v-f93bd10c><!--[-->Celcius degrees were converted into fahrenheit<!--]--></li><li data-v-f93bd10c><!--[-->Prices in Chilean pesos were converted to {insert preferred ðŸ’¸}<!--]--></li><li data-v-f93bd10c><!--[-->Non-numerical and unavailable observations now contain &quot;Not Available&quot; or &quot;Unknown&quot;<!--]--></li><li data-v-f93bd10c><!--[-->Numerical variables now contain the average or median value in observations where that data is missing. For example, a variable with the salary of all employees of a company now contains $40,000$ / year USD in the values that were not available becuase this was the median value.<!--]--></li><li data-v-f93bd10c><!--[-->...<!--]--></li><!--]--></ul><!--]--></li><li data-v-f93bd10c><!--[-->Information about how the data was stored and where. For instance,
<ul data-v-b0218224><!--[--><li data-v-f93bd10c><!--[-->Parquet format<!--]--></li><li data-v-f93bd10c><!--[-->NOSQL or SQL database<!--]--></li><li data-v-f93bd10c><!--[-->CSV<!--]--></li><li data-v-f93bd10c><!--[-->...<!--]--></li><!--]--></ul><!--]--></li><!--]--></ol><p data-v-3dd08768><!--[-->Understanding how the three processes described above flow will help us have more knowledge about the data that we are going to use, and how to best access it, transform it, and model it before we put it to good use.<!--]--></p><p data-v-3dd08768><!--[-->Let&#39;s walk through an example of a data pipeline using data from wildfires between 1983-2020 in the United States. You can find more information about the dataset <a href="https://www.kaggle.com/kkhandekar/total-wildfires-acres-affected-1983-2020" rel="nofollow" data-v-d1c581be><!--[-->here<!--]--></a>.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>example_data_in = path.joinpath(&quot;example&quot;, &quot;federal_firefighting_costs.csv&quot;)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>pd.read_csv(example_data_in).head()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->As you can see, most columns contain a <code class="" data-v-d83432f1><!--[-->$<!--]--></code> dollar sign and some <code class="" data-v-d83432f1><!--[-->,<!--]--></code> commas, and because this forces Python to treat numbers as objects rather than <code class="" data-v-d83432f1><!--[-->int<!--]--></code>&#39;s or <code class="" data-v-d83432f1><!--[-->float<!--]--></code>&#39;s, we will have to remove these signs in our transformation step after extracting the data and before loading a clean version of it.<!--]--></p><ul data-v-b0218224><!--[--><li data-v-f93bd10c><!--[-->About Prefect
At its core, prefect create Directed Acyclic Graphs where nodes are functions of computations linking one step to another.<!--]--></li><!--]--></ul><p data-v-3dd08768><!--[-->When you use prefect you have two important APIs, one is the <code class="" data-v-d83432f1><!--[-->task<!--]--></code> API and the other is<code class="" data-v-d83432f1><!--[--> flow<!--]--></code>. The former is used as a decorator on top of functions and this allows us to signal to prefect that our decorated functions can become a node in a graph. The latter represents a set the graph we want to run and it is composed of one or multiple tasks, or even multiple flows.<!--]--></p><p data-v-3dd08768><!--[-->For example, let&#39;s create 3 functions, one that extracts the data we need, another that takes anything that is non-numerical out of our variables, and another that loads the cleaned data somewhere. Each function will have the <code class="" data-v-d83432f1><!--[-->task<!--]--></code> decorator on top of it.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>@task(name=&quot;Get Data!&quot;)
</span></span><span class="line" line="2"><span>def extract(path):
</span></span><span class="line" line="3"><span>    return pd.read_csv(path)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->As you saw above, only the last 5 variables have commas (<code class="" data-v-d83432f1><!--[-->,<!--]--></code>) and dollar symbols (<code class="" data-v-d83432f1><!--[-->$<!--]--></code>) so we will replace both with an empty space (<code class="" data-v-d83432f1><!--[-->&quot;&quot;<!--]--></code>) using a <code class="" data-v-d83432f1><!--[-->for<!--]--></code> loop.<!--]--></p><p data-v-3dd08768><!--[-->For the download process, we will save the data in the <code class="" data-v-d83432f1><!--[-->parquet<!--]--></code> format. This is one of the most popular formats to save data in due to its compression capabilities, orientation, and speed gains in analytical workloads.<!--]--></p><p data-v-3dd08768><!--[-->Here&#39;s an example on the differences between the row-like format and the columnar format of parquet files.<!--]--></p><p data-v-3dd08768><!--[--><img src="https://3.bp.blogspot.com/-3aUydn8zCsQ/VjslzWCu3pI/AAAAAAAAAI8/XOi77xQNmm0/s1600/Difference-between-Column-based-and-Row-based-Tables.png" alt="colvsrow" data-v-2da0c6e8><!--]--></p><p data-v-3dd08768><!--[-->Source: <a href="http://www.hanaexam.com/p/row-store-vs-column-store.html" rel="nofollow" data-v-d1c581be><!--[-->SAP HANA Central<!--]--></a><!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>@task(name=&quot;Transform Data!&quot;)
</span></span><span class="line" line="2"><span>def transform(data):
</span></span><span class="line" line="3"><span>    for col in data.iloc[:, 1:].columns:
</span></span><span class="line" line="4"><span>        data[col] = data[col].str.replace(r&#39;[^0-9]+&#39;, &#39;&#39;, regex=True).astype(int)
</span></span><span class="line" line="5"><span>    return data
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>@task(name=&quot;Load Data!&quot;)
</span></span><span class="line" line="2"><span>def load(data, path):
</span></span><span class="line" line="3"><span>    data.to_parquet(path, compression=&#39;snappy&#39;)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->When we have all the steps ready, we create a new function containing our graph using the <code class="" data-v-d83432f1><!--[-->flow<!--]--></code> decorator. We can give this function a name, for example, <code class="" data-v-d83432f1><!--[-->&quot;Example Pipeline! ðŸ˜Ž&quot;<!--]--></code> and then chain the tasks we created previously in the order in which they should be run.<!--]--></p><p data-v-3dd08768><!--[-->After we create our function, we can simply run it with the arguments necessary and Prefect will do its magic.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>example_data_out = path.joinpath(&quot;example&quot;, &quot;my_test.parquet&quot;)
</span></span><span class="line" line="2"><span>type(example_data_out)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>@flow(name=&quot;Example Pipeline! ðŸ˜Ž&quot;)
</span></span><span class="line" line="2"><span>def example_etl(example_data_in, example_data_out):
</span></span><span class="line" line="3"><span>    data = extract(example_data_in)
</span></span><span class="line" line="4"><span>    data_clean = transform(data)
</span></span><span class="line" line="5"><span>    load(data_clean, example_data_out)
</span></span><span class="line" line="6"><span>    print(&quot;Your Pipeline Ran Successfully!&quot;)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>example_etl(example_data_in, example_data_out)#.execute_in_process()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->To see the graph we just ran, we can open the terminal and run <code class="" data-v-d83432f1><!--[-->prefect orion start<!--]--></code>. This will take us to the Prefect UI where we can evaluate not only the run and graph, but also the parameters and logs collected from all DAGs we run.<!--]--></p><p data-v-3dd08768><!--[-->To make sure we have the correct data, let&#39;s create a visualization with pandas and hvplot, a package that allows us to add interactivity to our pandas&#39; charts.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>import hvplot.pandas
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>pd.read_parquet(path.joinpath(&quot;example&quot;, &quot;my_test.parquet&quot;)).hvplot(x=&#39;Year&#39;, y=&quot;ForestService&quot;)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><h2 id="_6-pipelines" data-v-3a00cd39><a aria-current="page" href="/data-engineering/etl_pipes#_6-pipelines" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->6. ðŸ¼ <code class="" data-v-d83432f1><!--[-->pipe<!--]--></code>lines<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><p data-v-3dd08768><!--[--><img src="https://camo.githubusercontent.com/45ae53e215244585378c3e414ce05abb4f5f6be3/68747470733a2f2f6d656469612e67697068792e636f6d2f6d656469612f4978365150753533576c4236772f67697068792e676966" alt data-v-2da0c6e8><!--]--></p><p data-v-3dd08768><!--[-->The <code class="" data-v-d83432f1><!--[-->pipe<!--]--></code> operator is a pandas function that allows you to chain operations that take a data set, modify it, and return the modified version of the original data. In essence, it allows us to move the data through a series of steps until we reach the structure in which we want to have it.<!--]--></p><p data-v-3dd08768><!--[-->For example, imagine that we have a group of data and 4 functions to fix it, the chain of operations would look like this.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>(data.pipe(change_cols, list_of_cols)
</span></span><span class="line" line="2"><span>     .pipe(clean_numeric_vars, list_of_numeric_vars)
</span></span><span class="line" line="3"><span>     .pipe(add_dates_and_location, &#39;Auckland&#39;, &#39;NZ&#39;)
</span></span><span class="line" line="4"><span>     .pipe(fix_and_drop, &#39;column_to_fix&#39;, seasons_NZ, cols_drop_NZ))
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->Another way to visualize what happens with pandas&#39; <code class="" data-v-d83432f1><!--[-->pipe<!--]--></code> is through the following food process where we have ingredients and we actually require food.<!--]--></p><p data-v-3dd08768><!--[--><img src="../images/pandas_pipe.png" alt="img" data-v-2da0c6e8><!--]--></p><p data-v-3dd08768><!--[-->Let&#39;s start with a small example without <code class="" data-v-d83432f1><!--[-->pipe<!--]--></code> first.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>toy_data = pd.DataFrame({&quot;Postal Codes&quot;: [22345, 32442, 20007], 
</span></span><span class="line" line="2"><span>                         &quot;Cities&quot;:       [&quot;Miami&quot;, &quot;Dallas&quot;, &quot;Washington&quot;],
</span></span><span class="line" line="3"><span>                         &quot;Date&quot;:         pd.date_range(start=&#39;9/27/2021&#39;, periods=3)})
</span></span><span class="line" line="4"><span>toy_data
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>def change_cols(data, cols_list):
</span></span><span class="line" line="2"><span>    data.columns = cols_list
</span></span><span class="line" line="3"><span>    return data
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>def clean_col_names(index_of_cols: pd.Index):
</span></span><span class="line" line="2"><span>    import re
</span></span><span class="line" line="3"><span>    new_cols =  [re.sub(r&#39;[^a-zA-Z0-9\s]&#39;, &#39;&#39;, col).lower().replace(r&quot; &quot;, &quot;_&quot;) for col in index_of_cols]
</span></span><span class="line" line="4"><span>    print(type(index_of_cols))
</span></span><span class="line" line="5"><span>    print(index_of_cols)
</span></span><span class="line" line="6"><span>    print(type(new_cols))
</span></span><span class="line" line="7"><span>    print(new_cols)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>pd.Index
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>clean_col_names(toy_data.columns)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>change_cols(toy_data, [&quot;postal_code&quot;, &quot;city&quot;, &quot;date&quot;])
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->As you can see, with a single function it doesn&#39;t make much sense to pipe the process but with a chain of functions, the story changes.<!--]--></p><p data-v-3dd08768><!--[-->The next thing we want to do is add additional information about the dates we have for each file. We can achieve this after converting the <code class="" data-v-d83432f1><!--[-->date<!--]--></code> variable to <code class="" data-v-d83432f1><!--[-->datetime<!--]--></code> format, which will allow us to access the year, month, week, ect. inside each date.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>london_cols = [&#39;date&#39;, &#39;count&#39;, &#39;temperature&#39;, &#39;temp_feels_like&#39;, &#39;humidity&#39;, &#39;wind_speed&#39;, &#39;weather_code&#39;, &#39;is_holiday&#39;, &#39;is_weekend&#39;, &#39;seasons&#39;]
</span></span><span class="line" line="2"><span>seoul_cols = [&#39;date&#39;, &#39;count&#39;, &#39;hour&#39;, &#39;temperature&#39;, &#39;humidity&#39;, &#39;wind_speed&#39;, &#39;visibility&#39;, &#39;dew_point_temp&#39;, &#39;solar_radiation&#39;, &#39;rainfall&#39;, &#39;snowfall&#39;, &#39;seasons&#39;, &#39;is_holiday&#39;, &#39;functioning_day&#39;]
</span></span><span class="line" line="3"><span>wa_dc_cols = [&#39;instant&#39;, &#39;date&#39;, &#39;seasons&#39;, &#39;year&#39;, &#39;month&#39;, &#39;hour&#39;, &#39;is_holiday&#39;, &#39;weekday&#39;, &#39;workingday&#39;, &#39;weathersit&#39;, &#39;temperature&#39;, &#39;temp_feels_like&#39;, &#39;humidity&#39;, &#39;wind_speed&#39;, &#39;casual&#39;, &#39;registered&#39;, &#39;count&#39;]
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>def add_dates_and_location(data, city, country):
</span></span><span class="line" line="2"><span>    
</span></span><span class="line" line="3"><span>    data[&#39;date&#39;]       = pd.to_datetime(data[&#39;date&#39;], infer_datetime_format=True, dayfirst=True)
</span></span><span class="line" line="4"><span>    data[&quot;year&quot;]       = data[&#39;date&#39;].dt.year
</span></span><span class="line" line="5"><span>    data[&quot;month&quot;]      = data[&#39;date&#39;].dt.month
</span></span><span class="line" line="6"><span>    data[&quot;week&quot;]       = data[&#39;date&#39;].dt.isocalendar().week.astype(int)
</span></span><span class="line" line="7"><span>    data[&quot;day&quot;]        = data[&#39;date&#39;].dt.day
</span></span><span class="line" line="8"><span>    data[&quot;weekday&quot;]    = data[&#39;date&#39;].dt.dayofweek
</span></span><span class="line" line="9"><span>    data[&quot;is_weekend&quot;] = (data[&quot;weekday&quot;] &gt; 4).astype(int)
</span></span><span class="line" line="10"><span>    
</span></span><span class="line" line="11"><span>    # note that we don&#39;t want to overwrite data that already has the hour as a column
</span></span><span class="line" line="12"><span>    if &#39;hour&#39; not in data.columns: 
</span></span><span class="line" line="13"><span>        data[&quot;hour&quot;]   = data[&#39;date&#39;].dt.hour
</span></span><span class="line" line="14"><span>    data[&#39;date&#39;]       = data[&#39;date&#39;].dt.date
</span></span><span class="line" line="15"><span>    
</span></span><span class="line" line="16"><span>    # non-date variables
</span></span><span class="line" line="17"><span>    data[&#39;city&#39;]       = city
</span></span><span class="line" line="18"><span>    data[&#39;country&#39;]    = country
</span></span><span class="line" line="19"><span>    
</span></span><span class="line" line="20"><span>    return data
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>add_dates_and_location(toy_data, &quot;Sydney&quot;, &quot;AU&quot;)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->As you can see, we added a lot of information to our data with a simple function, but what happens when we want to chain two or three or four operations together? The following would not be very easy to read right?<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>add_dates_and_location(change_cols (toy_data, [&quot; postal_code &quot;,&quot; city &quot;,&quot; date &quot;]),&quot; Sydney &quot;,&quot; AU &quot;)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->Let&#39;s move on to using our <code class="" data-v-d83432f1><!--[-->pipe<!--]--></code> operator now.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>toy_data = pd.DataFrame({&quot;Postal Codes&quot;: [22345, 32442, 20007], 
</span></span><span class="line" line="2"><span>                         &quot;Cities&quot;:       [&quot;Miami&quot;, &quot;Dallas&quot;, &quot;Washington&quot;],
</span></span><span class="line" line="3"><span>                         &quot;Date&quot;:         pd.date_range(start=&#39;9/27/2021&#39;, periods=3)})
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>(
</span></span><span class="line" line="2"><span>    toy_data.pipe(change_cols, [&quot;zip_code&quot;, &quot;city&quot;, &quot;date&quot;])
</span></span><span class="line" line="3"><span>            .pipe(add_dates_and_location, &quot;Sydney&quot;, &quot;AU&quot;)
</span></span><span class="line" line="4"><span>)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->As you can see, now our chained functions are more readable than before and we can continue and chain even more functions in the same fashion.<!--]--></p><p data-v-3dd08768><!--[-->In our data we have the stages of the year with different names and we also have variables that we do not need or that are not in the three files. Let&#39;s fix both!<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>seasons_london = {0: &#39;Spring&#39;, 1: &#39;Summer&#39;, 2: &#39;Fall&#39;, 3: &#39;Winter&#39;}
</span></span><span class="line" line="2"><span>seasons_wa_dc = {1: &#39;Spring&#39;, 2: &#39;Summer&#39;, 3: &#39;Fall&#39;, 4: &#39;Winter&#39;}
</span></span><span class="line" line="3"><span>holidays_seoul = {&#39;No Holiday&#39;: 0, &#39;Holiday&#39;: 1}
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>cols_drop_london = [&#39;temp_feels_like&#39;, &#39;weather_code&#39;]
</span></span><span class="line" line="2"><span>cols_drop_seoul = [&#39;visibility&#39;, &#39;dew_point_temp&#39;, &#39;solar_radiation&#39;, &#39;rainfall&#39;, &#39;snowfall&#39;, &#39;functioning_day&#39;]
</span></span><span class="line" line="3"><span>cols_drop_wa_dc = [&#39;instant&#39;, &#39;temp_feels_like&#39;, &#39;casual&#39;, &#39;registered&#39;, &#39;workingday&#39;, &#39;weathersit&#39;]
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>def fix_and_drop(data, col_to_fix, mapping, cols_to_drop):
</span></span><span class="line" line="2"><span>    data[col_to_fix] = data[col_to_fix].map(mapping)
</span></span><span class="line" line="3"><span>    return data.drop(cols_to_drop, axis=1)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->Let&#39;s test the <code class="" data-v-d83432f1><!--[-->pipe<!--]--></code> operator but with the data from DC now and evaluate the results.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>washington.head()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>(washington.pipe(change_cols, wa_dc_cols)
</span></span><span class="line" line="2"><span>           .pipe(fix_and_drop, &#39;seasons&#39;, seasons_wa_dc, cols_drop_wa_dc)).head()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->Lastly, we esnt to create a function to normalize the data for DC as the columns are not in the same metric/imperial, etc. system as the rest.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>def normalize_vars(data):
</span></span><span class="line" line="2"><span>    data[&#39;temperature&#39;] = data[&#39;temperature&#39;].apply(lambda x: (x * 47) - 8)
</span></span><span class="line" line="3"><span>    data[&#39;humidity&#39;]    = data[&#39;humidity&#39;].apply(lambda x: (x / 100))
</span></span><span class="line" line="4"><span>    data[&#39;wind_speed&#39;]  = data[&#39;wind_speed&#39;].apply(lambda x: (x / 67))
</span></span><span class="line" line="5"><span>    return data
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->Finally, we can use our <code class="" data-v-d83432f1><!--[-->pipe<!--]--></code> operator again to complete the process and see the end result.<!--]--></p><p data-v-3dd08768><!--[-->Since we haven&#39;t created a function to read JSON files, let&#39;s create one anc call it <code class="" data-v-d83432f1><!--[-->extract_data<!--]--></code>.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>def extract_data(path):
</span></span><span class="line" line="2"><span>    return pd.read_json(path)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>washington = (extract_data(wash_dc_path).pipe(change_cols, wa_dc_cols)
</span></span><span class="line" line="2"><span>                                        .pipe(add_dates_and_location, &#39;DC&#39;, &#39;USA&#39;)
</span></span><span class="line" line="3"><span>                                        .pipe(fix_and_drop, &#39;seasons&#39;, seasons_wa_dc, cols_drop_wa_dc)
</span></span><span class="line" line="4"><span>                                        .pipe(normalize_vars))
</span></span><span class="line" line="5"><span>washington.head()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><h2 id="exercise" data-v-3a00cd39><a aria-current="page" href="/data-engineering/etl_pipes#exercise" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->Exercise<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><ol data-v-18730953><!--[--><li data-v-f93bd10c><!--[-->Create a function to extract the London data.<!--]--></li><li data-v-f93bd10c><!--[-->Create a data pipe similar to the one in Washington using pandas&#39; <code class="" data-v-d83432f1><!--[-->pipe<!--]--></code>.<!--]--></li><!--]--></ol><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span></span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span></span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span></span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span></span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><h2 id="_7-extract" data-v-3a00cd39><a aria-current="page" href="/data-engineering/etl_pipes#_7-extract" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->7. Extract<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><p data-v-3dd08768><!--[-->Depending on where the data is, in what format it is stored, and how we can access it, this can either be one of the shortest steps or one of the longest ones in our data pipeline. Here are some of the formats that you might encounter in your day to day.<!--]--></p><ul data-v-b0218224><!--[--><li data-v-f93bd10c><!--[-->Text: usually the text format is similar to what we see in Microsoft Excel but without formulas or graphics. For example, CVS or TSV.<!--]--></li><li data-v-f93bd10c><!--[-->JSON: JavaScript Object Notation is a very popular sub-language for its simple syntactics<!--]--></li><li data-v-f93bd10c><!--[-->Databases: These can be SQL, NOSQL, MPP (massively parallel processing), among others.<!--]--></li><li data-v-f93bd10c><!--[-->GeoJSON: It is a type of format for data that contains geographic information. There are many more types of data for GIS.<!--]--></li><li data-v-f93bd10c><!--[-->HTML: Refers to Hyper Text Markup Language and represents the skeleton of almost all web pages in existence.<!--]--></li><li data-v-f93bd10c><!--[-->...<!--]--></li><!--]--></ul><p data-v-3dd08768><!--[-->Since we already learned how to create useful pipelines with pandas, we now need to create functions for our main ETL pipeline to automate the process. We can achieve this using the prefect decorator, <code class="" data-v-d83432f1><!--[-->@task<!--]--></code> from earlier. This decorator takes note of the functions that we want to link together and helps us create a network in which each node is a function and each link connects one or more functions only once.<!--]--></p><p data-v-3dd08768><!--[-->Remember, the decorator <code class="" data-v-d83432f1><!--[-->@task<!--]--></code> is also a function within prefect and as such, we can pass several arguments to it that help us modify the behavior of each function in our pipeline.<!--]--></p><p data-v-3dd08768><!--[-->You can learn more about the <code class="" data-v-d83432f1><!--[-->task<!--]--></code> API in the official docs <a href="https://docs.prefect.io/core/concepts/tasks.html#overview" rel="nofollow" data-v-d1c581be><!--[-->here<!--]--></a>.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>task??
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>@task
</span></span><span class="line" line="2"><span>def extract_1(path):
</span></span><span class="line" line="3"><span>    return pd.read_csv(path)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>@task
</span></span><span class="line" line="2"><span>def extract_2(path):
</span></span><span class="line" line="3"><span>    conn = sqlite3.connect(path)
</span></span><span class="line" line="4"><span>    query = &quot;SELECT * FROM uk_bikes&quot;
</span></span><span class="line" line="5"><span>    return pd.read_sql_query(query, conn)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>@task
</span></span><span class="line" line="2"><span>def extract_3(path):
</span></span><span class="line" line="3"><span>    return pd.read_json(path)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><h2 id="_8-transform" data-v-3a00cd39><a aria-current="page" href="/data-engineering/etl_pipes#_8-transform" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->8. Transform<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><p data-v-3dd08768><!--[-->The most common transformations that happen at this stage are usually the ones we created earlier. In short,<!--]--></p><ul data-v-b0218224><!--[--><li data-v-f93bd10c><!--[-->Clean text data<!--]--></li><li data-v-f93bd10c><!--[-->Normalize columns<!--]--></li><li data-v-f93bd10c><!--[-->Convert numeric variables to the same unit<!--]--></li><li data-v-f93bd10c><!--[-->Deal with missing values<!--]--></li><li data-v-f93bd10c><!--[-->Join data<!--]--></li><!--]--></ul><p data-v-3dd08768><!--[-->Our transform step will be a parent function to our pipe operators from earlier. Hence, a combination of functions handle by a single one.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>def order_and_merge(data_lists):
</span></span><span class="line" line="2"><span>    
</span></span><span class="line" line="3"><span>    pick_order = data_lists[0].columns
</span></span><span class="line" line="4"><span>    new_list = [d.reindex(columns=pick_order).sort_values([&#39;date&#39;, &#39;hour&#39;]) for d in data_lists]
</span></span><span class="line" line="5"><span>    df = pd.concat(new_list)
</span></span><span class="line" line="6"><span>    return df
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>@task
</span></span><span class="line" line="2"><span>def transform(london, seoul, washington):
</span></span><span class="line" line="3"><span>    
</span></span><span class="line" line="4"><span>    london = (london.pipe(change_cols, london_cols)
</span></span><span class="line" line="5"><span>                    .pipe(add_dates_and_location, &#39;London&#39;, &#39;UK&#39;)
</span></span><span class="line" line="6"><span>                    .pipe(fix_and_drop, &#39;seasons&#39;, seasons_london, cols_drop_london))
</span></span><span class="line" line="7"><span>    
</span></span><span class="line" line="8"><span>    seoul = (seoul.pipe(change_cols, seoul_cols)
</span></span><span class="line" line="9"><span>                  .pipe(add_dates_and_location, &#39;Seoul&#39;, &#39;SK&#39;)
</span></span><span class="line" line="10"><span>                  .pipe(fix_and_drop, &#39;is_holiday&#39;, holidays_seoul, cols_drop_seoul))
</span></span><span class="line" line="11"><span>    
</span></span><span class="line" line="12"><span>    wash_dc = (washington.pipe(change_cols, wa_dc_cols)
</span></span><span class="line" line="13"><span>                         .pipe(add_dates_and_location, &#39;DC&#39;, &#39;USA&#39;)
</span></span><span class="line" line="14"><span>                         .pipe(fix_and_drop, &#39;seasons&#39;, seasons_wa_dc, cols_drop_wa_dc)
</span></span><span class="line" line="15"><span>                         .pipe(normalize_vars))
</span></span><span class="line" line="16"><span>    
</span></span><span class="line" line="17"><span>    return order_and_merge([london, seoul, wash_dc])
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><h2 id="_9-load" data-v-3a00cd39><a aria-current="page" href="/data-engineering/etl_pipes#_9-load" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->9. Load<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><p data-v-3dd08768><!--[-->We will need to save our new file in a database or in a format in which we are given both what the file occupies and the speed with which we can open and use it. So we will create two paths and two names for the files that we will use later.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>clean_path = path/&#39;processed/clean.parquet&#39;
</span></span><span class="line" line="2"><span>clean_db_path = path/&#39;processed/bikes&#39;
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>clean_db_path
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->We will have a function for saving the data in a database. For this, Prefect provides us with a wrapper function around SQLite called, <code class="" data-v-d83432f1><!--[-->SQLiteScript<!--]--></code> which allows us to create a database and run a SQL scipt on top of it. This comes in hady for large and small operations/prototypes alike.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>def SQLiteScript(db, script):
</span></span><span class="line" line="2"><span>    with closing(sqlite3.connect(db)) as conn:
</span></span><span class="line" line="3"><span>        with closing(conn.cursor()) as cursor:
</span></span><span class="line" line="4"><span>            cursor.executescript(script)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>script= &quot;&quot;&quot;
</span></span><span class="line" line="2"><span>            CREATE TABLE IF NOT EXISTS bike_sharing (
</span></span><span class="line" line="3"><span>                    date text, count integer, temperature real,
</span></span><span class="line" line="4"><span>                    humidity real, wind_speed real, is_holiday real,
</span></span><span class="line" line="5"><span>                    is_weekend integer, seasons text, year integer,
</span></span><span class="line" line="6"><span>                    month integer, week integer, day integer, 
</span></span><span class="line" line="7"><span>                    hour integer, weekday integer, city text,
</span></span><span class="line" line="8"><span>                  country text
</span></span><span class="line" line="9"><span>              )
</span></span><span class="line" line="10"><span>&quot;&quot;&quot;
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>next(washington.itertuples(name=&#39;Bikes&#39;, index=False))
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>@task
</span></span><span class="line" line="2"><span>def load(data, path_and_name):
</span></span><span class="line" line="3"><span>    
</span></span><span class="line" line="4"><span>    data = list(data.itertuples(name=&#39;Bikes&#39;, index=False))
</span></span><span class="line" line="5"><span emptylineplaceholder="true">
</span></span><span class="line" line="6"><span>    insert_cmd = &quot;INSERT INTO bike_sharing VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)&quot;
</span></span><span class="line" line="7"><span>    with closing(sqlite3.connect(path_and_name)) as conn:
</span></span><span class="line" line="8"><span>        with closing(conn.cursor()) as cursor:
</span></span><span class="line" line="9"><span>            cursor.executemany(insert_cmd, data)
</span></span><span class="line" line="10"><span>            conn.commit()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><h2 id="_10-launch-a-pipeline" data-v-3a00cd39><a aria-current="page" href="/data-engineering/etl_pipes#_10-launch-a-pipeline" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->10. Launch a Pipeline<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><p data-v-3dd08768><!--[-->In the same fashion as before, we will combine our functions in a function decorated with <code class="" data-v-d83432f1><!--[-->flow<!--]--></code> to signal to prefec&#39;s scheduler that we have a DAG we would like to run.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>@flow(name=&#39;bikes-ETL&#39;)
</span></span><span class="line" line="2"><span>def my_etl():
</span></span><span class="line" line="3"><span>    
</span></span><span class="line" line="4"><span>    new_table = SQLiteScript(db=str(clean_db_path), script=script)
</span></span><span class="line" line="5"><span>    
</span></span><span class="line" line="6"><span>    london = extract_2(london_path)
</span></span><span class="line" line="7"><span>    seoul = extract_1(seoul_path)
</span></span><span class="line" line="8"><span>    wash_dc = extract_3(wash_dc_path)
</span></span><span class="line" line="9"><span>    
</span></span><span class="line" line="10"><span>    transformed = transform(london, seoul, wash_dc)
</span></span><span class="line" line="11"><span>        
</span></span><span class="line" line="12"><span>    data_loaded = load(transformed, clean_db_path)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-3dd08768><!--[-->Running our pipeline is as simple as calling the function. In addition, even though we did not pass in any parameters to our flow function, it can contain any number of them if we choose to.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>my_etl()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span>pd.read_sql_query(&quot;SELECT * FROM bike_sharing&quot;, sqlite3.connect(clean_db_path)).head()
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><h2 id="exercise-1" data-v-3a00cd39><a aria-current="page" href="/data-engineering/etl_pipes#exercise-1" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->Exercise<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><p data-v-3dd08768><!--[-->Change the function to unload (<code class="" data-v-d83432f1><!--[-->load ()<!--]--></code>) and make it save the results in <code class="" data-v-d83432f1><!--[-->parquet<!--]--></code> format. Run the pipeline again and make sure the results are the same as above by reading the data with pandas&#39; respective function for parquet files.<!--]--></p><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span></span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span></span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><div class="highlight-python prose-code" meta data-v-e0eae3fb><!----><!--[--><pre class="language-python shiki shiki-themes github-dark github-light" style=""><!--[--><code><span class="line" line="1"><span></span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-e0eae3fb data-v-333de9a2><span class="sr-only" data-v-333de9a2>Copy to clipboard</span><span class="icon-wrapper" data-v-333de9a2><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-333de9a2 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-a6937c2d><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><h2 id="_11-summary" data-v-3a00cd39><a aria-current="page" href="/data-engineering/etl_pipes#_11-summary" class="router-link-active router-link-exact-active" data-v-3a00cd39><!--[-->11. Summary<!--]--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-3a00cd39 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg></a></h2><ol data-v-18730953><!--[--><li data-v-f93bd10c><!--[-->Creating ETL pipes helps us automate the cleaning steps to prepare our datasets.<!--]--></li><li data-v-f93bd10c><!--[-->pandas <code class="" data-v-d83432f1><!--[-->pipe<!--]--></code> helps you chain functions that operate on a dataframe and return a dataframe, effectively helping us save time and lines of code.<!--]--></li><li data-v-f93bd10c><!--[-->Prefect helps us create, monitor, and schedule directed acyclic graphs represented via the steps of our cleaning process.<!--]--></li><!--]--></ol><style>html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}</style></div><!--]--><!--]--><!--[--><div class="docs-page-bottom" data-v-ba22cf1e data-v-bca27376><div class="edit-link" data-v-bca27376><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-bca27376 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="M21 12a1 1 0 0 0-1 1v6a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h6a1 1 0 0 0 0-2H5a3 3 0 0 0-3 3v14a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-6a1 1 0 0 0-1-1m-15 .76V17a1 1 0 0 0 1 1h4.24a1 1 0 0 0 .71-.29l6.92-6.93L21.71 8a1 1 0 0 0 0-1.42l-4.24-4.29a1 1 0 0 0-1.42 0l-2.82 2.83l-6.94 6.93a1 1 0 0 0-.29.71m10.76-8.35l2.83 2.83l-1.42 1.42l-2.83-2.83ZM8 13.17l5.93-5.93l2.83 2.83L10.83 16H8Z"/></svg><!--[--><a href="https://github.com/ramonpzg/edu_content/edit/main/.starters/default/content/3.data-engineering/3.etl_pipes.md" rel="noopener noreferrer" data-v-bca27376 data-v-d1c581be><!--[--><span data-v-bca27376> Edit this page on GitHub </span><!--]--></a><!--]--></div><!----></div><div class="docs-prev-next" data-v-ba22cf1e data-v-b1d5f4ad><a href="/data-engineering/data_cleaning" class="prev" data-v-b1d5f4ad><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-b1d5f4ad style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m11 17l-5-5m0 0l5-5m-5 5h12"/></svg><div class="wrapper" data-v-b1d5f4ad><span class="directory" data-v-b1d5f4ad>Data Engineering</span><span class="title" data-v-b1d5f4ad>Data Cleaning</span></div></a><a href="/data-engineering/data_pipelines_getting_started" class="next" data-v-b1d5f4ad><div class="wrapper" data-v-b1d5f4ad><span class="directory" data-v-b1d5f4ad>Data Engineering</span><span class="title" data-v-b1d5f4ad>Data Pipelines From Scratch</span></div><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-b1d5f4ad style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m13 7l5 5m0 0l-5 5m5-5H6"/></svg></a></div><!--]--></article><div class="toc" data-v-ba22cf1e><div class="toc-wrapper" data-v-ba22cf1e><button data-v-ba22cf1e><span class="title" data-v-ba22cf1e>Table of Contents</span><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-ba22cf1e style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 5l7 7l-7 7"/></svg></button><div class="docs-toc-wrapper" data-v-ba22cf1e><div class="docs-toc" data-v-ba22cf1e data-v-ea8b373f><!--[--><div class="docs-toc-title" data-v-ea8b373f><span data-v-ea8b373f>Table of Contents</span></div><ul class="docs-toc-links" data-v-ea8b373f data-v-8eeb45b0><!--[--><li class="depth-2" data-v-8eeb45b0><a href="#table-of-contents" class="" data-v-8eeb45b0>Table of Contents</a><!----></li><li class="depth-2" data-v-8eeb45b0><a href="#_1-overview" class="" data-v-8eeb45b0>1. Overview</a><!----></li><li class="depth-2" data-v-8eeb45b0><a href="#_2-learning-outcomes" class="" data-v-8eeb45b0>2. Learning Outcomes</a><!----></li><li class="depth-2" data-v-8eeb45b0><a href="#_3-data" class="" data-v-8eeb45b0>3. Data</a><!----></li><li class="depth-2" data-v-8eeb45b0><a href="#_4-tools" class="" data-v-8eeb45b0>4. Tools</a><!----></li><li class="depth-2" data-v-8eeb45b0><a href="#_5-data-pipelines" class="" data-v-8eeb45b0>5. Data Pipelines</a><!----></li><li class="depth-2" data-v-8eeb45b0><a href="#_6-pipelines" class="" data-v-8eeb45b0>6. ðŸ¼ pipelines</a><!----></li><li class="depth-2" data-v-8eeb45b0><a href="#exercise" class="" data-v-8eeb45b0>Exercise</a><!----></li><li class="depth-2" data-v-8eeb45b0><a href="#_7-extract" class="" data-v-8eeb45b0>7. Extract</a><!----></li><li class="depth-2" data-v-8eeb45b0><a href="#_8-transform" class="" data-v-8eeb45b0>8. Transform</a><!----></li><li class="depth-2" data-v-8eeb45b0><a href="#_9-load" class="" data-v-8eeb45b0>9. Load</a><!----></li><li class="depth-2" data-v-8eeb45b0><a href="#_10-launch-a-pipeline" class="" data-v-8eeb45b0>10. Launch a Pipeline</a><!----></li><li class="depth-2" data-v-8eeb45b0><a href="#exercise-1" class="" data-v-8eeb45b0>Exercise</a><!----></li><li class="depth-2" data-v-8eeb45b0><a href="#_11-summary" class="" data-v-8eeb45b0>11. Summary</a><!----></li><!--]--></ul><!--]--></div></div></div></div><!--]--></div></div><!--]--></main><footer data-v-5518b344 data-v-e014242d><div class="container pv-Mz5Z0z pc-W4Y2G5 footer-container" data-v-e014242d data-v-f95e3fe1><!--[--><div class="left" data-v-e014242d><a href="ramonpzg.github.io" rel="noopener" target="_blank" data-v-e014242d><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon left-icon" data-v-e014242d style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z"/></svg><p data-v-e014242d>With â¤ï¸ from the DR ðŸ‡©ðŸ‡´</p></a></div><div class="center" data-v-e014242d><!--[--><!--]--></div><div class="right" data-v-e014242d><!--[--><!--]--><!--[--><a href="https://github.com/ramonpzg/edu_content" rel="noopener noreferrer" target="_blank" title="ramonpzg/edu_content" aria-label="ramonpzg/edu_content" data-v-ab03fb65><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-ab03fb65 style="" width="1em" height="1em" viewBox="0 0 496 512" data-v-a6937c2d><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2"/></svg></a><a href="https://nuxt.com" rel="noopener noreferrer" target="_blank" title="Nuxt" aria-label="Nuxt" data-v-ab03fb65><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-ab03fb65 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-a6937c2d><path fill="currentColor" d="M13.464 19.83h8.922c.283 0 .562-.073.807-.21a1.6 1.6 0 0 0 .591-.574a1.53 1.53 0 0 0 .216-.783a1.53 1.53 0 0 0-.217-.782L17.792 7.414a1.6 1.6 0 0 0-.591-.573a1.65 1.65 0 0 0-.807-.21c-.283 0-.562.073-.807.21a1.6 1.6 0 0 0-.59.573L13.463 9.99L10.47 4.953a1.6 1.6 0 0 0-.591-.573a1.65 1.65 0 0 0-.807-.21c-.284 0-.562.073-.807.21a1.6 1.6 0 0 0-.591.573L.216 17.481a1.53 1.53 0 0 0-.217.782c0 .275.074.545.216.783a1.6 1.6 0 0 0 .59.574c.246.137.525.21.808.21h5.6c2.22 0 3.856-.946 4.982-2.79l2.733-4.593l1.464-2.457l4.395 7.382h-5.859Zm-6.341-2.46l-3.908-.002l5.858-9.842l2.923 4.921l-1.957 3.29c-.748 1.196-1.597 1.632-2.916 1.632"/></svg></a><!--]--></div><!--]--></div></footer></div></div><div id="teleports"></div><script type="application/json" id="__NUXT_DATA__" data-ssr="true" data-src="/data-engineering/etl_pipes/_payload.json">[{"state":1,"once":3752,"_errors":3754,"serverRendered":771,"path":7,"prerenderedAt":3757},["Reactive",2],{"$sdd-pages":3,"$sdd-surrounds":3601,"$sdd-globals":3615,"$scolor-mode":3617,"$sdd-navigation":3619,"$sicons":3698,"$sasideScroll":3743,"$sdocus-docs-aside-collapse-map-/":3744,"$sdocus-docs-aside-collapse-map-/introduction":3745,"$sdocus-docs-aside-collapse-map-/programming":3746,"$sdocus-docs-aside-collapse-map-/programming/terminal":3747,"$sdocus-docs-aside-collapse-map-/analytics":3748,"$sdocus-docs-aside-collapse-map-/data-engineering":3749,"$sdocus-docs-aside-collapse-map-/data-science":3750,"$sdocus-docs-aside-collapse-map-/ml-engineering":3751},["ShallowRef",4],["ShallowReactive",5],{"/data-engineering/etl_pipes":6},{"_path":7,"_dir":8,"_draft":9,"_partial":9,"_locale":10,"title":11,"description":10,"body":12,"_type":3595,"_id":3596,"_source":3597,"_file":3598,"_extension":3599,"layout":3600},"/data-engineering/etl_pipes","data-engineering",false,"","01 ETL Pipelines",{"type":13,"children":14,"toc":3578},"root",[15,23,33,42,56,63,176,182,187,196,204,209,217,225,231,236,241,264,270,278,283,288,322,327,329,620,625,631,636,703,708,801,824,829,860,872,885,890,913,936,957,980,1003,1009,1017,1025,1030,1038,1043,1138,1143,1157,1171,1185,1222,1230,1249,1261,1292,1327,1340,1345,1353,1364,1411,1442,1463,1468,1491,1546,1560,1573,1578,1592,1606,1618,1625,1637,1642,1681,1693,1700,1712,1751,1781,1844,1858,1872,1886,1891,1911,1942,2116,2130,2135,2149,2161,2189,2228,2233,2238,2269,2300,2331,2343,2356,2379,2384,2430,2442,2454,2477,2523,2529,2548,2561,2574,2587,2600,2606,2611,2643,2656,2668,2687,2701,2731,2777,2806,2812,2817,2845,2850,2904,3042,3048,3053,3076,3090,3103,3142,3229,3243,3326,3332,3344,3444,3449,3463,3477,3482,3502,3515,3528,3541,3547,3572],{"type":16,"tag":17,"props":18,"children":20},"element","h1",{"id":19},"_01-etl-pipelines",[21],{"type":22,"value":11},"text",{"type":16,"tag":24,"props":25,"children":26},"blockquote",{},[27],{"type":16,"tag":28,"props":29,"children":30},"p",{},[31],{"type":22,"value":32},"â€œWithout a systematic way to start and keep data clean, bad data will happen.â€ â€” Donato Diorio",{"type":16,"tag":28,"props":34,"children":35},{},[36],{"type":16,"tag":37,"props":38,"children":41},"img",{"alt":39,"src":40},"data_flow","https://cdn.dribbble.com/users/1752792/screenshots/5652276/media/12db9ebc672c30dcb4d0fd125f70fb41.png",[],{"type":16,"tag":28,"props":43,"children":44},{},[45,47],{"type":22,"value":46},"Source: ",{"type":16,"tag":48,"props":49,"children":53},"a",{"href":50,"rel":51},"https://dribbble.com/shots/5652276-User-flow/attachments/10982649?mode=media",[52],"nofollow",[54],{"type":22,"value":55},"Mindaugas SadÅ«nas",{"type":16,"tag":57,"props":58,"children":60},"h2",{"id":59},"table-of-contents",[61],{"type":22,"value":62},"Table of Contents",{"type":16,"tag":64,"props":65,"children":66},"ol",{},[67,77,86,95,104,113,131,140,149,158,167],{"type":16,"tag":68,"props":69,"children":70},"li",{},[71],{"type":16,"tag":48,"props":72,"children":74},{"href":73},"#1.-Overview",[75],{"type":22,"value":76},"Overview",{"type":16,"tag":68,"props":78,"children":79},{},[80],{"type":16,"tag":48,"props":81,"children":83},{"href":82},"#2.-Learning-Outcomes",[84],{"type":22,"value":85},"Learning Outcomes",{"type":16,"tag":68,"props":87,"children":88},{},[89],{"type":16,"tag":48,"props":90,"children":92},{"href":91},"#3.-Data",[93],{"type":22,"value":94},"Data",{"type":16,"tag":68,"props":96,"children":97},{},[98],{"type":16,"tag":48,"props":99,"children":101},{"href":100},"#4.-Tools",[102],{"type":22,"value":103},"Tools",{"type":16,"tag":68,"props":105,"children":106},{},[107],{"type":16,"tag":48,"props":108,"children":110},{"href":109},"#5.-Data-Pipelines",[111],{"type":22,"value":112},"Data Pipelines",{"type":16,"tag":68,"props":114,"children":115},{},[116],{"type":16,"tag":48,"props":117,"children":119},{"href":118},"#6.-%F0%9F%90%BC-%60pipe%60lines",[120,122,129],{"type":22,"value":121},"ðŸ¼ ",{"type":16,"tag":123,"props":124,"children":126},"code",{"className":125},[],[127],{"type":22,"value":128},"pipe",{"type":22,"value":130},"lines",{"type":16,"tag":68,"props":132,"children":133},{},[134],{"type":16,"tag":48,"props":135,"children":137},{"href":136},"#7.-Extract",[138],{"type":22,"value":139},"Extract",{"type":16,"tag":68,"props":141,"children":142},{},[143],{"type":16,"tag":48,"props":144,"children":146},{"href":145},"#8.-Transform",[147],{"type":22,"value":148},"Transform",{"type":16,"tag":68,"props":150,"children":151},{},[152],{"type":16,"tag":48,"props":153,"children":155},{"href":154},"#9.-Load",[156],{"type":22,"value":157},"Load",{"type":16,"tag":68,"props":159,"children":160},{},[161],{"type":16,"tag":48,"props":162,"children":164},{"href":163},"#10.-Launch-a-Pipeline",[165],{"type":22,"value":166},"Launch a Pipeline",{"type":16,"tag":68,"props":168,"children":169},{},[170],{"type":16,"tag":48,"props":171,"children":173},{"href":172},"#11.-Summary",[174],{"type":22,"value":175},"Summary",{"type":16,"tag":57,"props":177,"children":179},{"id":178},"_1-overview",[180],{"type":22,"value":181},"1. Overview",{"type":16,"tag":28,"props":183,"children":184},{},[185],{"type":22,"value":186},"You are a data analyst working at Beautiful Analytics, and you have been given a project in which you will work using data generated from shared bikes systems in the cities of London (England, UK), Seoul (South Korea), and Washington (DC, USA). Your customer's are the governments of each city and what they want to solve is the same,",{"type":16,"tag":28,"props":188,"children":189},{},[190],{"type":16,"tag":191,"props":192,"children":193},"strong",{},[194],{"type":22,"value":195},"Challenge #1",{"type":16,"tag":24,"props":197,"children":198},{},[199],{"type":16,"tag":28,"props":200,"children":201},{},[202],{"type":22,"value":203},"To predict/forecast how many bikes they will to need to have available in the city at every hour of the dat for the next few years?",{"type":16,"tag":28,"props":205,"children":206},{},[207],{"type":22,"value":208},"Each government captures similar data but, as you can imagine, they all use different words and measure similar variables in different ways. This means that our first job before we can answer the question above is to fix the data and put it in amore user-friendly way. While we are at it, we should also try and automate our pipeline so that the next time we need to read, transform, and load new versions of all the data sources for this project, we could do so with the click of a button rather than having to write everything again from scratch. So our first real problem is,",{"type":16,"tag":28,"props":210,"children":211},{},[212],{"type":16,"tag":191,"props":213,"children":214},{},[215],{"type":22,"value":216},"Challenge #0",{"type":16,"tag":24,"props":218,"children":219},{},[220],{"type":16,"tag":28,"props":221,"children":222},{},[223],{"type":22,"value":224},"Create a data pipeline that extracts, transforms and loads the necessary data for the task at hand.",{"type":16,"tag":57,"props":226,"children":228},{"id":227},"_2-learning-outcomes",[229],{"type":22,"value":230},"2. Learning Outcomes",{"type":16,"tag":28,"props":232,"children":233},{},[234],{"type":22,"value":235},"Before we get started, let's go over the learning outcomes for this section of the workshop.",{"type":16,"tag":28,"props":237,"children":238},{},[239],{"type":22,"value":240},"By the end of this lesson you will be able to,",{"type":16,"tag":64,"props":242,"children":243},{},[244,249,254,259],{"type":16,"tag":68,"props":245,"children":246},{},[247],{"type":22,"value":248},"Discuss what ETL and ELT Pipelines are.",{"type":16,"tag":68,"props":250,"children":251},{},[252],{"type":22,"value":253},"Understand how to read and combine data that comes from different sources.",{"type":16,"tag":68,"props":255,"children":256},{},[257],{"type":22,"value":258},"Create data pipelines using pandas and prefect.",{"type":16,"tag":68,"props":260,"children":261},{},[262],{"type":22,"value":263},"Understand how to visualize the pipelines you create to help you with their development.",{"type":16,"tag":57,"props":265,"children":267},{"id":266},"_3-data",[268],{"type":22,"value":269},"3. Data",{"type":16,"tag":28,"props":271,"children":272},{},[273],{"type":16,"tag":37,"props":274,"children":277},{"alt":275,"src":276},"bikes","https://images.pexels.com/photos/11803508/pexels-photo-11803508.jpeg?cs=srgb&dl=pexels-%D1%80%D0%BE%D0%BC%D0%B0%D0%BD-%D0%BA%D0%B0%D0%B4%D1%8C%D0%BA%D0%B0%D0%BB%D0%BE%D0%B2-11803508.jpg&fm=jpg",[],{"type":16,"tag":28,"props":279,"children":280},{},[281],{"type":22,"value":282},"All three data files contain similar information about how many bicycles have been rented each hour, day, week and months for several years and for each city government we are working with.",{"type":16,"tag":28,"props":284,"children":285},{},[286],{"type":22,"value":287},"You can get more information about the data of each city using the following links.",{"type":16,"tag":289,"props":290,"children":291},"ul",{},[292,302,312],{"type":16,"tag":68,"props":293,"children":294},{},[295],{"type":16,"tag":48,"props":296,"children":299},{"href":297,"rel":298},"https://archive.ics.uci.edu/ml/datasets/Seoul+Bike+Sharing+Demand#",[52],[300],{"type":22,"value":301},"Seoul, Korea del Sur",{"type":16,"tag":68,"props":303,"children":304},{},[305],{"type":16,"tag":48,"props":306,"children":309},{"href":307,"rel":308},"https://www.kaggle.com/hmavrodiev/london-bike-sharing-dataset",[52],[310],{"type":22,"value":311},"London, England, UK",{"type":16,"tag":68,"props":313,"children":314},{},[315],{"type":16,"tag":48,"props":316,"children":319},{"href":317,"rel":318},"https://www.kaggle.com/marklvl/bike-sharing-dataset?select=hour.csv",[52],[320],{"type":22,"value":321},"Washington, DC, USA",{"type":16,"tag":28,"props":323,"children":324},{},[325],{"type":22,"value":326},"Here are the variables that appear in the three data files.",{"type":22,"value":328},"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",{"type":16,"tag":330,"props":331,"children":332},"table",{},[333,358],{"type":16,"tag":334,"props":335,"children":336},"thead",{},[337],{"type":16,"tag":338,"props":339,"children":340},"tr",{},[341,348,353],{"type":16,"tag":342,"props":343,"children":345},"th",{"align":344},"center",[346],{"type":22,"value":347},"London",{"type":16,"tag":342,"props":349,"children":350},{"align":344},[351],{"type":22,"value":352},"Seoul",{"type":16,"tag":342,"props":354,"children":355},{"align":344},[356],{"type":22,"value":357},"Washington",{"type":16,"tag":359,"props":360,"children":361},"tbody",{},[362,380,396,414,431,448,464,482,499,517,534,549,563,577,592,606],{"type":16,"tag":338,"props":363,"children":364},{},[365,371,375],{"type":16,"tag":366,"props":367,"children":368},"td",{"align":344},[369],{"type":22,"value":370},"date",{"type":16,"tag":366,"props":372,"children":373},{"align":344},[374],{"type":22,"value":370},{"type":16,"tag":366,"props":376,"children":377},{"align":344},[378],{"type":22,"value":379},"instant",{"type":16,"tag":338,"props":381,"children":382},{},[383,388,392],{"type":16,"tag":366,"props":384,"children":385},{"align":344},[386],{"type":22,"value":387},"count",{"type":16,"tag":366,"props":389,"children":390},{"align":344},[391],{"type":22,"value":387},{"type":16,"tag":366,"props":393,"children":394},{"align":344},[395],{"type":22,"value":370},{"type":16,"tag":338,"props":397,"children":398},{},[399,404,409],{"type":16,"tag":366,"props":400,"children":401},{"align":344},[402],{"type":22,"value":403},"temperature",{"type":16,"tag":366,"props":405,"children":406},{"align":344},[407],{"type":22,"value":408},"hour",{"type":16,"tag":366,"props":410,"children":411},{"align":344},[412],{"type":22,"value":413},"seasons",{"type":16,"tag":338,"props":415,"children":416},{},[417,422,426],{"type":16,"tag":366,"props":418,"children":419},{"align":344},[420],{"type":22,"value":421},"t2",{"type":16,"tag":366,"props":423,"children":424},{"align":344},[425],{"type":22,"value":403},{"type":16,"tag":366,"props":427,"children":428},{"align":344},[429],{"type":22,"value":430},"year",{"type":16,"tag":338,"props":432,"children":433},{},[434,439,443],{"type":16,"tag":366,"props":435,"children":436},{"align":344},[437],{"type":22,"value":438},"humidity",{"type":16,"tag":366,"props":440,"children":441},{"align":344},[442],{"type":22,"value":438},{"type":16,"tag":366,"props":444,"children":445},{"align":344},[446],{"type":22,"value":447},"month",{"type":16,"tag":338,"props":449,"children":450},{},[451,456,460],{"type":16,"tag":366,"props":452,"children":453},{"align":344},[454],{"type":22,"value":455},"wind_speed",{"type":16,"tag":366,"props":457,"children":458},{"align":344},[459],{"type":22,"value":455},{"type":16,"tag":366,"props":461,"children":462},{"align":344},[463],{"type":22,"value":408},{"type":16,"tag":338,"props":465,"children":466},{},[467,472,477],{"type":16,"tag":366,"props":468,"children":469},{"align":344},[470],{"type":22,"value":471},"weather_code",{"type":16,"tag":366,"props":473,"children":474},{"align":344},[475],{"type":22,"value":476},"visibility",{"type":16,"tag":366,"props":478,"children":479},{"align":344},[480],{"type":22,"value":481},"is_holiday",{"type":16,"tag":338,"props":483,"children":484},{},[485,489,494],{"type":16,"tag":366,"props":486,"children":487},{"align":344},[488],{"type":22,"value":481},{"type":16,"tag":366,"props":490,"children":491},{"align":344},[492],{"type":22,"value":493},"dew_point_temp",{"type":16,"tag":366,"props":495,"children":496},{"align":344},[497],{"type":22,"value":498},"weekday",{"type":16,"tag":338,"props":500,"children":501},{},[502,507,512],{"type":16,"tag":366,"props":503,"children":504},{"align":344},[505],{"type":22,"value":506},"is_weekend",{"type":16,"tag":366,"props":508,"children":509},{"align":344},[510],{"type":22,"value":511},"solar_radiation",{"type":16,"tag":366,"props":513,"children":514},{"align":344},[515],{"type":22,"value":516},"workingday",{"type":16,"tag":338,"props":518,"children":519},{},[520,524,529],{"type":16,"tag":366,"props":521,"children":522},{"align":344},[523],{"type":22,"value":413},{"type":16,"tag":366,"props":525,"children":526},{"align":344},[527],{"type":22,"value":528},"rainfall",{"type":16,"tag":366,"props":530,"children":531},{"align":344},[532],{"type":22,"value":533},"weathersit",{"type":16,"tag":338,"props":535,"children":536},{},[537,540,545],{"type":16,"tag":366,"props":538,"children":539},{"align":344},[],{"type":16,"tag":366,"props":541,"children":542},{"align":344},[543],{"type":22,"value":544},"snowfall",{"type":16,"tag":366,"props":546,"children":547},{"align":344},[548],{"type":22,"value":403},{"type":16,"tag":338,"props":550,"children":551},{},[552,555,559],{"type":16,"tag":366,"props":553,"children":554},{"align":344},[],{"type":16,"tag":366,"props":556,"children":557},{"align":344},[558],{"type":22,"value":413},{"type":16,"tag":366,"props":560,"children":561},{"align":344},[562],{"type":22,"value":387},{"type":16,"tag":338,"props":564,"children":565},{},[566,569,573],{"type":16,"tag":366,"props":567,"children":568},{"align":344},[],{"type":16,"tag":366,"props":570,"children":571},{"align":344},[572],{"type":22,"value":481},{"type":16,"tag":366,"props":574,"children":575},{"align":344},[576],{"type":22,"value":438},{"type":16,"tag":338,"props":578,"children":579},{},[580,583,588],{"type":16,"tag":366,"props":581,"children":582},{"align":344},[],{"type":16,"tag":366,"props":584,"children":585},{"align":344},[586],{"type":22,"value":587},"functioning_day",{"type":16,"tag":366,"props":589,"children":590},{"align":344},[591],{"type":22,"value":455},{"type":16,"tag":338,"props":593,"children":594},{},[595,598,601],{"type":16,"tag":366,"props":596,"children":597},{"align":344},[],{"type":16,"tag":366,"props":599,"children":600},{"align":344},[],{"type":16,"tag":366,"props":602,"children":603},{"align":344},[604],{"type":22,"value":605},"casual",{"type":16,"tag":338,"props":607,"children":608},{},[609,612,615],{"type":16,"tag":366,"props":610,"children":611},{"align":344},[],{"type":16,"tag":366,"props":613,"children":614},{"align":344},[],{"type":16,"tag":366,"props":616,"children":617},{"align":344},[618],{"type":22,"value":619},"registered",{"type":16,"tag":28,"props":621,"children":622},{},[623],{"type":22,"value":624},"Since all of these datasets where generated with different business logic and, most likely, by completely different systems, we can certainly expect more inconsistencies than just unmatching column names, numerical formats, and data collected. We will walk through a few cleaning steps after we discuss the tools we will be using today.",{"type":16,"tag":57,"props":626,"children":628},{"id":627},"_4-tools",[629],{"type":22,"value":630},"4. Tools",{"type":16,"tag":28,"props":632,"children":633},{},[634],{"type":22,"value":635},"The tools that we will use in the workshop are the following.",{"type":16,"tag":289,"props":637,"children":638},{},[639,651,679,691],{"type":16,"tag":68,"props":640,"children":641},{},[642,649],{"type":16,"tag":48,"props":643,"children":646},{"href":644,"rel":645},"https://pandas.pydata.org/",[52],[647],{"type":22,"value":648},"pandas",{"type":22,"value":650}," - \"is a fast, powerful, flexible and easy to use open source data analysis and manipulation tool, built on top of the Python programming language.\"",{"type":16,"tag":68,"props":652,"children":653},{},[654,661,663,669,671,677],{"type":16,"tag":48,"props":655,"children":658},{"href":656,"rel":657},"https://docs.prefect.io/",[52],[659],{"type":22,"value":660},"Prefect",{"type":22,"value":662}," - \"is a new workflow management system, designed for a modern infrastructure and powered by the open source workflow engine, Prefect Core. Users organize tasks into ",{"type":16,"tag":123,"props":664,"children":666},{"className":665},[],[667],{"type":22,"value":668},"task",{"type":22,"value":670},"'s and",{"type":16,"tag":123,"props":672,"children":674},{"className":673},[],[675],{"type":22,"value":676}," flow",{"type":22,"value":678},"'s, and Prefect takes care of the rest.\"",{"type":16,"tag":68,"props":680,"children":681},{},[682,689],{"type":16,"tag":48,"props":683,"children":686},{"href":684,"rel":685},"https://docs.python.org/3/library/sqlite3.html",[52],[687],{"type":22,"value":688},"sqlite3",{"type":22,"value":690}," - \"SQLite is a library written in C that provides a lightweight disk-based database that does not require a separate server process and allows the database to be accessed using a non-standard variant of the SQL query language.\"",{"type":16,"tag":68,"props":692,"children":693},{},[694,701],{"type":16,"tag":48,"props":695,"children":698},{"href":696,"rel":697},"https://docs.python.org/3/library/pathlib.html",[52],[699],{"type":22,"value":700},"pathlib",{"type":22,"value":702}," - allows us to manipulate paths as if they were python objects.",{"type":16,"tag":28,"props":704,"children":705},{},[706],{"type":22,"value":707},"Before we continue, let's load the modules we'll need and examine our datasets.",{"type":16,"tag":709,"props":710,"children":714},"pre",{"className":711,"code":712,"language":713,"meta":10,"style":10},"language-python shiki shiki-themes github-dark github-light","import pandas as pd\nfrom prefect import flow, task\nimport sqlite3\nfrom contextlib import closing\nfrom pathlib import Path\n\n\npd.options.display.max_rows = None\npd.options.display.max_columns = None\n","python",[715],{"type":16,"tag":123,"props":716,"children":717},{"__ignoreMap":10},[718,729,738,747,756,765,775,783,792],{"type":16,"tag":719,"props":720,"children":723},"span",{"class":721,"line":722},"line",1,[724],{"type":16,"tag":719,"props":725,"children":726},{},[727],{"type":22,"value":728},"import pandas as pd\n",{"type":16,"tag":719,"props":730,"children":732},{"class":721,"line":731},2,[733],{"type":16,"tag":719,"props":734,"children":735},{},[736],{"type":22,"value":737},"from prefect import flow, task\n",{"type":16,"tag":719,"props":739,"children":741},{"class":721,"line":740},3,[742],{"type":16,"tag":719,"props":743,"children":744},{},[745],{"type":22,"value":746},"import sqlite3\n",{"type":16,"tag":719,"props":748,"children":750},{"class":721,"line":749},4,[751],{"type":16,"tag":719,"props":752,"children":753},{},[754],{"type":22,"value":755},"from contextlib import closing\n",{"type":16,"tag":719,"props":757,"children":759},{"class":721,"line":758},5,[760],{"type":16,"tag":719,"props":761,"children":762},{},[763],{"type":22,"value":764},"from pathlib import Path\n",{"type":16,"tag":719,"props":766,"children":768},{"class":721,"line":767},6,[769],{"type":16,"tag":719,"props":770,"children":772},{"emptyLinePlaceholder":771},true,[773],{"type":22,"value":774},"\n",{"type":16,"tag":719,"props":776,"children":778},{"class":721,"line":777},7,[779],{"type":16,"tag":719,"props":780,"children":781},{"emptyLinePlaceholder":771},[782],{"type":22,"value":774},{"type":16,"tag":719,"props":784,"children":786},{"class":721,"line":785},8,[787],{"type":16,"tag":719,"props":788,"children":789},{},[790],{"type":22,"value":791},"pd.options.display.max_rows = None\n",{"type":16,"tag":719,"props":793,"children":795},{"class":721,"line":794},9,[796],{"type":16,"tag":719,"props":797,"children":798},{},[799],{"type":22,"value":800},"pd.options.display.max_columns = None\n",{"type":16,"tag":709,"props":802,"children":804},{"className":711,"code":803,"language":713,"meta":10,"style":10},"path = Path().cwd().parent.joinpath(\"data\", \"01_part\")\npath\n",[805],{"type":16,"tag":123,"props":806,"children":807},{"__ignoreMap":10},[808,816],{"type":16,"tag":719,"props":809,"children":810},{"class":721,"line":722},[811],{"type":16,"tag":719,"props":812,"children":813},{},[814],{"type":22,"value":815},"path = Path().cwd().parent.joinpath(\"data\", \"01_part\")\n",{"type":16,"tag":719,"props":817,"children":818},{"class":721,"line":731},[819],{"type":16,"tag":719,"props":820,"children":821},{},[822],{"type":22,"value":823},"path\n",{"type":16,"tag":28,"props":825,"children":826},{},[827],{"type":22,"value":828},"We will need paths to all of our datasets.",{"type":16,"tag":709,"props":830,"children":832},{"className":711,"code":831,"language":713,"meta":10,"style":10},"london_path = path.joinpath('raw', 'london', 'london_bikes.db')\nseoul_path = path.joinpath('raw', 'seoul', 'SeoulBikeData.csv')\nwash_dc_path = path.joinpath('raw', 'wash_dc', 'washington.json')\n",[833],{"type":16,"tag":123,"props":834,"children":835},{"__ignoreMap":10},[836,844,852],{"type":16,"tag":719,"props":837,"children":838},{"class":721,"line":722},[839],{"type":16,"tag":719,"props":840,"children":841},{},[842],{"type":22,"value":843},"london_path = path.joinpath('raw', 'london', 'london_bikes.db')\n",{"type":16,"tag":719,"props":845,"children":846},{"class":721,"line":731},[847],{"type":16,"tag":719,"props":848,"children":849},{},[850],{"type":22,"value":851},"seoul_path = path.joinpath('raw', 'seoul', 'SeoulBikeData.csv')\n",{"type":16,"tag":719,"props":853,"children":854},{"class":721,"line":740},[855],{"type":16,"tag":719,"props":856,"children":857},{},[858],{"type":22,"value":859},"wash_dc_path = path.joinpath('raw', 'wash_dc', 'washington.json')\n",{"type":16,"tag":28,"props":861,"children":862},{},[863,865,870],{"type":22,"value":864},"The data we have about the bikes in London is in a SQLite database and to read it, we first need to create a connection to its database using the ",{"type":16,"tag":123,"props":866,"children":868},{"className":867},[],[869],{"type":22,"value":688},{"type":22,"value":871}," package.",{"type":16,"tag":28,"props":873,"children":874},{},[875,877,883],{"type":22,"value":876},"The next step is to use the pandas ",{"type":16,"tag":123,"props":878,"children":880},{"className":879},[],[881],{"type":22,"value":882},"read_sql_query",{"type":22,"value":884}," function to read the data. This function takes two arguments, the connection to our databaset and the query to get the data we want.",{"type":16,"tag":28,"props":886,"children":887},{},[888],{"type":22,"value":889},"Note that we can make quite elaborate queries to get a subset of the data we'll be working with, but for our purposes this is not necessary.",{"type":16,"tag":709,"props":891,"children":893},{"className":711,"code":892,"language":713,"meta":10,"style":10},"conn = sqlite3.connect(london_path)\nquery = \"SELECT * FROM uk_bikes\"\n",[894],{"type":16,"tag":123,"props":895,"children":896},{"__ignoreMap":10},[897,905],{"type":16,"tag":719,"props":898,"children":899},{"class":721,"line":722},[900],{"type":16,"tag":719,"props":901,"children":902},{},[903],{"type":22,"value":904},"conn = sqlite3.connect(london_path)\n",{"type":16,"tag":719,"props":906,"children":907},{"class":721,"line":731},[908],{"type":16,"tag":719,"props":909,"children":910},{},[911],{"type":22,"value":912},"query = \"SELECT * FROM uk_bikes\"\n",{"type":16,"tag":709,"props":914,"children":916},{"className":711,"code":915,"language":713,"meta":10,"style":10},"london = pd.read_sql_query(query, conn)\nlondon.head()\n",[917],{"type":16,"tag":123,"props":918,"children":919},{"__ignoreMap":10},[920,928],{"type":16,"tag":719,"props":921,"children":922},{"class":721,"line":722},[923],{"type":16,"tag":719,"props":924,"children":925},{},[926],{"type":22,"value":927},"london = pd.read_sql_query(query, conn)\n",{"type":16,"tag":719,"props":929,"children":930},{"class":721,"line":731},[931],{"type":16,"tag":719,"props":932,"children":933},{},[934],{"type":22,"value":935},"london.head()\n",{"type":16,"tag":28,"props":937,"children":938},{},[939,941,947,949,955],{"type":22,"value":940},"Seoul data is in text form and separated by commas, and the data for DC is in JSON format. For these two we can use ",{"type":16,"tag":123,"props":942,"children":944},{"className":943},[],[945],{"type":22,"value":946},"pd.read_csv",{"type":22,"value":948}," and",{"type":16,"tag":123,"props":950,"children":952},{"className":951},[],[953],{"type":22,"value":954}," pd.read_json",{"type":22,"value":956},", respectively.",{"type":16,"tag":709,"props":958,"children":960},{"className":711,"code":959,"language":713,"meta":10,"style":10},"seoul = pd.read_csv(seoul_path)\nseoul.head()\n",[961],{"type":16,"tag":123,"props":962,"children":963},{"__ignoreMap":10},[964,972],{"type":16,"tag":719,"props":965,"children":966},{"class":721,"line":722},[967],{"type":16,"tag":719,"props":968,"children":969},{},[970],{"type":22,"value":971},"seoul = pd.read_csv(seoul_path)\n",{"type":16,"tag":719,"props":973,"children":974},{"class":721,"line":731},[975],{"type":16,"tag":719,"props":976,"children":977},{},[978],{"type":22,"value":979},"seoul.head()\n",{"type":16,"tag":709,"props":981,"children":983},{"className":711,"code":982,"language":713,"meta":10,"style":10},"washington = pd.read_json(wash_dc_path)\nwashington.head()\n",[984],{"type":16,"tag":123,"props":985,"children":986},{"__ignoreMap":10},[987,995],{"type":16,"tag":719,"props":988,"children":989},{"class":721,"line":722},[990],{"type":16,"tag":719,"props":991,"children":992},{},[993],{"type":22,"value":994},"washington = pd.read_json(wash_dc_path)\n",{"type":16,"tag":719,"props":996,"children":997},{"class":721,"line":731},[998],{"type":16,"tag":719,"props":999,"children":1000},{},[1001],{"type":22,"value":1002},"washington.head()\n",{"type":16,"tag":57,"props":1004,"children":1006},{"id":1005},"_5-data-pipelines",[1007],{"type":22,"value":1008},"5. Data Pipelines",{"type":16,"tag":28,"props":1010,"children":1011},{},[1012],{"type":16,"tag":37,"props":1013,"children":1016},{"alt":1014,"src":1015},"etl_pipe","https://databricks.com/wp-content/uploads/2021/05/ETL-Process.jpg",[],{"type":16,"tag":28,"props":1018,"children":1019},{},[1020],{"type":16,"tag":191,"props":1021,"children":1022},{},[1023],{"type":22,"value":1024},"What are ETL Pipelines?",{"type":16,"tag":28,"props":1026,"children":1027},{},[1028],{"type":22,"value":1029},"The acronym ETL stands for Extract, Transform, and Load, and it is the process by which organizations' data passes through before it reaches the hands of data consumers. Which can be analysts, marketers, sales people, customers, and so on...",{"type":16,"tag":28,"props":1031,"children":1032},{},[1033],{"type":16,"tag":191,"props":1034,"children":1035},{},[1036],{"type":22,"value":1037},"Why should you learn how to create them?",{"type":16,"tag":28,"props":1039,"children":1040},{},[1041],{"type":22,"value":1042},"As data professionals, our task is to create value for our organizations, our clients and our collaborators using some of, if not all, the data that we have at our disposal. However, to get the most out of our organization's data, we often need",{"type":16,"tag":64,"props":1044,"children":1045},{},[1046,1079,1111],{"type":16,"tag":68,"props":1047,"children":1048},{},[1049,1051],{"type":22,"value":1050},"Information about the process by which it was generated, For example,\n",{"type":16,"tag":289,"props":1052,"children":1053},{},[1054,1059,1064,1069,1074],{"type":16,"tag":68,"props":1055,"children":1056},{},[1057],{"type":22,"value":1058},"Point of sale",{"type":16,"tag":68,"props":1060,"children":1061},{},[1062],{"type":22,"value":1063},"Clicks on an online marketplace like Amazon, Etzy, Ebay, ect.",{"type":16,"tag":68,"props":1065,"children":1066},{},[1067],{"type":22,"value":1068},"Epidemiological studies",{"type":16,"tag":68,"props":1070,"children":1071},{},[1072],{"type":22,"value":1073},"A/B Test Results",{"type":16,"tag":68,"props":1075,"children":1076},{},[1077],{"type":22,"value":1078},"...",{"type":16,"tag":68,"props":1080,"children":1081},{},[1082,1084],{"type":22,"value":1083},"Information about the transformations that occurred during the cleaning and merging process. For instance,\n",{"type":16,"tag":289,"props":1085,"children":1086},{},[1087,1092,1097,1102,1107],{"type":16,"tag":68,"props":1088,"children":1089},{},[1090],{"type":22,"value":1091},"Celcius degrees were converted into fahrenheit",{"type":16,"tag":68,"props":1093,"children":1094},{},[1095],{"type":22,"value":1096},"Prices in Chilean pesos were converted to {insert preferred ðŸ’¸}",{"type":16,"tag":68,"props":1098,"children":1099},{},[1100],{"type":22,"value":1101},"Non-numerical and unavailable observations now contain \"Not Available\" or \"Unknown\"",{"type":16,"tag":68,"props":1103,"children":1104},{},[1105],{"type":22,"value":1106},"Numerical variables now contain the average or median value in observations where that data is missing. For example, a variable with the salary of all employees of a company now contains $40,000$ / year USD in the values that were not available becuase this was the median value.",{"type":16,"tag":68,"props":1108,"children":1109},{},[1110],{"type":22,"value":1078},{"type":16,"tag":68,"props":1112,"children":1113},{},[1114,1116],{"type":22,"value":1115},"Information about how the data was stored and where. For instance,\n",{"type":16,"tag":289,"props":1117,"children":1118},{},[1119,1124,1129,1134],{"type":16,"tag":68,"props":1120,"children":1121},{},[1122],{"type":22,"value":1123},"Parquet format",{"type":16,"tag":68,"props":1125,"children":1126},{},[1127],{"type":22,"value":1128},"NOSQL or SQL database",{"type":16,"tag":68,"props":1130,"children":1131},{},[1132],{"type":22,"value":1133},"CSV",{"type":16,"tag":68,"props":1135,"children":1136},{},[1137],{"type":22,"value":1078},{"type":16,"tag":28,"props":1139,"children":1140},{},[1141],{"type":22,"value":1142},"Understanding how the three processes described above flow will help us have more knowledge about the data that we are going to use, and how to best access it, transform it, and model it before we put it to good use.",{"type":16,"tag":28,"props":1144,"children":1145},{},[1146,1148,1155],{"type":22,"value":1147},"Let's walk through an example of a data pipeline using data from wildfires between 1983-2020 in the United States. You can find more information about the dataset ",{"type":16,"tag":48,"props":1149,"children":1152},{"href":1150,"rel":1151},"https://www.kaggle.com/kkhandekar/total-wildfires-acres-affected-1983-2020",[52],[1153],{"type":22,"value":1154},"here",{"type":22,"value":1156},".",{"type":16,"tag":709,"props":1158,"children":1160},{"className":711,"code":1159,"language":713,"meta":10,"style":10},"example_data_in = path.joinpath(\"example\", \"federal_firefighting_costs.csv\")\n",[1161],{"type":16,"tag":123,"props":1162,"children":1163},{"__ignoreMap":10},[1164],{"type":16,"tag":719,"props":1165,"children":1166},{"class":721,"line":722},[1167],{"type":16,"tag":719,"props":1168,"children":1169},{},[1170],{"type":22,"value":1159},{"type":16,"tag":709,"props":1172,"children":1174},{"className":711,"code":1173,"language":713,"meta":10,"style":10},"pd.read_csv(example_data_in).head()\n",[1175],{"type":16,"tag":123,"props":1176,"children":1177},{"__ignoreMap":10},[1178],{"type":16,"tag":719,"props":1179,"children":1180},{"class":721,"line":722},[1181],{"type":16,"tag":719,"props":1182,"children":1183},{},[1184],{"type":22,"value":1173},{"type":16,"tag":28,"props":1186,"children":1187},{},[1188,1190,1196,1198,1204,1206,1212,1214,1220],{"type":22,"value":1189},"As you can see, most columns contain a ",{"type":16,"tag":123,"props":1191,"children":1193},{"className":1192},[],[1194],{"type":22,"value":1195},"$",{"type":22,"value":1197}," dollar sign and some ",{"type":16,"tag":123,"props":1199,"children":1201},{"className":1200},[],[1202],{"type":22,"value":1203},",",{"type":22,"value":1205}," commas, and because this forces Python to treat numbers as objects rather than ",{"type":16,"tag":123,"props":1207,"children":1209},{"className":1208},[],[1210],{"type":22,"value":1211},"int",{"type":22,"value":1213},"'s or ",{"type":16,"tag":123,"props":1215,"children":1217},{"className":1216},[],[1218],{"type":22,"value":1219},"float",{"type":22,"value":1221},"'s, we will have to remove these signs in our transformation step after extracting the data and before loading a clean version of it.",{"type":16,"tag":289,"props":1223,"children":1224},{},[1225],{"type":16,"tag":68,"props":1226,"children":1227},{},[1228],{"type":22,"value":1229},"About Prefect\nAt its core, prefect create Directed Acyclic Graphs where nodes are functions of computations linking one step to another.",{"type":16,"tag":28,"props":1231,"children":1232},{},[1233,1235,1240,1242,1247],{"type":22,"value":1234},"When you use prefect you have two important APIs, one is the ",{"type":16,"tag":123,"props":1236,"children":1238},{"className":1237},[],[1239],{"type":22,"value":668},{"type":22,"value":1241}," API and the other is",{"type":16,"tag":123,"props":1243,"children":1245},{"className":1244},[],[1246],{"type":22,"value":676},{"type":22,"value":1248},". The former is used as a decorator on top of functions and this allows us to signal to prefect that our decorated functions can become a node in a graph. The latter represents a set the graph we want to run and it is composed of one or multiple tasks, or even multiple flows.",{"type":16,"tag":28,"props":1250,"children":1251},{},[1252,1254,1259],{"type":22,"value":1253},"For example, let's create 3 functions, one that extracts the data we need, another that takes anything that is non-numerical out of our variables, and another that loads the cleaned data somewhere. Each function will have the ",{"type":16,"tag":123,"props":1255,"children":1257},{"className":1256},[],[1258],{"type":22,"value":668},{"type":22,"value":1260}," decorator on top of it.",{"type":16,"tag":709,"props":1262,"children":1264},{"className":711,"code":1263,"language":713,"meta":10,"style":10},"@task(name=\"Get Data!\")\ndef extract(path):\n    return pd.read_csv(path)\n",[1265],{"type":16,"tag":123,"props":1266,"children":1267},{"__ignoreMap":10},[1268,1276,1284],{"type":16,"tag":719,"props":1269,"children":1270},{"class":721,"line":722},[1271],{"type":16,"tag":719,"props":1272,"children":1273},{},[1274],{"type":22,"value":1275},"@task(name=\"Get Data!\")\n",{"type":16,"tag":719,"props":1277,"children":1278},{"class":721,"line":731},[1279],{"type":16,"tag":719,"props":1280,"children":1281},{},[1282],{"type":22,"value":1283},"def extract(path):\n",{"type":16,"tag":719,"props":1285,"children":1286},{"class":721,"line":740},[1287],{"type":16,"tag":719,"props":1288,"children":1289},{},[1290],{"type":22,"value":1291},"    return pd.read_csv(path)\n",{"type":16,"tag":28,"props":1293,"children":1294},{},[1295,1297,1302,1304,1309,1311,1317,1319,1325],{"type":22,"value":1296},"As you saw above, only the last 5 variables have commas (",{"type":16,"tag":123,"props":1298,"children":1300},{"className":1299},[],[1301],{"type":22,"value":1203},{"type":22,"value":1303},") and dollar symbols (",{"type":16,"tag":123,"props":1305,"children":1307},{"className":1306},[],[1308],{"type":22,"value":1195},{"type":22,"value":1310},") so we will replace both with an empty space (",{"type":16,"tag":123,"props":1312,"children":1314},{"className":1313},[],[1315],{"type":22,"value":1316},"\"\"",{"type":22,"value":1318},") using a ",{"type":16,"tag":123,"props":1320,"children":1322},{"className":1321},[],[1323],{"type":22,"value":1324},"for",{"type":22,"value":1326}," loop.",{"type":16,"tag":28,"props":1328,"children":1329},{},[1330,1332,1338],{"type":22,"value":1331},"For the download process, we will save the data in the ",{"type":16,"tag":123,"props":1333,"children":1335},{"className":1334},[],[1336],{"type":22,"value":1337},"parquet",{"type":22,"value":1339}," format. This is one of the most popular formats to save data in due to its compression capabilities, orientation, and speed gains in analytical workloads.",{"type":16,"tag":28,"props":1341,"children":1342},{},[1343],{"type":22,"value":1344},"Here's an example on the differences between the row-like format and the columnar format of parquet files.",{"type":16,"tag":28,"props":1346,"children":1347},{},[1348],{"type":16,"tag":37,"props":1349,"children":1352},{"alt":1350,"src":1351},"colvsrow","https://3.bp.blogspot.com/-3aUydn8zCsQ/VjslzWCu3pI/AAAAAAAAAI8/XOi77xQNmm0/s1600/Difference-between-Column-based-and-Row-based-Tables.png",[],{"type":16,"tag":28,"props":1354,"children":1355},{},[1356,1357],{"type":22,"value":46},{"type":16,"tag":48,"props":1358,"children":1361},{"href":1359,"rel":1360},"http://www.hanaexam.com/p/row-store-vs-column-store.html",[52],[1362],{"type":22,"value":1363},"SAP HANA Central",{"type":16,"tag":709,"props":1365,"children":1367},{"className":711,"code":1366,"language":713,"meta":10,"style":10},"@task(name=\"Transform Data!\")\ndef transform(data):\n    for col in data.iloc[:, 1:].columns:\n        data[col] = data[col].str.replace(r'[^0-9]+', '', regex=True).astype(int)\n    return data\n",[1368],{"type":16,"tag":123,"props":1369,"children":1370},{"__ignoreMap":10},[1371,1379,1387,1395,1403],{"type":16,"tag":719,"props":1372,"children":1373},{"class":721,"line":722},[1374],{"type":16,"tag":719,"props":1375,"children":1376},{},[1377],{"type":22,"value":1378},"@task(name=\"Transform Data!\")\n",{"type":16,"tag":719,"props":1380,"children":1381},{"class":721,"line":731},[1382],{"type":16,"tag":719,"props":1383,"children":1384},{},[1385],{"type":22,"value":1386},"def transform(data):\n",{"type":16,"tag":719,"props":1388,"children":1389},{"class":721,"line":740},[1390],{"type":16,"tag":719,"props":1391,"children":1392},{},[1393],{"type":22,"value":1394},"    for col in data.iloc[:, 1:].columns:\n",{"type":16,"tag":719,"props":1396,"children":1397},{"class":721,"line":749},[1398],{"type":16,"tag":719,"props":1399,"children":1400},{},[1401],{"type":22,"value":1402},"        data[col] = data[col].str.replace(r'[^0-9]+', '', regex=True).astype(int)\n",{"type":16,"tag":719,"props":1404,"children":1405},{"class":721,"line":758},[1406],{"type":16,"tag":719,"props":1407,"children":1408},{},[1409],{"type":22,"value":1410},"    return data\n",{"type":16,"tag":709,"props":1412,"children":1414},{"className":711,"code":1413,"language":713,"meta":10,"style":10},"@task(name=\"Load Data!\")\ndef load(data, path):\n    data.to_parquet(path, compression='snappy')\n",[1415],{"type":16,"tag":123,"props":1416,"children":1417},{"__ignoreMap":10},[1418,1426,1434],{"type":16,"tag":719,"props":1419,"children":1420},{"class":721,"line":722},[1421],{"type":16,"tag":719,"props":1422,"children":1423},{},[1424],{"type":22,"value":1425},"@task(name=\"Load Data!\")\n",{"type":16,"tag":719,"props":1427,"children":1428},{"class":721,"line":731},[1429],{"type":16,"tag":719,"props":1430,"children":1431},{},[1432],{"type":22,"value":1433},"def load(data, path):\n",{"type":16,"tag":719,"props":1435,"children":1436},{"class":721,"line":740},[1437],{"type":16,"tag":719,"props":1438,"children":1439},{},[1440],{"type":22,"value":1441},"    data.to_parquet(path, compression='snappy')\n",{"type":16,"tag":28,"props":1443,"children":1444},{},[1445,1447,1453,1455,1461],{"type":22,"value":1446},"When we have all the steps ready, we create a new function containing our graph using the ",{"type":16,"tag":123,"props":1448,"children":1450},{"className":1449},[],[1451],{"type":22,"value":1452},"flow",{"type":22,"value":1454}," decorator. We can give this function a name, for example, ",{"type":16,"tag":123,"props":1456,"children":1458},{"className":1457},[],[1459],{"type":22,"value":1460},"\"Example Pipeline! ðŸ˜Ž\"",{"type":22,"value":1462}," and then chain the tasks we created previously in the order in which they should be run.",{"type":16,"tag":28,"props":1464,"children":1465},{},[1466],{"type":22,"value":1467},"After we create our function, we can simply run it with the arguments necessary and Prefect will do its magic.",{"type":16,"tag":709,"props":1469,"children":1471},{"className":711,"code":1470,"language":713,"meta":10,"style":10},"example_data_out = path.joinpath(\"example\", \"my_test.parquet\")\ntype(example_data_out)\n",[1472],{"type":16,"tag":123,"props":1473,"children":1474},{"__ignoreMap":10},[1475,1483],{"type":16,"tag":719,"props":1476,"children":1477},{"class":721,"line":722},[1478],{"type":16,"tag":719,"props":1479,"children":1480},{},[1481],{"type":22,"value":1482},"example_data_out = path.joinpath(\"example\", \"my_test.parquet\")\n",{"type":16,"tag":719,"props":1484,"children":1485},{"class":721,"line":731},[1486],{"type":16,"tag":719,"props":1487,"children":1488},{},[1489],{"type":22,"value":1490},"type(example_data_out)\n",{"type":16,"tag":709,"props":1492,"children":1494},{"className":711,"code":1493,"language":713,"meta":10,"style":10},"@flow(name=\"Example Pipeline! ðŸ˜Ž\")\ndef example_etl(example_data_in, example_data_out):\n    data = extract(example_data_in)\n    data_clean = transform(data)\n    load(data_clean, example_data_out)\n    print(\"Your Pipeline Ran Successfully!\")\n",[1495],{"type":16,"tag":123,"props":1496,"children":1497},{"__ignoreMap":10},[1498,1506,1514,1522,1530,1538],{"type":16,"tag":719,"props":1499,"children":1500},{"class":721,"line":722},[1501],{"type":16,"tag":719,"props":1502,"children":1503},{},[1504],{"type":22,"value":1505},"@flow(name=\"Example Pipeline! ðŸ˜Ž\")\n",{"type":16,"tag":719,"props":1507,"children":1508},{"class":721,"line":731},[1509],{"type":16,"tag":719,"props":1510,"children":1511},{},[1512],{"type":22,"value":1513},"def example_etl(example_data_in, example_data_out):\n",{"type":16,"tag":719,"props":1515,"children":1516},{"class":721,"line":740},[1517],{"type":16,"tag":719,"props":1518,"children":1519},{},[1520],{"type":22,"value":1521},"    data = extract(example_data_in)\n",{"type":16,"tag":719,"props":1523,"children":1524},{"class":721,"line":749},[1525],{"type":16,"tag":719,"props":1526,"children":1527},{},[1528],{"type":22,"value":1529},"    data_clean = transform(data)\n",{"type":16,"tag":719,"props":1531,"children":1532},{"class":721,"line":758},[1533],{"type":16,"tag":719,"props":1534,"children":1535},{},[1536],{"type":22,"value":1537},"    load(data_clean, example_data_out)\n",{"type":16,"tag":719,"props":1539,"children":1540},{"class":721,"line":767},[1541],{"type":16,"tag":719,"props":1542,"children":1543},{},[1544],{"type":22,"value":1545},"    print(\"Your Pipeline Ran Successfully!\")\n",{"type":16,"tag":709,"props":1547,"children":1549},{"className":711,"code":1548,"language":713,"meta":10,"style":10},"example_etl(example_data_in, example_data_out)#.execute_in_process()\n",[1550],{"type":16,"tag":123,"props":1551,"children":1552},{"__ignoreMap":10},[1553],{"type":16,"tag":719,"props":1554,"children":1555},{"class":721,"line":722},[1556],{"type":16,"tag":719,"props":1557,"children":1558},{},[1559],{"type":22,"value":1548},{"type":16,"tag":28,"props":1561,"children":1562},{},[1563,1565,1571],{"type":22,"value":1564},"To see the graph we just ran, we can open the terminal and run ",{"type":16,"tag":123,"props":1566,"children":1568},{"className":1567},[],[1569],{"type":22,"value":1570},"prefect orion start",{"type":22,"value":1572},". This will take us to the Prefect UI where we can evaluate not only the run and graph, but also the parameters and logs collected from all DAGs we run.",{"type":16,"tag":28,"props":1574,"children":1575},{},[1576],{"type":22,"value":1577},"To make sure we have the correct data, let's create a visualization with pandas and hvplot, a package that allows us to add interactivity to our pandas' charts.",{"type":16,"tag":709,"props":1579,"children":1581},{"className":711,"code":1580,"language":713,"meta":10,"style":10},"import hvplot.pandas\n",[1582],{"type":16,"tag":123,"props":1583,"children":1584},{"__ignoreMap":10},[1585],{"type":16,"tag":719,"props":1586,"children":1587},{"class":721,"line":722},[1588],{"type":16,"tag":719,"props":1589,"children":1590},{},[1591],{"type":22,"value":1580},{"type":16,"tag":709,"props":1593,"children":1595},{"className":711,"code":1594,"language":713,"meta":10,"style":10},"pd.read_parquet(path.joinpath(\"example\", \"my_test.parquet\")).hvplot(x='Year', y=\"ForestService\")\n",[1596],{"type":16,"tag":123,"props":1597,"children":1598},{"__ignoreMap":10},[1599],{"type":16,"tag":719,"props":1600,"children":1601},{"class":721,"line":722},[1602],{"type":16,"tag":719,"props":1603,"children":1604},{},[1605],{"type":22,"value":1594},{"type":16,"tag":57,"props":1607,"children":1609},{"id":1608},"_6-pipelines",[1610,1612,1617],{"type":22,"value":1611},"6. ðŸ¼ ",{"type":16,"tag":123,"props":1613,"children":1615},{"className":1614},[],[1616],{"type":22,"value":128},{"type":22,"value":130},{"type":16,"tag":28,"props":1619,"children":1620},{},[1621],{"type":16,"tag":37,"props":1622,"children":1624},{"alt":10,"src":1623},"https://camo.githubusercontent.com/45ae53e215244585378c3e414ce05abb4f5f6be3/68747470733a2f2f6d656469612e67697068792e636f6d2f6d656469612f4978365150753533576c4236772f67697068792e676966",[],{"type":16,"tag":28,"props":1626,"children":1627},{},[1628,1630,1635],{"type":22,"value":1629},"The ",{"type":16,"tag":123,"props":1631,"children":1633},{"className":1632},[],[1634],{"type":22,"value":128},{"type":22,"value":1636}," operator is a pandas function that allows you to chain operations that take a data set, modify it, and return the modified version of the original data. In essence, it allows us to move the data through a series of steps until we reach the structure in which we want to have it.",{"type":16,"tag":28,"props":1638,"children":1639},{},[1640],{"type":22,"value":1641},"For example, imagine that we have a group of data and 4 functions to fix it, the chain of operations would look like this.",{"type":16,"tag":709,"props":1643,"children":1645},{"className":711,"code":1644,"language":713,"meta":10,"style":10},"(data.pipe(change_cols, list_of_cols)\n     .pipe(clean_numeric_vars, list_of_numeric_vars)\n     .pipe(add_dates_and_location, 'Auckland', 'NZ')\n     .pipe(fix_and_drop, 'column_to_fix', seasons_NZ, cols_drop_NZ))\n",[1646],{"type":16,"tag":123,"props":1647,"children":1648},{"__ignoreMap":10},[1649,1657,1665,1673],{"type":16,"tag":719,"props":1650,"children":1651},{"class":721,"line":722},[1652],{"type":16,"tag":719,"props":1653,"children":1654},{},[1655],{"type":22,"value":1656},"(data.pipe(change_cols, list_of_cols)\n",{"type":16,"tag":719,"props":1658,"children":1659},{"class":721,"line":731},[1660],{"type":16,"tag":719,"props":1661,"children":1662},{},[1663],{"type":22,"value":1664},"     .pipe(clean_numeric_vars, list_of_numeric_vars)\n",{"type":16,"tag":719,"props":1666,"children":1667},{"class":721,"line":740},[1668],{"type":16,"tag":719,"props":1669,"children":1670},{},[1671],{"type":22,"value":1672},"     .pipe(add_dates_and_location, 'Auckland', 'NZ')\n",{"type":16,"tag":719,"props":1674,"children":1675},{"class":721,"line":749},[1676],{"type":16,"tag":719,"props":1677,"children":1678},{},[1679],{"type":22,"value":1680},"     .pipe(fix_and_drop, 'column_to_fix', seasons_NZ, cols_drop_NZ))\n",{"type":16,"tag":28,"props":1682,"children":1683},{},[1684,1686,1691],{"type":22,"value":1685},"Another way to visualize what happens with pandas' ",{"type":16,"tag":123,"props":1687,"children":1689},{"className":1688},[],[1690],{"type":22,"value":128},{"type":22,"value":1692}," is through the following food process where we have ingredients and we actually require food.",{"type":16,"tag":28,"props":1694,"children":1695},{},[1696],{"type":16,"tag":37,"props":1697,"children":1699},{"alt":37,"src":1698},"../images/pandas_pipe.png",[],{"type":16,"tag":28,"props":1701,"children":1702},{},[1703,1705,1710],{"type":22,"value":1704},"Let's start with a small example without ",{"type":16,"tag":123,"props":1706,"children":1708},{"className":1707},[],[1709],{"type":22,"value":128},{"type":22,"value":1711}," first.",{"type":16,"tag":709,"props":1713,"children":1715},{"className":711,"code":1714,"language":713,"meta":10,"style":10},"toy_data = pd.DataFrame({\"Postal Codes\": [22345, 32442, 20007], \n                         \"Cities\":       [\"Miami\", \"Dallas\", \"Washington\"],\n                         \"Date\":         pd.date_range(start='9/27/2021', periods=3)})\ntoy_data\n",[1716],{"type":16,"tag":123,"props":1717,"children":1718},{"__ignoreMap":10},[1719,1727,1735,1743],{"type":16,"tag":719,"props":1720,"children":1721},{"class":721,"line":722},[1722],{"type":16,"tag":719,"props":1723,"children":1724},{},[1725],{"type":22,"value":1726},"toy_data = pd.DataFrame({\"Postal Codes\": [22345, 32442, 20007], \n",{"type":16,"tag":719,"props":1728,"children":1729},{"class":721,"line":731},[1730],{"type":16,"tag":719,"props":1731,"children":1732},{},[1733],{"type":22,"value":1734},"                         \"Cities\":       [\"Miami\", \"Dallas\", \"Washington\"],\n",{"type":16,"tag":719,"props":1736,"children":1737},{"class":721,"line":740},[1738],{"type":16,"tag":719,"props":1739,"children":1740},{},[1741],{"type":22,"value":1742},"                         \"Date\":         pd.date_range(start='9/27/2021', periods=3)})\n",{"type":16,"tag":719,"props":1744,"children":1745},{"class":721,"line":749},[1746],{"type":16,"tag":719,"props":1747,"children":1748},{},[1749],{"type":22,"value":1750},"toy_data\n",{"type":16,"tag":709,"props":1752,"children":1754},{"className":711,"code":1753,"language":713,"meta":10,"style":10},"def change_cols(data, cols_list):\n    data.columns = cols_list\n    return data\n",[1755],{"type":16,"tag":123,"props":1756,"children":1757},{"__ignoreMap":10},[1758,1766,1774],{"type":16,"tag":719,"props":1759,"children":1760},{"class":721,"line":722},[1761],{"type":16,"tag":719,"props":1762,"children":1763},{},[1764],{"type":22,"value":1765},"def change_cols(data, cols_list):\n",{"type":16,"tag":719,"props":1767,"children":1768},{"class":721,"line":731},[1769],{"type":16,"tag":719,"props":1770,"children":1771},{},[1772],{"type":22,"value":1773},"    data.columns = cols_list\n",{"type":16,"tag":719,"props":1775,"children":1776},{"class":721,"line":740},[1777],{"type":16,"tag":719,"props":1778,"children":1779},{},[1780],{"type":22,"value":1410},{"type":16,"tag":709,"props":1782,"children":1784},{"className":711,"code":1783,"language":713,"meta":10,"style":10},"def clean_col_names(index_of_cols: pd.Index):\n    import re\n    new_cols =  [re.sub(r'[^a-zA-Z0-9\\s]', '', col).lower().replace(r\" \", \"_\") for col in index_of_cols]\n    print(type(index_of_cols))\n    print(index_of_cols)\n    print(type(new_cols))\n    print(new_cols)\n",[1785],{"type":16,"tag":123,"props":1786,"children":1787},{"__ignoreMap":10},[1788,1796,1804,1812,1820,1828,1836],{"type":16,"tag":719,"props":1789,"children":1790},{"class":721,"line":722},[1791],{"type":16,"tag":719,"props":1792,"children":1793},{},[1794],{"type":22,"value":1795},"def clean_col_names(index_of_cols: pd.Index):\n",{"type":16,"tag":719,"props":1797,"children":1798},{"class":721,"line":731},[1799],{"type":16,"tag":719,"props":1800,"children":1801},{},[1802],{"type":22,"value":1803},"    import re\n",{"type":16,"tag":719,"props":1805,"children":1806},{"class":721,"line":740},[1807],{"type":16,"tag":719,"props":1808,"children":1809},{},[1810],{"type":22,"value":1811},"    new_cols =  [re.sub(r'[^a-zA-Z0-9\\s]', '', col).lower().replace(r\" \", \"_\") for col in index_of_cols]\n",{"type":16,"tag":719,"props":1813,"children":1814},{"class":721,"line":749},[1815],{"type":16,"tag":719,"props":1816,"children":1817},{},[1818],{"type":22,"value":1819},"    print(type(index_of_cols))\n",{"type":16,"tag":719,"props":1821,"children":1822},{"class":721,"line":758},[1823],{"type":16,"tag":719,"props":1824,"children":1825},{},[1826],{"type":22,"value":1827},"    print(index_of_cols)\n",{"type":16,"tag":719,"props":1829,"children":1830},{"class":721,"line":767},[1831],{"type":16,"tag":719,"props":1832,"children":1833},{},[1834],{"type":22,"value":1835},"    print(type(new_cols))\n",{"type":16,"tag":719,"props":1837,"children":1838},{"class":721,"line":777},[1839],{"type":16,"tag":719,"props":1840,"children":1841},{},[1842],{"type":22,"value":1843},"    print(new_cols)\n",{"type":16,"tag":709,"props":1845,"children":1847},{"className":711,"code":1846,"language":713,"meta":10,"style":10},"pd.Index\n",[1848],{"type":16,"tag":123,"props":1849,"children":1850},{"__ignoreMap":10},[1851],{"type":16,"tag":719,"props":1852,"children":1853},{"class":721,"line":722},[1854],{"type":16,"tag":719,"props":1855,"children":1856},{},[1857],{"type":22,"value":1846},{"type":16,"tag":709,"props":1859,"children":1861},{"className":711,"code":1860,"language":713,"meta":10,"style":10},"clean_col_names(toy_data.columns)\n",[1862],{"type":16,"tag":123,"props":1863,"children":1864},{"__ignoreMap":10},[1865],{"type":16,"tag":719,"props":1866,"children":1867},{"class":721,"line":722},[1868],{"type":16,"tag":719,"props":1869,"children":1870},{},[1871],{"type":22,"value":1860},{"type":16,"tag":709,"props":1873,"children":1875},{"className":711,"code":1874,"language":713,"meta":10,"style":10},"change_cols(toy_data, [\"postal_code\", \"city\", \"date\"])\n",[1876],{"type":16,"tag":123,"props":1877,"children":1878},{"__ignoreMap":10},[1879],{"type":16,"tag":719,"props":1880,"children":1881},{"class":721,"line":722},[1882],{"type":16,"tag":719,"props":1883,"children":1884},{},[1885],{"type":22,"value":1874},{"type":16,"tag":28,"props":1887,"children":1888},{},[1889],{"type":22,"value":1890},"As you can see, with a single function it doesn't make much sense to pipe the process but with a chain of functions, the story changes.",{"type":16,"tag":28,"props":1892,"children":1893},{},[1894,1896,1901,1903,1909],{"type":22,"value":1895},"The next thing we want to do is add additional information about the dates we have for each file. We can achieve this after converting the ",{"type":16,"tag":123,"props":1897,"children":1899},{"className":1898},[],[1900],{"type":22,"value":370},{"type":22,"value":1902}," variable to ",{"type":16,"tag":123,"props":1904,"children":1906},{"className":1905},[],[1907],{"type":22,"value":1908},"datetime",{"type":22,"value":1910}," format, which will allow us to access the year, month, week, ect. inside each date.",{"type":16,"tag":709,"props":1912,"children":1914},{"className":711,"code":1913,"language":713,"meta":10,"style":10},"london_cols = ['date', 'count', 'temperature', 'temp_feels_like', 'humidity', 'wind_speed', 'weather_code', 'is_holiday', 'is_weekend', 'seasons']\nseoul_cols = ['date', 'count', 'hour', 'temperature', 'humidity', 'wind_speed', 'visibility', 'dew_point_temp', 'solar_radiation', 'rainfall', 'snowfall', 'seasons', 'is_holiday', 'functioning_day']\nwa_dc_cols = ['instant', 'date', 'seasons', 'year', 'month', 'hour', 'is_holiday', 'weekday', 'workingday', 'weathersit', 'temperature', 'temp_feels_like', 'humidity', 'wind_speed', 'casual', 'registered', 'count']\n",[1915],{"type":16,"tag":123,"props":1916,"children":1917},{"__ignoreMap":10},[1918,1926,1934],{"type":16,"tag":719,"props":1919,"children":1920},{"class":721,"line":722},[1921],{"type":16,"tag":719,"props":1922,"children":1923},{},[1924],{"type":22,"value":1925},"london_cols = ['date', 'count', 'temperature', 'temp_feels_like', 'humidity', 'wind_speed', 'weather_code', 'is_holiday', 'is_weekend', 'seasons']\n",{"type":16,"tag":719,"props":1927,"children":1928},{"class":721,"line":731},[1929],{"type":16,"tag":719,"props":1930,"children":1931},{},[1932],{"type":22,"value":1933},"seoul_cols = ['date', 'count', 'hour', 'temperature', 'humidity', 'wind_speed', 'visibility', 'dew_point_temp', 'solar_radiation', 'rainfall', 'snowfall', 'seasons', 'is_holiday', 'functioning_day']\n",{"type":16,"tag":719,"props":1935,"children":1936},{"class":721,"line":740},[1937],{"type":16,"tag":719,"props":1938,"children":1939},{},[1940],{"type":22,"value":1941},"wa_dc_cols = ['instant', 'date', 'seasons', 'year', 'month', 'hour', 'is_holiday', 'weekday', 'workingday', 'weathersit', 'temperature', 'temp_feels_like', 'humidity', 'wind_speed', 'casual', 'registered', 'count']\n",{"type":16,"tag":709,"props":1943,"children":1945},{"className":711,"code":1944,"language":713,"meta":10,"style":10},"def add_dates_and_location(data, city, country):\n    \n    data['date']       = pd.to_datetime(data['date'], infer_datetime_format=True, dayfirst=True)\n    data[\"year\"]       = data['date'].dt.year\n    data[\"month\"]      = data['date'].dt.month\n    data[\"week\"]       = data['date'].dt.isocalendar().week.astype(int)\n    data[\"day\"]        = data['date'].dt.day\n    data[\"weekday\"]    = data['date'].dt.dayofweek\n    data[\"is_weekend\"] = (data[\"weekday\"] > 4).astype(int)\n    \n    # note that we don't want to overwrite data that already has the hour as a column\n    if 'hour' not in data.columns: \n        data[\"hour\"]   = data['date'].dt.hour\n    data['date']       = data['date'].dt.date\n    \n    # non-date variables\n    data['city']       = city\n    data['country']    = country\n    \n    return data\n",[1946],{"type":16,"tag":123,"props":1947,"children":1948},{"__ignoreMap":10},[1949,1957,1965,1973,1981,1989,1997,2005,2013,2021,2029,2038,2047,2056,2065,2073,2082,2091,2100,2108],{"type":16,"tag":719,"props":1950,"children":1951},{"class":721,"line":722},[1952],{"type":16,"tag":719,"props":1953,"children":1954},{},[1955],{"type":22,"value":1956},"def add_dates_and_location(data, city, country):\n",{"type":16,"tag":719,"props":1958,"children":1959},{"class":721,"line":731},[1960],{"type":16,"tag":719,"props":1961,"children":1962},{},[1963],{"type":22,"value":1964},"    \n",{"type":16,"tag":719,"props":1966,"children":1967},{"class":721,"line":740},[1968],{"type":16,"tag":719,"props":1969,"children":1970},{},[1971],{"type":22,"value":1972},"    data['date']       = pd.to_datetime(data['date'], infer_datetime_format=True, dayfirst=True)\n",{"type":16,"tag":719,"props":1974,"children":1975},{"class":721,"line":749},[1976],{"type":16,"tag":719,"props":1977,"children":1978},{},[1979],{"type":22,"value":1980},"    data[\"year\"]       = data['date'].dt.year\n",{"type":16,"tag":719,"props":1982,"children":1983},{"class":721,"line":758},[1984],{"type":16,"tag":719,"props":1985,"children":1986},{},[1987],{"type":22,"value":1988},"    data[\"month\"]      = data['date'].dt.month\n",{"type":16,"tag":719,"props":1990,"children":1991},{"class":721,"line":767},[1992],{"type":16,"tag":719,"props":1993,"children":1994},{},[1995],{"type":22,"value":1996},"    data[\"week\"]       = data['date'].dt.isocalendar().week.astype(int)\n",{"type":16,"tag":719,"props":1998,"children":1999},{"class":721,"line":777},[2000],{"type":16,"tag":719,"props":2001,"children":2002},{},[2003],{"type":22,"value":2004},"    data[\"day\"]        = data['date'].dt.day\n",{"type":16,"tag":719,"props":2006,"children":2007},{"class":721,"line":785},[2008],{"type":16,"tag":719,"props":2009,"children":2010},{},[2011],{"type":22,"value":2012},"    data[\"weekday\"]    = data['date'].dt.dayofweek\n",{"type":16,"tag":719,"props":2014,"children":2015},{"class":721,"line":794},[2016],{"type":16,"tag":719,"props":2017,"children":2018},{},[2019],{"type":22,"value":2020},"    data[\"is_weekend\"] = (data[\"weekday\"] > 4).astype(int)\n",{"type":16,"tag":719,"props":2022,"children":2024},{"class":721,"line":2023},10,[2025],{"type":16,"tag":719,"props":2026,"children":2027},{},[2028],{"type":22,"value":1964},{"type":16,"tag":719,"props":2030,"children":2032},{"class":721,"line":2031},11,[2033],{"type":16,"tag":719,"props":2034,"children":2035},{},[2036],{"type":22,"value":2037},"    # note that we don't want to overwrite data that already has the hour as a column\n",{"type":16,"tag":719,"props":2039,"children":2041},{"class":721,"line":2040},12,[2042],{"type":16,"tag":719,"props":2043,"children":2044},{},[2045],{"type":22,"value":2046},"    if 'hour' not in data.columns: \n",{"type":16,"tag":719,"props":2048,"children":2050},{"class":721,"line":2049},13,[2051],{"type":16,"tag":719,"props":2052,"children":2053},{},[2054],{"type":22,"value":2055},"        data[\"hour\"]   = data['date'].dt.hour\n",{"type":16,"tag":719,"props":2057,"children":2059},{"class":721,"line":2058},14,[2060],{"type":16,"tag":719,"props":2061,"children":2062},{},[2063],{"type":22,"value":2064},"    data['date']       = data['date'].dt.date\n",{"type":16,"tag":719,"props":2066,"children":2068},{"class":721,"line":2067},15,[2069],{"type":16,"tag":719,"props":2070,"children":2071},{},[2072],{"type":22,"value":1964},{"type":16,"tag":719,"props":2074,"children":2076},{"class":721,"line":2075},16,[2077],{"type":16,"tag":719,"props":2078,"children":2079},{},[2080],{"type":22,"value":2081},"    # non-date variables\n",{"type":16,"tag":719,"props":2083,"children":2085},{"class":721,"line":2084},17,[2086],{"type":16,"tag":719,"props":2087,"children":2088},{},[2089],{"type":22,"value":2090},"    data['city']       = city\n",{"type":16,"tag":719,"props":2092,"children":2094},{"class":721,"line":2093},18,[2095],{"type":16,"tag":719,"props":2096,"children":2097},{},[2098],{"type":22,"value":2099},"    data['country']    = country\n",{"type":16,"tag":719,"props":2101,"children":2103},{"class":721,"line":2102},19,[2104],{"type":16,"tag":719,"props":2105,"children":2106},{},[2107],{"type":22,"value":1964},{"type":16,"tag":719,"props":2109,"children":2111},{"class":721,"line":2110},20,[2112],{"type":16,"tag":719,"props":2113,"children":2114},{},[2115],{"type":22,"value":1410},{"type":16,"tag":709,"props":2117,"children":2119},{"className":711,"code":2118,"language":713,"meta":10,"style":10},"add_dates_and_location(toy_data, \"Sydney\", \"AU\")\n",[2120],{"type":16,"tag":123,"props":2121,"children":2122},{"__ignoreMap":10},[2123],{"type":16,"tag":719,"props":2124,"children":2125},{"class":721,"line":722},[2126],{"type":16,"tag":719,"props":2127,"children":2128},{},[2129],{"type":22,"value":2118},{"type":16,"tag":28,"props":2131,"children":2132},{},[2133],{"type":22,"value":2134},"As you can see, we added a lot of information to our data with a simple function, but what happens when we want to chain two or three or four operations together? The following would not be very easy to read right?",{"type":16,"tag":709,"props":2136,"children":2138},{"className":711,"code":2137,"language":713,"meta":10,"style":10},"add_dates_and_location(change_cols (toy_data, [\" postal_code \",\" city \",\" date \"]),\" Sydney \",\" AU \")\n",[2139],{"type":16,"tag":123,"props":2140,"children":2141},{"__ignoreMap":10},[2142],{"type":16,"tag":719,"props":2143,"children":2144},{"class":721,"line":722},[2145],{"type":16,"tag":719,"props":2146,"children":2147},{},[2148],{"type":22,"value":2137},{"type":16,"tag":28,"props":2150,"children":2151},{},[2152,2154,2159],{"type":22,"value":2153},"Let's move on to using our ",{"type":16,"tag":123,"props":2155,"children":2157},{"className":2156},[],[2158],{"type":22,"value":128},{"type":22,"value":2160}," operator now.",{"type":16,"tag":709,"props":2162,"children":2164},{"className":711,"code":2163,"language":713,"meta":10,"style":10},"toy_data = pd.DataFrame({\"Postal Codes\": [22345, 32442, 20007], \n                         \"Cities\":       [\"Miami\", \"Dallas\", \"Washington\"],\n                         \"Date\":         pd.date_range(start='9/27/2021', periods=3)})\n",[2165],{"type":16,"tag":123,"props":2166,"children":2167},{"__ignoreMap":10},[2168,2175,2182],{"type":16,"tag":719,"props":2169,"children":2170},{"class":721,"line":722},[2171],{"type":16,"tag":719,"props":2172,"children":2173},{},[2174],{"type":22,"value":1726},{"type":16,"tag":719,"props":2176,"children":2177},{"class":721,"line":731},[2178],{"type":16,"tag":719,"props":2179,"children":2180},{},[2181],{"type":22,"value":1734},{"type":16,"tag":719,"props":2183,"children":2184},{"class":721,"line":740},[2185],{"type":16,"tag":719,"props":2186,"children":2187},{},[2188],{"type":22,"value":1742},{"type":16,"tag":709,"props":2190,"children":2192},{"className":711,"code":2191,"language":713,"meta":10,"style":10},"(\n    toy_data.pipe(change_cols, [\"zip_code\", \"city\", \"date\"])\n            .pipe(add_dates_and_location, \"Sydney\", \"AU\")\n)\n",[2193],{"type":16,"tag":123,"props":2194,"children":2195},{"__ignoreMap":10},[2196,2204,2212,2220],{"type":16,"tag":719,"props":2197,"children":2198},{"class":721,"line":722},[2199],{"type":16,"tag":719,"props":2200,"children":2201},{},[2202],{"type":22,"value":2203},"(\n",{"type":16,"tag":719,"props":2205,"children":2206},{"class":721,"line":731},[2207],{"type":16,"tag":719,"props":2208,"children":2209},{},[2210],{"type":22,"value":2211},"    toy_data.pipe(change_cols, [\"zip_code\", \"city\", \"date\"])\n",{"type":16,"tag":719,"props":2213,"children":2214},{"class":721,"line":740},[2215],{"type":16,"tag":719,"props":2216,"children":2217},{},[2218],{"type":22,"value":2219},"            .pipe(add_dates_and_location, \"Sydney\", \"AU\")\n",{"type":16,"tag":719,"props":2221,"children":2222},{"class":721,"line":749},[2223],{"type":16,"tag":719,"props":2224,"children":2225},{},[2226],{"type":22,"value":2227},")\n",{"type":16,"tag":28,"props":2229,"children":2230},{},[2231],{"type":22,"value":2232},"As you can see, now our chained functions are more readable than before and we can continue and chain even more functions in the same fashion.",{"type":16,"tag":28,"props":2234,"children":2235},{},[2236],{"type":22,"value":2237},"In our data we have the stages of the year with different names and we also have variables that we do not need or that are not in the three files. Let's fix both!",{"type":16,"tag":709,"props":2239,"children":2241},{"className":711,"code":2240,"language":713,"meta":10,"style":10},"seasons_london = {0: 'Spring', 1: 'Summer', 2: 'Fall', 3: 'Winter'}\nseasons_wa_dc = {1: 'Spring', 2: 'Summer', 3: 'Fall', 4: 'Winter'}\nholidays_seoul = {'No Holiday': 0, 'Holiday': 1}\n",[2242],{"type":16,"tag":123,"props":2243,"children":2244},{"__ignoreMap":10},[2245,2253,2261],{"type":16,"tag":719,"props":2246,"children":2247},{"class":721,"line":722},[2248],{"type":16,"tag":719,"props":2249,"children":2250},{},[2251],{"type":22,"value":2252},"seasons_london = {0: 'Spring', 1: 'Summer', 2: 'Fall', 3: 'Winter'}\n",{"type":16,"tag":719,"props":2254,"children":2255},{"class":721,"line":731},[2256],{"type":16,"tag":719,"props":2257,"children":2258},{},[2259],{"type":22,"value":2260},"seasons_wa_dc = {1: 'Spring', 2: 'Summer', 3: 'Fall', 4: 'Winter'}\n",{"type":16,"tag":719,"props":2262,"children":2263},{"class":721,"line":740},[2264],{"type":16,"tag":719,"props":2265,"children":2266},{},[2267],{"type":22,"value":2268},"holidays_seoul = {'No Holiday': 0, 'Holiday': 1}\n",{"type":16,"tag":709,"props":2270,"children":2272},{"className":711,"code":2271,"language":713,"meta":10,"style":10},"cols_drop_london = ['temp_feels_like', 'weather_code']\ncols_drop_seoul = ['visibility', 'dew_point_temp', 'solar_radiation', 'rainfall', 'snowfall', 'functioning_day']\ncols_drop_wa_dc = ['instant', 'temp_feels_like', 'casual', 'registered', 'workingday', 'weathersit']\n",[2273],{"type":16,"tag":123,"props":2274,"children":2275},{"__ignoreMap":10},[2276,2284,2292],{"type":16,"tag":719,"props":2277,"children":2278},{"class":721,"line":722},[2279],{"type":16,"tag":719,"props":2280,"children":2281},{},[2282],{"type":22,"value":2283},"cols_drop_london = ['temp_feels_like', 'weather_code']\n",{"type":16,"tag":719,"props":2285,"children":2286},{"class":721,"line":731},[2287],{"type":16,"tag":719,"props":2288,"children":2289},{},[2290],{"type":22,"value":2291},"cols_drop_seoul = ['visibility', 'dew_point_temp', 'solar_radiation', 'rainfall', 'snowfall', 'functioning_day']\n",{"type":16,"tag":719,"props":2293,"children":2294},{"class":721,"line":740},[2295],{"type":16,"tag":719,"props":2296,"children":2297},{},[2298],{"type":22,"value":2299},"cols_drop_wa_dc = ['instant', 'temp_feels_like', 'casual', 'registered', 'workingday', 'weathersit']\n",{"type":16,"tag":709,"props":2301,"children":2303},{"className":711,"code":2302,"language":713,"meta":10,"style":10},"def fix_and_drop(data, col_to_fix, mapping, cols_to_drop):\n    data[col_to_fix] = data[col_to_fix].map(mapping)\n    return data.drop(cols_to_drop, axis=1)\n",[2304],{"type":16,"tag":123,"props":2305,"children":2306},{"__ignoreMap":10},[2307,2315,2323],{"type":16,"tag":719,"props":2308,"children":2309},{"class":721,"line":722},[2310],{"type":16,"tag":719,"props":2311,"children":2312},{},[2313],{"type":22,"value":2314},"def fix_and_drop(data, col_to_fix, mapping, cols_to_drop):\n",{"type":16,"tag":719,"props":2316,"children":2317},{"class":721,"line":731},[2318],{"type":16,"tag":719,"props":2319,"children":2320},{},[2321],{"type":22,"value":2322},"    data[col_to_fix] = data[col_to_fix].map(mapping)\n",{"type":16,"tag":719,"props":2324,"children":2325},{"class":721,"line":740},[2326],{"type":16,"tag":719,"props":2327,"children":2328},{},[2329],{"type":22,"value":2330},"    return data.drop(cols_to_drop, axis=1)\n",{"type":16,"tag":28,"props":2332,"children":2333},{},[2334,2336,2341],{"type":22,"value":2335},"Let's test the ",{"type":16,"tag":123,"props":2337,"children":2339},{"className":2338},[],[2340],{"type":22,"value":128},{"type":22,"value":2342}," operator but with the data from DC now and evaluate the results.",{"type":16,"tag":709,"props":2344,"children":2345},{"className":711,"code":1002,"language":713,"meta":10,"style":10},[2346],{"type":16,"tag":123,"props":2347,"children":2348},{"__ignoreMap":10},[2349],{"type":16,"tag":719,"props":2350,"children":2351},{"class":721,"line":722},[2352],{"type":16,"tag":719,"props":2353,"children":2354},{},[2355],{"type":22,"value":1002},{"type":16,"tag":709,"props":2357,"children":2359},{"className":711,"code":2358,"language":713,"meta":10,"style":10},"(washington.pipe(change_cols, wa_dc_cols)\n           .pipe(fix_and_drop, 'seasons', seasons_wa_dc, cols_drop_wa_dc)).head()\n",[2360],{"type":16,"tag":123,"props":2361,"children":2362},{"__ignoreMap":10},[2363,2371],{"type":16,"tag":719,"props":2364,"children":2365},{"class":721,"line":722},[2366],{"type":16,"tag":719,"props":2367,"children":2368},{},[2369],{"type":22,"value":2370},"(washington.pipe(change_cols, wa_dc_cols)\n",{"type":16,"tag":719,"props":2372,"children":2373},{"class":721,"line":731},[2374],{"type":16,"tag":719,"props":2375,"children":2376},{},[2377],{"type":22,"value":2378},"           .pipe(fix_and_drop, 'seasons', seasons_wa_dc, cols_drop_wa_dc)).head()\n",{"type":16,"tag":28,"props":2380,"children":2381},{},[2382],{"type":22,"value":2383},"Lastly, we esnt to create a function to normalize the data for DC as the columns are not in the same metric/imperial, etc. system as the rest.",{"type":16,"tag":709,"props":2385,"children":2387},{"className":711,"code":2386,"language":713,"meta":10,"style":10},"def normalize_vars(data):\n    data['temperature'] = data['temperature'].apply(lambda x: (x * 47) - 8)\n    data['humidity']    = data['humidity'].apply(lambda x: (x / 100))\n    data['wind_speed']  = data['wind_speed'].apply(lambda x: (x / 67))\n    return data\n",[2388],{"type":16,"tag":123,"props":2389,"children":2390},{"__ignoreMap":10},[2391,2399,2407,2415,2423],{"type":16,"tag":719,"props":2392,"children":2393},{"class":721,"line":722},[2394],{"type":16,"tag":719,"props":2395,"children":2396},{},[2397],{"type":22,"value":2398},"def normalize_vars(data):\n",{"type":16,"tag":719,"props":2400,"children":2401},{"class":721,"line":731},[2402],{"type":16,"tag":719,"props":2403,"children":2404},{},[2405],{"type":22,"value":2406},"    data['temperature'] = data['temperature'].apply(lambda x: (x * 47) - 8)\n",{"type":16,"tag":719,"props":2408,"children":2409},{"class":721,"line":740},[2410],{"type":16,"tag":719,"props":2411,"children":2412},{},[2413],{"type":22,"value":2414},"    data['humidity']    = data['humidity'].apply(lambda x: (x / 100))\n",{"type":16,"tag":719,"props":2416,"children":2417},{"class":721,"line":749},[2418],{"type":16,"tag":719,"props":2419,"children":2420},{},[2421],{"type":22,"value":2422},"    data['wind_speed']  = data['wind_speed'].apply(lambda x: (x / 67))\n",{"type":16,"tag":719,"props":2424,"children":2425},{"class":721,"line":758},[2426],{"type":16,"tag":719,"props":2427,"children":2428},{},[2429],{"type":22,"value":1410},{"type":16,"tag":28,"props":2431,"children":2432},{},[2433,2435,2440],{"type":22,"value":2434},"Finally, we can use our ",{"type":16,"tag":123,"props":2436,"children":2438},{"className":2437},[],[2439],{"type":22,"value":128},{"type":22,"value":2441}," operator again to complete the process and see the end result.",{"type":16,"tag":28,"props":2443,"children":2444},{},[2445,2447,2453],{"type":22,"value":2446},"Since we haven't created a function to read JSON files, let's create one anc call it ",{"type":16,"tag":123,"props":2448,"children":2450},{"className":2449},[],[2451],{"type":22,"value":2452},"extract_data",{"type":22,"value":1156},{"type":16,"tag":709,"props":2455,"children":2457},{"className":711,"code":2456,"language":713,"meta":10,"style":10},"def extract_data(path):\n    return pd.read_json(path)\n",[2458],{"type":16,"tag":123,"props":2459,"children":2460},{"__ignoreMap":10},[2461,2469],{"type":16,"tag":719,"props":2462,"children":2463},{"class":721,"line":722},[2464],{"type":16,"tag":719,"props":2465,"children":2466},{},[2467],{"type":22,"value":2468},"def extract_data(path):\n",{"type":16,"tag":719,"props":2470,"children":2471},{"class":721,"line":731},[2472],{"type":16,"tag":719,"props":2473,"children":2474},{},[2475],{"type":22,"value":2476},"    return pd.read_json(path)\n",{"type":16,"tag":709,"props":2478,"children":2480},{"className":711,"code":2479,"language":713,"meta":10,"style":10},"washington = (extract_data(wash_dc_path).pipe(change_cols, wa_dc_cols)\n                                        .pipe(add_dates_and_location, 'DC', 'USA')\n                                        .pipe(fix_and_drop, 'seasons', seasons_wa_dc, cols_drop_wa_dc)\n                                        .pipe(normalize_vars))\nwashington.head()\n",[2481],{"type":16,"tag":123,"props":2482,"children":2483},{"__ignoreMap":10},[2484,2492,2500,2508,2516],{"type":16,"tag":719,"props":2485,"children":2486},{"class":721,"line":722},[2487],{"type":16,"tag":719,"props":2488,"children":2489},{},[2490],{"type":22,"value":2491},"washington = (extract_data(wash_dc_path).pipe(change_cols, wa_dc_cols)\n",{"type":16,"tag":719,"props":2493,"children":2494},{"class":721,"line":731},[2495],{"type":16,"tag":719,"props":2496,"children":2497},{},[2498],{"type":22,"value":2499},"                                        .pipe(add_dates_and_location, 'DC', 'USA')\n",{"type":16,"tag":719,"props":2501,"children":2502},{"class":721,"line":740},[2503],{"type":16,"tag":719,"props":2504,"children":2505},{},[2506],{"type":22,"value":2507},"                                        .pipe(fix_and_drop, 'seasons', seasons_wa_dc, cols_drop_wa_dc)\n",{"type":16,"tag":719,"props":2509,"children":2510},{"class":721,"line":749},[2511],{"type":16,"tag":719,"props":2512,"children":2513},{},[2514],{"type":22,"value":2515},"                                        .pipe(normalize_vars))\n",{"type":16,"tag":719,"props":2517,"children":2518},{"class":721,"line":758},[2519],{"type":16,"tag":719,"props":2520,"children":2521},{},[2522],{"type":22,"value":1002},{"type":16,"tag":57,"props":2524,"children":2526},{"id":2525},"exercise",[2527],{"type":22,"value":2528},"Exercise",{"type":16,"tag":64,"props":2530,"children":2531},{},[2532,2537],{"type":16,"tag":68,"props":2533,"children":2534},{},[2535],{"type":22,"value":2536},"Create a function to extract the London data.",{"type":16,"tag":68,"props":2538,"children":2539},{},[2540,2542,2547],{"type":22,"value":2541},"Create a data pipe similar to the one in Washington using pandas' ",{"type":16,"tag":123,"props":2543,"children":2545},{"className":2544},[],[2546],{"type":22,"value":128},{"type":22,"value":1156},{"type":16,"tag":709,"props":2549,"children":2550},{"className":711,"code":10,"language":713,"meta":10,"style":10},[2551],{"type":16,"tag":123,"props":2552,"children":2553},{"__ignoreMap":10},[2554],{"type":16,"tag":719,"props":2555,"children":2556},{"class":721,"line":722},[2557],{"type":16,"tag":719,"props":2558,"children":2559},{},[2560],{"type":22,"value":10},{"type":16,"tag":709,"props":2562,"children":2563},{"className":711,"code":10,"language":713,"meta":10,"style":10},[2564],{"type":16,"tag":123,"props":2565,"children":2566},{"__ignoreMap":10},[2567],{"type":16,"tag":719,"props":2568,"children":2569},{"class":721,"line":722},[2570],{"type":16,"tag":719,"props":2571,"children":2572},{},[2573],{"type":22,"value":10},{"type":16,"tag":709,"props":2575,"children":2576},{"className":711,"code":10,"language":713,"meta":10,"style":10},[2577],{"type":16,"tag":123,"props":2578,"children":2579},{"__ignoreMap":10},[2580],{"type":16,"tag":719,"props":2581,"children":2582},{"class":721,"line":722},[2583],{"type":16,"tag":719,"props":2584,"children":2585},{},[2586],{"type":22,"value":10},{"type":16,"tag":709,"props":2588,"children":2589},{"className":711,"code":10,"language":713,"meta":10,"style":10},[2590],{"type":16,"tag":123,"props":2591,"children":2592},{"__ignoreMap":10},[2593],{"type":16,"tag":719,"props":2594,"children":2595},{"class":721,"line":722},[2596],{"type":16,"tag":719,"props":2597,"children":2598},{},[2599],{"type":22,"value":10},{"type":16,"tag":57,"props":2601,"children":2603},{"id":2602},"_7-extract",[2604],{"type":22,"value":2605},"7. Extract",{"type":16,"tag":28,"props":2607,"children":2608},{},[2609],{"type":22,"value":2610},"Depending on where the data is, in what format it is stored, and how we can access it, this can either be one of the shortest steps or one of the longest ones in our data pipeline. Here are some of the formats that you might encounter in your day to day.",{"type":16,"tag":289,"props":2612,"children":2613},{},[2614,2619,2624,2629,2634,2639],{"type":16,"tag":68,"props":2615,"children":2616},{},[2617],{"type":22,"value":2618},"Text: usually the text format is similar to what we see in Microsoft Excel but without formulas or graphics. For example, CVS or TSV.",{"type":16,"tag":68,"props":2620,"children":2621},{},[2622],{"type":22,"value":2623},"JSON: JavaScript Object Notation is a very popular sub-language for its simple syntactics",{"type":16,"tag":68,"props":2625,"children":2626},{},[2627],{"type":22,"value":2628},"Databases: These can be SQL, NOSQL, MPP (massively parallel processing), among others.",{"type":16,"tag":68,"props":2630,"children":2631},{},[2632],{"type":22,"value":2633},"GeoJSON: It is a type of format for data that contains geographic information. There are many more types of data for GIS.",{"type":16,"tag":68,"props":2635,"children":2636},{},[2637],{"type":22,"value":2638},"HTML: Refers to Hyper Text Markup Language and represents the skeleton of almost all web pages in existence.",{"type":16,"tag":68,"props":2640,"children":2641},{},[2642],{"type":22,"value":1078},{"type":16,"tag":28,"props":2644,"children":2645},{},[2646,2648,2654],{"type":22,"value":2647},"Since we already learned how to create useful pipelines with pandas, we now need to create functions for our main ETL pipeline to automate the process. We can achieve this using the prefect decorator, ",{"type":16,"tag":123,"props":2649,"children":2651},{"className":2650},[],[2652],{"type":22,"value":2653},"@task",{"type":22,"value":2655}," from earlier. This decorator takes note of the functions that we want to link together and helps us create a network in which each node is a function and each link connects one or more functions only once.",{"type":16,"tag":28,"props":2657,"children":2658},{},[2659,2661,2666],{"type":22,"value":2660},"Remember, the decorator ",{"type":16,"tag":123,"props":2662,"children":2664},{"className":2663},[],[2665],{"type":22,"value":2653},{"type":22,"value":2667}," is also a function within prefect and as such, we can pass several arguments to it that help us modify the behavior of each function in our pipeline.",{"type":16,"tag":28,"props":2669,"children":2670},{},[2671,2673,2678,2680,2686],{"type":22,"value":2672},"You can learn more about the ",{"type":16,"tag":123,"props":2674,"children":2676},{"className":2675},[],[2677],{"type":22,"value":668},{"type":22,"value":2679}," API in the official docs ",{"type":16,"tag":48,"props":2681,"children":2684},{"href":2682,"rel":2683},"https://docs.prefect.io/core/concepts/tasks.html#overview",[52],[2685],{"type":22,"value":1154},{"type":22,"value":1156},{"type":16,"tag":709,"props":2688,"children":2690},{"className":711,"code":2689,"language":713,"meta":10,"style":10},"task??\n",[2691],{"type":16,"tag":123,"props":2692,"children":2693},{"__ignoreMap":10},[2694],{"type":16,"tag":719,"props":2695,"children":2696},{"class":721,"line":722},[2697],{"type":16,"tag":719,"props":2698,"children":2699},{},[2700],{"type":22,"value":2689},{"type":16,"tag":709,"props":2702,"children":2704},{"className":711,"code":2703,"language":713,"meta":10,"style":10},"@task\ndef extract_1(path):\n    return pd.read_csv(path)\n",[2705],{"type":16,"tag":123,"props":2706,"children":2707},{"__ignoreMap":10},[2708,2716,2724],{"type":16,"tag":719,"props":2709,"children":2710},{"class":721,"line":722},[2711],{"type":16,"tag":719,"props":2712,"children":2713},{},[2714],{"type":22,"value":2715},"@task\n",{"type":16,"tag":719,"props":2717,"children":2718},{"class":721,"line":731},[2719],{"type":16,"tag":719,"props":2720,"children":2721},{},[2722],{"type":22,"value":2723},"def extract_1(path):\n",{"type":16,"tag":719,"props":2725,"children":2726},{"class":721,"line":740},[2727],{"type":16,"tag":719,"props":2728,"children":2729},{},[2730],{"type":22,"value":1291},{"type":16,"tag":709,"props":2732,"children":2734},{"className":711,"code":2733,"language":713,"meta":10,"style":10},"@task\ndef extract_2(path):\n    conn = sqlite3.connect(path)\n    query = \"SELECT * FROM uk_bikes\"\n    return pd.read_sql_query(query, conn)\n",[2735],{"type":16,"tag":123,"props":2736,"children":2737},{"__ignoreMap":10},[2738,2745,2753,2761,2769],{"type":16,"tag":719,"props":2739,"children":2740},{"class":721,"line":722},[2741],{"type":16,"tag":719,"props":2742,"children":2743},{},[2744],{"type":22,"value":2715},{"type":16,"tag":719,"props":2746,"children":2747},{"class":721,"line":731},[2748],{"type":16,"tag":719,"props":2749,"children":2750},{},[2751],{"type":22,"value":2752},"def extract_2(path):\n",{"type":16,"tag":719,"props":2754,"children":2755},{"class":721,"line":740},[2756],{"type":16,"tag":719,"props":2757,"children":2758},{},[2759],{"type":22,"value":2760},"    conn = sqlite3.connect(path)\n",{"type":16,"tag":719,"props":2762,"children":2763},{"class":721,"line":749},[2764],{"type":16,"tag":719,"props":2765,"children":2766},{},[2767],{"type":22,"value":2768},"    query = \"SELECT * FROM uk_bikes\"\n",{"type":16,"tag":719,"props":2770,"children":2771},{"class":721,"line":758},[2772],{"type":16,"tag":719,"props":2773,"children":2774},{},[2775],{"type":22,"value":2776},"    return pd.read_sql_query(query, conn)\n",{"type":16,"tag":709,"props":2778,"children":2780},{"className":711,"code":2779,"language":713,"meta":10,"style":10},"@task\ndef extract_3(path):\n    return pd.read_json(path)\n",[2781],{"type":16,"tag":123,"props":2782,"children":2783},{"__ignoreMap":10},[2784,2791,2799],{"type":16,"tag":719,"props":2785,"children":2786},{"class":721,"line":722},[2787],{"type":16,"tag":719,"props":2788,"children":2789},{},[2790],{"type":22,"value":2715},{"type":16,"tag":719,"props":2792,"children":2793},{"class":721,"line":731},[2794],{"type":16,"tag":719,"props":2795,"children":2796},{},[2797],{"type":22,"value":2798},"def extract_3(path):\n",{"type":16,"tag":719,"props":2800,"children":2801},{"class":721,"line":740},[2802],{"type":16,"tag":719,"props":2803,"children":2804},{},[2805],{"type":22,"value":2476},{"type":16,"tag":57,"props":2807,"children":2809},{"id":2808},"_8-transform",[2810],{"type":22,"value":2811},"8. Transform",{"type":16,"tag":28,"props":2813,"children":2814},{},[2815],{"type":22,"value":2816},"The most common transformations that happen at this stage are usually the ones we created earlier. In short,",{"type":16,"tag":289,"props":2818,"children":2819},{},[2820,2825,2830,2835,2840],{"type":16,"tag":68,"props":2821,"children":2822},{},[2823],{"type":22,"value":2824},"Clean text data",{"type":16,"tag":68,"props":2826,"children":2827},{},[2828],{"type":22,"value":2829},"Normalize columns",{"type":16,"tag":68,"props":2831,"children":2832},{},[2833],{"type":22,"value":2834},"Convert numeric variables to the same unit",{"type":16,"tag":68,"props":2836,"children":2837},{},[2838],{"type":22,"value":2839},"Deal with missing values",{"type":16,"tag":68,"props":2841,"children":2842},{},[2843],{"type":22,"value":2844},"Join data",{"type":16,"tag":28,"props":2846,"children":2847},{},[2848],{"type":22,"value":2849},"Our transform step will be a parent function to our pipe operators from earlier. Hence, a combination of functions handle by a single one.",{"type":16,"tag":709,"props":2851,"children":2853},{"className":711,"code":2852,"language":713,"meta":10,"style":10},"def order_and_merge(data_lists):\n    \n    pick_order = data_lists[0].columns\n    new_list = [d.reindex(columns=pick_order).sort_values(['date', 'hour']) for d in data_lists]\n    df = pd.concat(new_list)\n    return df\n",[2854],{"type":16,"tag":123,"props":2855,"children":2856},{"__ignoreMap":10},[2857,2865,2872,2880,2888,2896],{"type":16,"tag":719,"props":2858,"children":2859},{"class":721,"line":722},[2860],{"type":16,"tag":719,"props":2861,"children":2862},{},[2863],{"type":22,"value":2864},"def order_and_merge(data_lists):\n",{"type":16,"tag":719,"props":2866,"children":2867},{"class":721,"line":731},[2868],{"type":16,"tag":719,"props":2869,"children":2870},{},[2871],{"type":22,"value":1964},{"type":16,"tag":719,"props":2873,"children":2874},{"class":721,"line":740},[2875],{"type":16,"tag":719,"props":2876,"children":2877},{},[2878],{"type":22,"value":2879},"    pick_order = data_lists[0].columns\n",{"type":16,"tag":719,"props":2881,"children":2882},{"class":721,"line":749},[2883],{"type":16,"tag":719,"props":2884,"children":2885},{},[2886],{"type":22,"value":2887},"    new_list = [d.reindex(columns=pick_order).sort_values(['date', 'hour']) for d in data_lists]\n",{"type":16,"tag":719,"props":2889,"children":2890},{"class":721,"line":758},[2891],{"type":16,"tag":719,"props":2892,"children":2893},{},[2894],{"type":22,"value":2895},"    df = pd.concat(new_list)\n",{"type":16,"tag":719,"props":2897,"children":2898},{"class":721,"line":767},[2899],{"type":16,"tag":719,"props":2900,"children":2901},{},[2902],{"type":22,"value":2903},"    return df\n",{"type":16,"tag":709,"props":2905,"children":2907},{"className":711,"code":2906,"language":713,"meta":10,"style":10},"@task\ndef transform(london, seoul, washington):\n    \n    london = (london.pipe(change_cols, london_cols)\n                    .pipe(add_dates_and_location, 'London', 'UK')\n                    .pipe(fix_and_drop, 'seasons', seasons_london, cols_drop_london))\n    \n    seoul = (seoul.pipe(change_cols, seoul_cols)\n                  .pipe(add_dates_and_location, 'Seoul', 'SK')\n                  .pipe(fix_and_drop, 'is_holiday', holidays_seoul, cols_drop_seoul))\n    \n    wash_dc = (washington.pipe(change_cols, wa_dc_cols)\n                         .pipe(add_dates_and_location, 'DC', 'USA')\n                         .pipe(fix_and_drop, 'seasons', seasons_wa_dc, cols_drop_wa_dc)\n                         .pipe(normalize_vars))\n    \n    return order_and_merge([london, seoul, wash_dc])\n",[2908],{"type":16,"tag":123,"props":2909,"children":2910},{"__ignoreMap":10},[2911,2918,2926,2933,2941,2949,2957,2964,2972,2980,2988,2995,3003,3011,3019,3027,3034],{"type":16,"tag":719,"props":2912,"children":2913},{"class":721,"line":722},[2914],{"type":16,"tag":719,"props":2915,"children":2916},{},[2917],{"type":22,"value":2715},{"type":16,"tag":719,"props":2919,"children":2920},{"class":721,"line":731},[2921],{"type":16,"tag":719,"props":2922,"children":2923},{},[2924],{"type":22,"value":2925},"def transform(london, seoul, washington):\n",{"type":16,"tag":719,"props":2927,"children":2928},{"class":721,"line":740},[2929],{"type":16,"tag":719,"props":2930,"children":2931},{},[2932],{"type":22,"value":1964},{"type":16,"tag":719,"props":2934,"children":2935},{"class":721,"line":749},[2936],{"type":16,"tag":719,"props":2937,"children":2938},{},[2939],{"type":22,"value":2940},"    london = (london.pipe(change_cols, london_cols)\n",{"type":16,"tag":719,"props":2942,"children":2943},{"class":721,"line":758},[2944],{"type":16,"tag":719,"props":2945,"children":2946},{},[2947],{"type":22,"value":2948},"                    .pipe(add_dates_and_location, 'London', 'UK')\n",{"type":16,"tag":719,"props":2950,"children":2951},{"class":721,"line":767},[2952],{"type":16,"tag":719,"props":2953,"children":2954},{},[2955],{"type":22,"value":2956},"                    .pipe(fix_and_drop, 'seasons', seasons_london, cols_drop_london))\n",{"type":16,"tag":719,"props":2958,"children":2959},{"class":721,"line":777},[2960],{"type":16,"tag":719,"props":2961,"children":2962},{},[2963],{"type":22,"value":1964},{"type":16,"tag":719,"props":2965,"children":2966},{"class":721,"line":785},[2967],{"type":16,"tag":719,"props":2968,"children":2969},{},[2970],{"type":22,"value":2971},"    seoul = (seoul.pipe(change_cols, seoul_cols)\n",{"type":16,"tag":719,"props":2973,"children":2974},{"class":721,"line":794},[2975],{"type":16,"tag":719,"props":2976,"children":2977},{},[2978],{"type":22,"value":2979},"                  .pipe(add_dates_and_location, 'Seoul', 'SK')\n",{"type":16,"tag":719,"props":2981,"children":2982},{"class":721,"line":2023},[2983],{"type":16,"tag":719,"props":2984,"children":2985},{},[2986],{"type":22,"value":2987},"                  .pipe(fix_and_drop, 'is_holiday', holidays_seoul, cols_drop_seoul))\n",{"type":16,"tag":719,"props":2989,"children":2990},{"class":721,"line":2031},[2991],{"type":16,"tag":719,"props":2992,"children":2993},{},[2994],{"type":22,"value":1964},{"type":16,"tag":719,"props":2996,"children":2997},{"class":721,"line":2040},[2998],{"type":16,"tag":719,"props":2999,"children":3000},{},[3001],{"type":22,"value":3002},"    wash_dc = (washington.pipe(change_cols, wa_dc_cols)\n",{"type":16,"tag":719,"props":3004,"children":3005},{"class":721,"line":2049},[3006],{"type":16,"tag":719,"props":3007,"children":3008},{},[3009],{"type":22,"value":3010},"                         .pipe(add_dates_and_location, 'DC', 'USA')\n",{"type":16,"tag":719,"props":3012,"children":3013},{"class":721,"line":2058},[3014],{"type":16,"tag":719,"props":3015,"children":3016},{},[3017],{"type":22,"value":3018},"                         .pipe(fix_and_drop, 'seasons', seasons_wa_dc, cols_drop_wa_dc)\n",{"type":16,"tag":719,"props":3020,"children":3021},{"class":721,"line":2067},[3022],{"type":16,"tag":719,"props":3023,"children":3024},{},[3025],{"type":22,"value":3026},"                         .pipe(normalize_vars))\n",{"type":16,"tag":719,"props":3028,"children":3029},{"class":721,"line":2075},[3030],{"type":16,"tag":719,"props":3031,"children":3032},{},[3033],{"type":22,"value":1964},{"type":16,"tag":719,"props":3035,"children":3036},{"class":721,"line":2084},[3037],{"type":16,"tag":719,"props":3038,"children":3039},{},[3040],{"type":22,"value":3041},"    return order_and_merge([london, seoul, wash_dc])\n",{"type":16,"tag":57,"props":3043,"children":3045},{"id":3044},"_9-load",[3046],{"type":22,"value":3047},"9. Load",{"type":16,"tag":28,"props":3049,"children":3050},{},[3051],{"type":22,"value":3052},"We will need to save our new file in a database or in a format in which we are given both what the file occupies and the speed with which we can open and use it. So we will create two paths and two names for the files that we will use later.",{"type":16,"tag":709,"props":3054,"children":3056},{"className":711,"code":3055,"language":713,"meta":10,"style":10},"clean_path = path/'processed/clean.parquet'\nclean_db_path = path/'processed/bikes'\n",[3057],{"type":16,"tag":123,"props":3058,"children":3059},{"__ignoreMap":10},[3060,3068],{"type":16,"tag":719,"props":3061,"children":3062},{"class":721,"line":722},[3063],{"type":16,"tag":719,"props":3064,"children":3065},{},[3066],{"type":22,"value":3067},"clean_path = path/'processed/clean.parquet'\n",{"type":16,"tag":719,"props":3069,"children":3070},{"class":721,"line":731},[3071],{"type":16,"tag":719,"props":3072,"children":3073},{},[3074],{"type":22,"value":3075},"clean_db_path = path/'processed/bikes'\n",{"type":16,"tag":709,"props":3077,"children":3079},{"className":711,"code":3078,"language":713,"meta":10,"style":10},"clean_db_path\n",[3080],{"type":16,"tag":123,"props":3081,"children":3082},{"__ignoreMap":10},[3083],{"type":16,"tag":719,"props":3084,"children":3085},{"class":721,"line":722},[3086],{"type":16,"tag":719,"props":3087,"children":3088},{},[3089],{"type":22,"value":3078},{"type":16,"tag":28,"props":3091,"children":3092},{},[3093,3095,3101],{"type":22,"value":3094},"We will have a function for saving the data in a database. For this, Prefect provides us with a wrapper function around SQLite called, ",{"type":16,"tag":123,"props":3096,"children":3098},{"className":3097},[],[3099],{"type":22,"value":3100},"SQLiteScript",{"type":22,"value":3102}," which allows us to create a database and run a SQL scipt on top of it. This comes in hady for large and small operations/prototypes alike.",{"type":16,"tag":709,"props":3104,"children":3106},{"className":711,"code":3105,"language":713,"meta":10,"style":10},"def SQLiteScript(db, script):\n    with closing(sqlite3.connect(db)) as conn:\n        with closing(conn.cursor()) as cursor:\n            cursor.executescript(script)\n",[3107],{"type":16,"tag":123,"props":3108,"children":3109},{"__ignoreMap":10},[3110,3118,3126,3134],{"type":16,"tag":719,"props":3111,"children":3112},{"class":721,"line":722},[3113],{"type":16,"tag":719,"props":3114,"children":3115},{},[3116],{"type":22,"value":3117},"def SQLiteScript(db, script):\n",{"type":16,"tag":719,"props":3119,"children":3120},{"class":721,"line":731},[3121],{"type":16,"tag":719,"props":3122,"children":3123},{},[3124],{"type":22,"value":3125},"    with closing(sqlite3.connect(db)) as conn:\n",{"type":16,"tag":719,"props":3127,"children":3128},{"class":721,"line":740},[3129],{"type":16,"tag":719,"props":3130,"children":3131},{},[3132],{"type":22,"value":3133},"        with closing(conn.cursor()) as cursor:\n",{"type":16,"tag":719,"props":3135,"children":3136},{"class":721,"line":749},[3137],{"type":16,"tag":719,"props":3138,"children":3139},{},[3140],{"type":22,"value":3141},"            cursor.executescript(script)\n",{"type":16,"tag":709,"props":3143,"children":3145},{"className":711,"code":3144,"language":713,"meta":10,"style":10},"script= \"\"\"\n            CREATE TABLE IF NOT EXISTS bike_sharing (\n                    date text, count integer, temperature real,\n                    humidity real, wind_speed real, is_holiday real,\n                    is_weekend integer, seasons text, year integer,\n                    month integer, week integer, day integer, \n                    hour integer, weekday integer, city text,\n                  country text\n              )\n\"\"\"\n",[3146],{"type":16,"tag":123,"props":3147,"children":3148},{"__ignoreMap":10},[3149,3157,3165,3173,3181,3189,3197,3205,3213,3221],{"type":16,"tag":719,"props":3150,"children":3151},{"class":721,"line":722},[3152],{"type":16,"tag":719,"props":3153,"children":3154},{},[3155],{"type":22,"value":3156},"script= \"\"\"\n",{"type":16,"tag":719,"props":3158,"children":3159},{"class":721,"line":731},[3160],{"type":16,"tag":719,"props":3161,"children":3162},{},[3163],{"type":22,"value":3164},"            CREATE TABLE IF NOT EXISTS bike_sharing (\n",{"type":16,"tag":719,"props":3166,"children":3167},{"class":721,"line":740},[3168],{"type":16,"tag":719,"props":3169,"children":3170},{},[3171],{"type":22,"value":3172},"                    date text, count integer, temperature real,\n",{"type":16,"tag":719,"props":3174,"children":3175},{"class":721,"line":749},[3176],{"type":16,"tag":719,"props":3177,"children":3178},{},[3179],{"type":22,"value":3180},"                    humidity real, wind_speed real, is_holiday real,\n",{"type":16,"tag":719,"props":3182,"children":3183},{"class":721,"line":758},[3184],{"type":16,"tag":719,"props":3185,"children":3186},{},[3187],{"type":22,"value":3188},"                    is_weekend integer, seasons text, year integer,\n",{"type":16,"tag":719,"props":3190,"children":3191},{"class":721,"line":767},[3192],{"type":16,"tag":719,"props":3193,"children":3194},{},[3195],{"type":22,"value":3196},"                    month integer, week integer, day integer, \n",{"type":16,"tag":719,"props":3198,"children":3199},{"class":721,"line":777},[3200],{"type":16,"tag":719,"props":3201,"children":3202},{},[3203],{"type":22,"value":3204},"                    hour integer, weekday integer, city text,\n",{"type":16,"tag":719,"props":3206,"children":3207},{"class":721,"line":785},[3208],{"type":16,"tag":719,"props":3209,"children":3210},{},[3211],{"type":22,"value":3212},"                  country text\n",{"type":16,"tag":719,"props":3214,"children":3215},{"class":721,"line":794},[3216],{"type":16,"tag":719,"props":3217,"children":3218},{},[3219],{"type":22,"value":3220},"              )\n",{"type":16,"tag":719,"props":3222,"children":3223},{"class":721,"line":2023},[3224],{"type":16,"tag":719,"props":3225,"children":3226},{},[3227],{"type":22,"value":3228},"\"\"\"\n",{"type":16,"tag":709,"props":3230,"children":3232},{"className":711,"code":3231,"language":713,"meta":10,"style":10},"next(washington.itertuples(name='Bikes', index=False))\n",[3233],{"type":16,"tag":123,"props":3234,"children":3235},{"__ignoreMap":10},[3236],{"type":16,"tag":719,"props":3237,"children":3238},{"class":721,"line":722},[3239],{"type":16,"tag":719,"props":3240,"children":3241},{},[3242],{"type":22,"value":3231},{"type":16,"tag":709,"props":3244,"children":3246},{"className":711,"code":3245,"language":713,"meta":10,"style":10},"@task\ndef load(data, path_and_name):\n    \n    data = list(data.itertuples(name='Bikes', index=False))\n\n    insert_cmd = \"INSERT INTO bike_sharing VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\"\n    with closing(sqlite3.connect(path_and_name)) as conn:\n        with closing(conn.cursor()) as cursor:\n            cursor.executemany(insert_cmd, data)\n            conn.commit()\n",[3247],{"type":16,"tag":123,"props":3248,"children":3249},{"__ignoreMap":10},[3250,3257,3265,3272,3280,3287,3295,3303,3310,3318],{"type":16,"tag":719,"props":3251,"children":3252},{"class":721,"line":722},[3253],{"type":16,"tag":719,"props":3254,"children":3255},{},[3256],{"type":22,"value":2715},{"type":16,"tag":719,"props":3258,"children":3259},{"class":721,"line":731},[3260],{"type":16,"tag":719,"props":3261,"children":3262},{},[3263],{"type":22,"value":3264},"def load(data, path_and_name):\n",{"type":16,"tag":719,"props":3266,"children":3267},{"class":721,"line":740},[3268],{"type":16,"tag":719,"props":3269,"children":3270},{},[3271],{"type":22,"value":1964},{"type":16,"tag":719,"props":3273,"children":3274},{"class":721,"line":749},[3275],{"type":16,"tag":719,"props":3276,"children":3277},{},[3278],{"type":22,"value":3279},"    data = list(data.itertuples(name='Bikes', index=False))\n",{"type":16,"tag":719,"props":3281,"children":3282},{"class":721,"line":758},[3283],{"type":16,"tag":719,"props":3284,"children":3285},{"emptyLinePlaceholder":771},[3286],{"type":22,"value":774},{"type":16,"tag":719,"props":3288,"children":3289},{"class":721,"line":767},[3290],{"type":16,"tag":719,"props":3291,"children":3292},{},[3293],{"type":22,"value":3294},"    insert_cmd = \"INSERT INTO bike_sharing VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\"\n",{"type":16,"tag":719,"props":3296,"children":3297},{"class":721,"line":777},[3298],{"type":16,"tag":719,"props":3299,"children":3300},{},[3301],{"type":22,"value":3302},"    with closing(sqlite3.connect(path_and_name)) as conn:\n",{"type":16,"tag":719,"props":3304,"children":3305},{"class":721,"line":785},[3306],{"type":16,"tag":719,"props":3307,"children":3308},{},[3309],{"type":22,"value":3133},{"type":16,"tag":719,"props":3311,"children":3312},{"class":721,"line":794},[3313],{"type":16,"tag":719,"props":3314,"children":3315},{},[3316],{"type":22,"value":3317},"            cursor.executemany(insert_cmd, data)\n",{"type":16,"tag":719,"props":3319,"children":3320},{"class":721,"line":2023},[3321],{"type":16,"tag":719,"props":3322,"children":3323},{},[3324],{"type":22,"value":3325},"            conn.commit()\n",{"type":16,"tag":57,"props":3327,"children":3329},{"id":3328},"_10-launch-a-pipeline",[3330],{"type":22,"value":3331},"10. Launch a Pipeline",{"type":16,"tag":28,"props":3333,"children":3334},{},[3335,3337,3342],{"type":22,"value":3336},"In the same fashion as before, we will combine our functions in a function decorated with ",{"type":16,"tag":123,"props":3338,"children":3340},{"className":3339},[],[3341],{"type":22,"value":1452},{"type":22,"value":3343}," to signal to prefec's scheduler that we have a DAG we would like to run.",{"type":16,"tag":709,"props":3345,"children":3347},{"className":711,"code":3346,"language":713,"meta":10,"style":10},"@flow(name='bikes-ETL')\ndef my_etl():\n    \n    new_table = SQLiteScript(db=str(clean_db_path), script=script)\n    \n    london = extract_2(london_path)\n    seoul = extract_1(seoul_path)\n    wash_dc = extract_3(wash_dc_path)\n    \n    transformed = transform(london, seoul, wash_dc)\n        \n    data_loaded = load(transformed, clean_db_path)\n",[3348],{"type":16,"tag":123,"props":3349,"children":3350},{"__ignoreMap":10},[3351,3359,3367,3374,3382,3389,3397,3405,3413,3420,3428,3436],{"type":16,"tag":719,"props":3352,"children":3353},{"class":721,"line":722},[3354],{"type":16,"tag":719,"props":3355,"children":3356},{},[3357],{"type":22,"value":3358},"@flow(name='bikes-ETL')\n",{"type":16,"tag":719,"props":3360,"children":3361},{"class":721,"line":731},[3362],{"type":16,"tag":719,"props":3363,"children":3364},{},[3365],{"type":22,"value":3366},"def my_etl():\n",{"type":16,"tag":719,"props":3368,"children":3369},{"class":721,"line":740},[3370],{"type":16,"tag":719,"props":3371,"children":3372},{},[3373],{"type":22,"value":1964},{"type":16,"tag":719,"props":3375,"children":3376},{"class":721,"line":749},[3377],{"type":16,"tag":719,"props":3378,"children":3379},{},[3380],{"type":22,"value":3381},"    new_table = SQLiteScript(db=str(clean_db_path), script=script)\n",{"type":16,"tag":719,"props":3383,"children":3384},{"class":721,"line":758},[3385],{"type":16,"tag":719,"props":3386,"children":3387},{},[3388],{"type":22,"value":1964},{"type":16,"tag":719,"props":3390,"children":3391},{"class":721,"line":767},[3392],{"type":16,"tag":719,"props":3393,"children":3394},{},[3395],{"type":22,"value":3396},"    london = extract_2(london_path)\n",{"type":16,"tag":719,"props":3398,"children":3399},{"class":721,"line":777},[3400],{"type":16,"tag":719,"props":3401,"children":3402},{},[3403],{"type":22,"value":3404},"    seoul = extract_1(seoul_path)\n",{"type":16,"tag":719,"props":3406,"children":3407},{"class":721,"line":785},[3408],{"type":16,"tag":719,"props":3409,"children":3410},{},[3411],{"type":22,"value":3412},"    wash_dc = extract_3(wash_dc_path)\n",{"type":16,"tag":719,"props":3414,"children":3415},{"class":721,"line":794},[3416],{"type":16,"tag":719,"props":3417,"children":3418},{},[3419],{"type":22,"value":1964},{"type":16,"tag":719,"props":3421,"children":3422},{"class":721,"line":2023},[3423],{"type":16,"tag":719,"props":3424,"children":3425},{},[3426],{"type":22,"value":3427},"    transformed = transform(london, seoul, wash_dc)\n",{"type":16,"tag":719,"props":3429,"children":3430},{"class":721,"line":2031},[3431],{"type":16,"tag":719,"props":3432,"children":3433},{},[3434],{"type":22,"value":3435},"        \n",{"type":16,"tag":719,"props":3437,"children":3438},{"class":721,"line":2040},[3439],{"type":16,"tag":719,"props":3440,"children":3441},{},[3442],{"type":22,"value":3443},"    data_loaded = load(transformed, clean_db_path)\n",{"type":16,"tag":28,"props":3445,"children":3446},{},[3447],{"type":22,"value":3448},"Running our pipeline is as simple as calling the function. In addition, even though we did not pass in any parameters to our flow function, it can contain any number of them if we choose to.",{"type":16,"tag":709,"props":3450,"children":3452},{"className":711,"code":3451,"language":713,"meta":10,"style":10},"my_etl()\n",[3453],{"type":16,"tag":123,"props":3454,"children":3455},{"__ignoreMap":10},[3456],{"type":16,"tag":719,"props":3457,"children":3458},{"class":721,"line":722},[3459],{"type":16,"tag":719,"props":3460,"children":3461},{},[3462],{"type":22,"value":3451},{"type":16,"tag":709,"props":3464,"children":3466},{"className":711,"code":3465,"language":713,"meta":10,"style":10},"pd.read_sql_query(\"SELECT * FROM bike_sharing\", sqlite3.connect(clean_db_path)).head()\n",[3467],{"type":16,"tag":123,"props":3468,"children":3469},{"__ignoreMap":10},[3470],{"type":16,"tag":719,"props":3471,"children":3472},{"class":721,"line":722},[3473],{"type":16,"tag":719,"props":3474,"children":3475},{},[3476],{"type":22,"value":3465},{"type":16,"tag":57,"props":3478,"children":3480},{"id":3479},"exercise-1",[3481],{"type":22,"value":2528},{"type":16,"tag":28,"props":3483,"children":3484},{},[3485,3487,3493,3495,3500],{"type":22,"value":3486},"Change the function to unload (",{"type":16,"tag":123,"props":3488,"children":3490},{"className":3489},[],[3491],{"type":22,"value":3492},"load ()",{"type":22,"value":3494},") and make it save the results in ",{"type":16,"tag":123,"props":3496,"children":3498},{"className":3497},[],[3499],{"type":22,"value":1337},{"type":22,"value":3501}," format. Run the pipeline again and make sure the results are the same as above by reading the data with pandas' respective function for parquet files.",{"type":16,"tag":709,"props":3503,"children":3504},{"className":711,"code":10,"language":713,"meta":10,"style":10},[3505],{"type":16,"tag":123,"props":3506,"children":3507},{"__ignoreMap":10},[3508],{"type":16,"tag":719,"props":3509,"children":3510},{"class":721,"line":722},[3511],{"type":16,"tag":719,"props":3512,"children":3513},{},[3514],{"type":22,"value":10},{"type":16,"tag":709,"props":3516,"children":3517},{"className":711,"code":10,"language":713,"meta":10,"style":10},[3518],{"type":16,"tag":123,"props":3519,"children":3520},{"__ignoreMap":10},[3521],{"type":16,"tag":719,"props":3522,"children":3523},{"class":721,"line":722},[3524],{"type":16,"tag":719,"props":3525,"children":3526},{},[3527],{"type":22,"value":10},{"type":16,"tag":709,"props":3529,"children":3530},{"className":711,"code":10,"language":713,"meta":10,"style":10},[3531],{"type":16,"tag":123,"props":3532,"children":3533},{"__ignoreMap":10},[3534],{"type":16,"tag":719,"props":3535,"children":3536},{"class":721,"line":722},[3537],{"type":16,"tag":719,"props":3538,"children":3539},{},[3540],{"type":22,"value":10},{"type":16,"tag":57,"props":3542,"children":3544},{"id":3543},"_11-summary",[3545],{"type":22,"value":3546},"11. Summary",{"type":16,"tag":64,"props":3548,"children":3549},{},[3550,3555,3567],{"type":16,"tag":68,"props":3551,"children":3552},{},[3553],{"type":22,"value":3554},"Creating ETL pipes helps us automate the cleaning steps to prepare our datasets.",{"type":16,"tag":68,"props":3556,"children":3557},{},[3558,3560,3565],{"type":22,"value":3559},"pandas ",{"type":16,"tag":123,"props":3561,"children":3563},{"className":3562},[],[3564],{"type":22,"value":128},{"type":22,"value":3566}," helps you chain functions that operate on a dataframe and return a dataframe, effectively helping us save time and lines of code.",{"type":16,"tag":68,"props":3568,"children":3569},{},[3570],{"type":22,"value":3571},"Prefect helps us create, monitor, and schedule directed acyclic graphs represented via the steps of our cleaning process.",{"type":16,"tag":3573,"props":3574,"children":3575},"style",{},[3576],{"type":22,"value":3577},"html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}",{"title":10,"searchDepth":731,"depth":731,"links":3579},[3580,3581,3582,3583,3584,3585,3586,3588,3589,3590,3591,3592,3593,3594],{"id":59,"depth":731,"text":62},{"id":178,"depth":731,"text":181},{"id":227,"depth":731,"text":230},{"id":266,"depth":731,"text":269},{"id":627,"depth":731,"text":630},{"id":1005,"depth":731,"text":1008},{"id":1608,"depth":731,"text":3587},"6. ðŸ¼ pipelines",{"id":2525,"depth":731,"text":2528},{"id":2602,"depth":731,"text":2605},{"id":2808,"depth":731,"text":2811},{"id":3044,"depth":731,"text":3047},{"id":3328,"depth":731,"text":3331},{"id":3479,"depth":731,"text":2528},{"id":3543,"depth":731,"text":3546},"markdown","content:3.data-engineering:3.etl_pipes.md","content","3.data-engineering/3.etl_pipes.md","md","default",["ShallowRef",3602],["ShallowReactive",3603],{"/data-engineering/etl_pipes":3604},[3605,3610],{"_path":3606,"_dir":8,"_draft":9,"_partial":9,"_locale":10,"title":3607,"description":10,"_type":3595,"_id":3608,"_source":3597,"_file":3609,"_extension":3599},"/data-engineering/data_cleaning","Data Cleaning","content:3.data-engineering:2.data_cleaning.md","3.data-engineering/2.data_cleaning.md",{"_path":3611,"_dir":8,"_draft":9,"_partial":9,"_locale":10,"title":3612,"description":10,"_type":3595,"_id":3613,"_source":3597,"_file":3614,"_extension":3599},"/data-engineering/data_pipelines_getting_started","Data Pipelines From Scratch","content:3.data-engineering:4.data_pipelines_getting_started.md","3.data-engineering/4.data_pipelines_getting_started.md",["ShallowRef",3616],{},{"preference":3618,"value":3618,"unknown":771,"forced":9},"system",[3620,3636,3650,3672,3684,3691],{"title":3621,"_path":3622,"children":3623,"icon":3635},"Set Up","/introduction",[3624,3626,3629,3632],{"title":3625,"_path":3622},"Introduction",{"title":3627,"_path":3628},"Python Installation","/introduction/python_installation",{"title":3630,"_path":3631},"Git Installation","/introduction/git_installation",{"title":3633,"_path":3634},"Jupyter Lab & Notebooks Intro","/introduction/jupyter_intro","ph:star-duotone",{"title":3637,"_path":3638,"children":3639,"icon":3649},"Programming","/programming",[3640,3642],{"title":3641,"_path":3638},"Programming Tutorials",{"title":3643,"_path":3644,"children":3645},"Terminal","/programming/terminal",[3646],{"title":3647,"_path":3648},"Intro to the Terminal","/programming/terminal/shell_intro","heroicons-outline:bookmark-alt",{"title":3651,"_path":3652,"children":3653,"icon":3671},"Analytics","/analytics",[3654,3656,3659,3662,3665,3668],{"title":3655,"_path":3652},"Data Analytics",{"title":3657,"_path":3658},"Numerical Computing","/analytics/numerical_computing",{"title":3660,"_path":3661},"Intro to pandas","/analytics/structured_data",{"title":3663,"_path":3664},"Intro to Statistics","/analytics/stats_intro",{"title":3666,"_path":3667},"Describing Data","/analytics/describing_data",{"title":3669,"_path":3670},"Exploratory Data Analysis","/analytics/eda","ri:line-chart-line",{"title":3673,"_path":3674,"children":3675,"icon":3683},"Data Engineering","/data-engineering",[3676,3677,3680,3681,3682],{"title":3612,"_path":3611},{"title":3678,"_path":3679},"Getting Data as DataFrames","/data-engineering/getting_data",{"title":3607,"_path":3606},{"title":11,"_path":7},{"title":3612,"_path":3611},"ri:settings-2-line",{"title":3685,"_path":3686,"children":3687,"icon":3690},"Data Science","/data-science",[3688],{"title":3689,"_path":3686},"Intro to DS","ri:magic-line",{"title":3692,"_path":3693,"children":3694,"icon":3697},"Machine Learning Engineering","/ml-engineering",[3695],{"title":3696,"_path":3693},"Intro to MLE","ri:robot-2-line",{"heroicons-outline:menu":3699,"fa-brands:github":3703,"simple-icons:nuxtdotjs":3707,"ri:arrow-right-double-fill":3709,"ph:star-duotone":3711,"lucide:chevrons-down-up":3714,"heroicons-outline:bookmark-alt":3716,"lucide:chevrons-up-down":3718,"ri:line-chart-line":3720,"ri:settings-2-line":3722,"ri:magic-line":3724,"ri:robot-2-line":3726,"uil:edit":3728,"heroicons-outline:arrow-sm-right":3730,"ri:arrow-right-s-line":3732,"ri:arrow-right-double-line":3734,"heroicons-outline:arrow-sm-left":3735,"heroicons-outline:chevron-right":3737,"heroicons-outline:search":3739,"ph:copy":3741},{"left":3700,"top":3700,"width":3701,"height":3701,"rotate":3700,"vFlip":9,"hFlip":9,"body":3702},0,24,"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 6h16M4 12h16M4 18h16\"/>",{"left":3700,"top":3700,"width":3704,"height":3705,"rotate":3700,"vFlip":9,"hFlip":9,"body":3706},496,512,"\u003Cpath fill=\"currentColor\" d=\"M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2\"/>",{"left":3700,"top":3700,"width":3701,"height":3701,"rotate":3700,"vFlip":9,"hFlip":9,"body":3708},"\u003Cpath fill=\"currentColor\" d=\"M13.464 19.83h8.922c.283 0 .562-.073.807-.21a1.6 1.6 0 0 0 .591-.574a1.53 1.53 0 0 0 .216-.783a1.53 1.53 0 0 0-.217-.782L17.792 7.414a1.6 1.6 0 0 0-.591-.573a1.65 1.65 0 0 0-.807-.21c-.283 0-.562.073-.807.21a1.6 1.6 0 0 0-.59.573L13.463 9.99L10.47 4.953a1.6 1.6 0 0 0-.591-.573a1.65 1.65 0 0 0-.807-.21c-.284 0-.562.073-.807.21a1.6 1.6 0 0 0-.591.573L.216 17.481a1.53 1.53 0 0 0-.217.782c0 .275.074.545.216.783a1.6 1.6 0 0 0 .59.574c.246.137.525.21.808.21h5.6c2.22 0 3.856-.946 4.982-2.79l2.733-4.593l1.464-2.457l4.395 7.382h-5.859Zm-6.341-2.46l-3.908-.002l5.858-9.842l2.923 4.921l-1.957 3.29c-.748 1.196-1.597 1.632-2.916 1.632\"/>",{"left":3700,"top":3700,"width":3701,"height":3701,"rotate":3700,"vFlip":9,"hFlip":9,"body":3710},"\u003Cpath fill=\"currentColor\" d=\"m19.164 12l-6.207-6.207l-1.414 1.414L16.336 12l-4.793 4.793l1.414 1.414zm-5.65 0L7.307 5.793L5.893 7.207L10.686 12l-4.793 4.793l1.414 1.414z\"/>",{"left":3700,"top":3700,"width":3712,"height":3712,"rotate":3700,"vFlip":9,"hFlip":9,"body":3713},256,"\u003Cg fill=\"currentColor\">\u003Cpath d=\"m229.06 108.79l-48.7 42l14.88 62.79a8.4 8.4 0 0 1-12.52 9.17L128 189.09l-54.72 33.65a8.4 8.4 0 0 1-12.52-9.17l14.88-62.79l-48.7-42A8.46 8.46 0 0 1 31.73 94l63.91-5.2l24.62-59.6a8.36 8.36 0 0 1 15.48 0l24.62 59.6l63.91 5.2a8.46 8.46 0 0 1 4.79 14.79\" opacity=\".2\"/>\u003Cpath d=\"M239.18 97.26A16.38 16.38 0 0 0 224.92 86l-59-4.76l-22.78-55.09a16.36 16.36 0 0 0-30.27 0L90.11 81.23L31.08 86a16.46 16.46 0 0 0-9.37 28.86l45 38.83L53 211.75a16.38 16.38 0 0 0 24.5 17.82l50.5-31.08l50.53 31.08A16.4 16.4 0 0 0 203 211.75l-13.76-58.07l45-38.83a16.43 16.43 0 0 0 4.94-17.59m-15.34 5.47l-48.7 42a8 8 0 0 0-2.56 7.91l14.88 62.8a.37.37 0 0 1-.17.48c-.18.14-.23.11-.38 0l-54.72-33.65a8 8 0 0 0-8.38 0l-54.72 33.67c-.15.09-.19.12-.38 0a.37.37 0 0 1-.17-.48l14.88-62.8a8 8 0 0 0-2.56-7.91l-48.7-42c-.12-.1-.23-.19-.13-.5s.18-.27.33-.29l63.92-5.16a8 8 0 0 0 6.72-4.94l24.62-59.61c.08-.17.11-.25.35-.25s.27.08.35.25L153 91.86a8 8 0 0 0 6.75 4.92l63.92 5.16c.15 0 .24 0 .33.29s0 .4-.16.5\"/>\u003C/g>",{"left":3700,"top":3700,"width":3701,"height":3701,"rotate":3700,"vFlip":9,"hFlip":9,"body":3715},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m7 20l5-5l5 5M7 4l5 5l5-5\"/>",{"left":3700,"top":3700,"width":3701,"height":3701,"rotate":3700,"vFlip":9,"hFlip":9,"body":3717},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M16 4v12l-4-2l-4 2V4M6 20h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2\"/>",{"left":3700,"top":3700,"width":3701,"height":3701,"rotate":3700,"vFlip":9,"hFlip":9,"body":3719},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m7 15l5 5l5-5M7 9l5-5l5 5\"/>",{"left":3700,"top":3700,"width":3701,"height":3701,"rotate":3700,"vFlip":9,"hFlip":9,"body":3721},"\u003Cpath fill=\"currentColor\" d=\"M5 3v16h16v2H3V3zm15.293 3.293l1.414 1.414L16 13.414l-3-2.999l-4.293 4.292l-1.414-1.414L13 7.586l3 2.999z\"/>",{"left":3700,"top":3700,"width":3701,"height":3701,"rotate":3700,"vFlip":9,"hFlip":9,"body":3723},"\u003Cpath fill=\"currentColor\" d=\"m8.686 4l2.607-2.607a1 1 0 0 1 1.414 0L15.314 4H19a1 1 0 0 1 1 1v3.686l2.607 2.607a1 1 0 0 1 0 1.414L20 15.314V19a1 1 0 0 1-1 1h-3.686l-2.607 2.607a1 1 0 0 1-1.414 0L8.686 20H5a1 1 0 0 1-1-1v-3.686l-2.607-2.607a1 1 0 0 1 0-1.414L4 8.686V5a1 1 0 0 1 1-1zM6 6v3.515L3.515 12L6 14.485V18h3.515L12 20.485L14.485 18H18v-3.515L20.485 12L18 9.515V6h-3.515L12 3.515L9.515 6zm6 10a4 4 0 1 1 0-8a4 4 0 0 1 0 8m0-2a2 2 0 1 0 0-4a2 2 0 0 0 0 4\"/>",{"left":3700,"top":3700,"width":3701,"height":3701,"rotate":3700,"vFlip":9,"hFlip":9,"body":3725},"\u003Cpath fill=\"currentColor\" d=\"M15.199 9.944a2.6 2.6 0 0 1-.79-1.55l-.403-3.083l-2.731 1.486a2.6 2.6 0 0 1-1.719.272L6.5 6.5l.57 3.056a2.6 2.6 0 0 1-.273 1.72l-1.486 2.73l3.083.403a2.6 2.6 0 0 1 1.55.79l2.138 2.257l1.336-2.807a2.6 2.6 0 0 1 1.23-1.231l2.808-1.336zm.025 5.564l-2.213 4.65a.6.6 0 0 1-.977.155l-3.542-3.739a.6.6 0 0 0-.358-.182l-5.106-.668a.6.6 0 0 1-.45-.881l2.462-4.524a.6.6 0 0 0 .063-.396L4.16 4.86a.6.6 0 0 1 .7-.7l5.062.943a.6.6 0 0 0 .397-.063l4.523-2.46a.6.6 0 0 1 .882.448l.668 5.107a.6.6 0 0 0 .182.357l3.739 3.542a.6.6 0 0 1-.155.977l-4.65 2.213a.6.6 0 0 0-.284.284m.797 1.927l1.414-1.414l4.243 4.242l-1.415 1.415z\"/>",{"left":3700,"top":3700,"width":3701,"height":3701,"rotate":3700,"vFlip":9,"hFlip":9,"body":3727},"\u003Cpath fill=\"currentColor\" d=\"M13.5 2c0 .444-.193.843-.5 1.118V5h5a3 3 0 0 1 3 3v10a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3V8a3 3 0 0 1 3-3h5V3.118A1.5 1.5 0 1 1 13.5 2M6 7a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V8a1 1 0 0 0-1-1zm-4 3H0v6h2zm20 0h2v6h-2zM9 14.5a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m6 0a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3\"/>",{"left":3700,"top":3700,"width":3701,"height":3701,"rotate":3700,"vFlip":9,"hFlip":9,"body":3729},"\u003Cpath fill=\"currentColor\" d=\"M21 12a1 1 0 0 0-1 1v6a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h6a1 1 0 0 0 0-2H5a3 3 0 0 0-3 3v14a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-6a1 1 0 0 0-1-1m-15 .76V17a1 1 0 0 0 1 1h4.24a1 1 0 0 0 .71-.29l6.92-6.93L21.71 8a1 1 0 0 0 0-1.42l-4.24-4.29a1 1 0 0 0-1.42 0l-2.82 2.83l-6.94 6.93a1 1 0 0 0-.29.71m10.76-8.35l2.83 2.83l-1.42 1.42l-2.83-2.83ZM8 13.17l5.93-5.93l2.83 2.83L10.83 16H8Z\"/>",{"left":3700,"top":3700,"width":3701,"height":3701,"rotate":3700,"vFlip":9,"hFlip":9,"body":3731},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m13 7l5 5m0 0l-5 5m5-5H6\"/>",{"left":3700,"top":3700,"width":3701,"height":3701,"rotate":3700,"vFlip":9,"hFlip":9,"body":3733},"\u003Cpath fill=\"currentColor\" d=\"m13.172 12l-4.95-4.95l1.414-1.413L16 12l-6.364 6.364l-1.414-1.415z\"/>",{"left":3700,"top":3700,"width":3701,"height":3701,"rotate":3700,"vFlip":9,"hFlip":9,"body":3710},{"left":3700,"top":3700,"width":3701,"height":3701,"rotate":3700,"vFlip":9,"hFlip":9,"body":3736},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m11 17l-5-5m0 0l5-5m-5 5h12\"/>",{"left":3700,"top":3700,"width":3701,"height":3701,"rotate":3700,"vFlip":9,"hFlip":9,"body":3738},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m9 5l7 7l-7 7\"/>",{"left":3700,"top":3700,"width":3701,"height":3701,"rotate":3700,"vFlip":9,"hFlip":9,"body":3740},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m21 21l-6-6m2-5a7 7 0 1 1-14 0a7 7 0 0 1 14 0\"/>",{"left":3700,"top":3700,"width":3712,"height":3712,"rotate":3700,"vFlip":9,"hFlip":9,"body":3742},"\u003Cpath fill=\"currentColor\" d=\"M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z\"/>",{"parentPath":3674,"scrollTop":3700},{},{},{"/programming/terminal":771},{},{},{},{},{},["Reactive",3753],["Set"],["Reactive",3755],{"search-api":3756},null,1733708749192]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{plausible:{hashMode:false,trackLocalhost:false,domain:"",apiHost:"https://plausible.io",autoPageviews:true,autoOutboundTracking:false},studio:{apiURL:"https://api.nuxt.studio",iframeMessagingAllowedOrigins:""},mdc:{components:{prose:true,map:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"}},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}}},content:{locales:[],defaultLocale:"",integrity:1733708717391,experimental:{stripQueryParameters:false,advanceQuery:false,clientDB:false},respectPathCase:false,api:{baseURL:"/api/_content"},navigation:{fields:["icon","titleTemplate","header","main","aside","footer","layout"]},tags:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},highlight:{theme:{dark:"github-dark",default:"github-light"},preload:["json","js","ts","html","css","vue","diff","shell","markdown","yaml","bash","ini"],highlighter:"shiki",langs:["js","jsx","json","ts","tsx","vue","css","html","vue","bash","md","mdc","yaml","json","js","ts","html","css","vue","diff","shell","markdown","yaml","bash","ini"]},wsUrl:"",documentDriven:{page:true,navigation:true,surround:true,globals:{},layoutFallbacks:["theme"],injectPage:true},host:"",trailingSlash:false,search:"",contentHead:true,anchorLinks:{depth:4,exclude:[1]}}},app:{baseURL:"/",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>